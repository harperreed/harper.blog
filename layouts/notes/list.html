{{/* layouts/notes/list.html */}}
{{ define "main" }}
<div>
    <h1 class="text-3xl font-normal mb-12">Notes</h1>
    
    {{ $paginator := .Paginate .Pages 20 }}
    <div class="space-y-20">
        {{ range $paginator.Pages }}
        <article class="group relative">
            <time class="block text-gray-600 mb-4" datetime="{{ .Date.Format "2006-01-02" }}">
                {{ .Date.Format "January 2, 2006" }}
            </time>
            
            {{ with .Resources.ByType "image" }}
            <div class="space-y-4 mb-6">
                {{ range . }}
                {{ $image := .Resize "1200x webp" }}
                <figure>
                    <img 
                        src="{{ $image.RelPermalink }}" 
                        alt="{{ with .Title }}{{ . }}{{ else }}Note image{{ end }}"
                        class="w-full max-h-[70vh] object-contain bg-gray-50"
                        loading="lazy"
                        width="{{ $image.Width }}"
                        height="{{ $image.Height }}"
                    />
                    {{ with .Title }}
                    <figcaption class="mt-2 text-base text-gray-600 text-center">{{ . }}</figcaption>
                    {{ end }}
                </figure>
                {{ end }}
            </div>
            {{ end }}
            
            <div class="space-y-4">
                <div class="prose prose-neutral max-w-none">
                    {{ .Content }}
                </div>

                {{ with .Params.tags }}
                <div class="flex flex-wrap gap-2">
                    {{ range . }}
                    <a href="/tags/{{ . | urlize }}" class="text-base text-gray-600 hover:text-gray-900 no-underline">#{{ . }}</a>
                    {{ end }}
                </div>
                {{ end }}
            </div>

            <a href="{{ .Permalink }}" class="absolute -left-8 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity" aria-label="Permalink to this note">¶</a>
        </article>
        {{ end }}
    </div>

    {{ if gt $paginator.TotalPages 1 }}
    <nav class="mt-20 flex justify-between text-lg text-gray-600">
        {{ if $paginator.HasPrev }}
        <a href="{{ $paginator.Prev.URL }}" class="hover:text-gray-900 no-underline">← Newer notes</a>
        {{ end }}
        {{ if $paginator.HasNext }}
        <a href="{{ $paginator.Next.URL }}" class="hover:text-gray-900 no-underline">Older notes →</a>
        {{ end }}
    </nav>
    {{ end }}
</div>
{{ end }}
