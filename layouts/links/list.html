{{ define "main" }}
<div class="article-body">
  <h1 class="article-title">Links</h1>

  <div class="content">{{ .Content }}</div>

  <!-- Links Stream -->
  <div class="space-y-6">
    {{ $paginator := .Paginate .Data.Pages .Site.Params.links_pagination }} {{
    $.Scratch.Set "currentDate" "" }} {{ $.Scratch.Set "currentDayLinks" slice
    }} {{ range $index, $page := $paginator.Pages }} {{ if (not (in
    $.Site.Params.excludedTypes .Type)) }} {{ $postDate := .Date.Format
    "2006-01-02" }} {{ $currentDate := $.Scratch.Get "currentDate" }} {{
    $isLastPage := eq (add $index 1) (len $paginator.Pages) }} {{ if or (ne
    $postDate $currentDate) $isLastPage }} {{ if ne $currentDate "" }} {{
    $dayLinks := $.Scratch.Get "currentDayLinks" }}
    <article class="pb-4 border-b-2 my-6">
      <!-- Date Header -->
      <div class="flex items-baseline mb-2">
        <h2 class="text-xl">
          ðŸ”— Links for {{ dateFormat "Monday, January 2, 2006" (time
          $currentDate) }}
        </h2>
      </div>

      <!-- Links List -->
      <div class="border-t border-gray-100 pt-4">
        <ul class="space-y-3 list-disc">
          {{ range $dayLinks }} {{ $url := urls.Parse .Params.original_url }}
          <li class="group">
            <a
              href="{{ .Params.original_url }}"
              target="_blank"
              class="flex items-baseline hover:bg-gray-50 rounded transition-colors"
            >
              <span class="text-blue-600 group-hover:text-gray-600 flex-grow">
                {{ .Content }}
              </span>
              <span
                class="text-sm text-gray-600 group-hover:text-blue-600 ml-2"
              >
                ({{ $url.Hostname }})
              </span>
            </a>
          </li>
          {{ end }}
        </ul>
      </div>
    </article>
    {{ end }} {{ $.Scratch.Set "currentDate" $postDate }} {{ $.Scratch.Set
    "currentDayLinks" slice }} {{ end }} {{ $currentDayLinks := $.Scratch.Get
    "currentDayLinks" }} {{ $.Scratch.Set "currentDayLinks" ($currentDayLinks |
    append .) }} {{ if $isLastPage }} {{ $lastDayLinks := $.Scratch.Get
    "currentDayLinks" }} {{ $.Scratch.Set "currentDayLinks" $lastDayLinks }} {{
    end }} {{ end }} {{ end }}
  </div>

  <!-- Pagination -->
  {{ partial "pagination.html" . }}
</div>
{{ end }}
