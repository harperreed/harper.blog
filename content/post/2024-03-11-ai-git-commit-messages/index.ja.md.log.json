{
  "input_file": "index.md",
  "output_file": "index.ja.md",
  "target_language": "japanese",
  "language_code": "ja",
  "model": "o3",
  "skip_edit": false,
  "do_critique": true,
  "critique_loops": 4,
  "has_frontmatter": true,
  "translation_context": "a blog post about git commit messages",
  "token_usage": {
    "prompt_tokens": 80980,
    "completion_tokens": 25354,
    "total_tokens": 106334
  },
  "cost": "$1.8240",
  "prompts_and_responses": {
    "translation": {
      "model": "o3",
      "target_language": "japanese",
      "system_prompt": "\n        1. Read the provided text carefully, preserving all formatting, markdown, and structure exactly as they appear.\n        2. Identify any block quotes and code blocks.\n        3. Do not translate text in block quotes or in code blocks (including text within code blocks).\n        4. Translate everything else into japanese.\n        5. Maintain the original formatting, markdown, and structure in your output.\n        6. Provide a natural-sounding translation rather than a word-for-word one.\n        7. For idioms, colloquialisms, or slang, render them in an equivalent, natural way in japanese whenever possible.\n        8. If there isn't a direct or natural translation for a particular term or phrase, keep it in the original language and surround it with quotes if necessary.\n        9. Ensure that technical terms or jargon remain accurate; if there's no suitable translation, keep the original term.\n        10. Strive for fluid, native-sounding prose that retains the tone and intent of the original text.\n        11. If context about the text is provided, use it to inform your translation choices, especially regarding tone, style, and cultural adaptations.\n        ",
      "user_prompt": "# CONTEXT\na blog post about git commit messages\n\n# TEXT TO TRANSLATE\n_TL;DR: You can set a pre-commit-msg git hook to call the `llm` cli and get a summary of your recent code changes as your commit message._\n\nI love hacking on projects, but often I am super bad at making commits that make sense.\n\nFor instance:\n{{< image src=\"/images/posts/commits.png\" caption=\"My terrible commit messages\" >}}\n\nTrash commit messages. I am lazy!\n\n## Never fear, LLMs are here.\n\nOriginally my buddy [Kanno](https://twitter.com/ryankanno?lang=en) sent me a snippet that would allow you to have a simple git alias that would generate a commit message from the git diff. It was pretty robust.\n\n```bash\n# generate comment\ngpt = \"!f() { git diff $1 | sgpt 'Write concise, informative commit messages: Start with a summary in imperative mood, explain the 'why' behind changes, keep the summary under 50 characters, use bullet points for multiple changes, and reference related issues or tickets. What you write will be passed to git commit -m \\\"[message]\\\"'; }; f\"\n```\n\nHowever, I wanted to use Simonâ€™s [LLM cli](https://llm.datasette.io/en/stable/) instead of shell gpt. LLM has way more model support, and can use local models, MLX, etc.\n\nI also wanted the prompt to be stored externally so I could iterate on it without having to fuck with the `.gitconfig` over and over again.\n\nI went ahead and put my prompt in `~/.config/prompts/git-commit-message.txt`. Here is the prompt:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n\n```\n\nAnd here is the updated gpt alias:\n\n```bash\ngpt = \"!f() { git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\" }; f\"\n```\n\nThis did everything I wanted it to do. However, I am lazy, so I wanted to add a bit more magic.\n\nI asked [claude](https://claude.ai) to make it more interactive and allow me to abort the commit message if it sucked.\n\n```bash\nllm = \"!f() { \\\n    if git diff --quiet $1; then \\\n        echo \\\"No changes to commit. Aborting.\\\"; \\\n    else \\\n        commit_msg=$(git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    fi; \\\n}; f\"\n```\n\nThis was so so close. I asked claude again, and we got to this:\n\n```bash\nllm-staged = \"!f() { \\\n    git add -p; \\\n    if ! git diff --cached --quiet; then \\\n        commit_msg=$(git diff --cached | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            git reset HEAD .; \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    else \\\n        echo \\\"No changes staged for commit. Aborting.\\\"; \\\n    fi; \\\n}; f\"\n```\n\nI was satisfied, but this was still too much work, and too kludgy.\n\n## Git Hooked\n\nThen I remembered! Git hooks! Lol. Why would I have that in my brain - who knows!\n\nI asked claude again, and they whipped up a simple script that would act as a hook that triggers with the `prepare-commit-msg` event.\n\nThis is awesome, cuz if you want to add a git message, you can skip the hook. But if you are lazy, you exclude the message and it will call the LLM.\n\nThe commit hook is super simple:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'    # Sets text to red\nGREEN='\\033[0;32m'  # Sets text to green\nYELLOW='\\033[0;33m' # Sets text to yellow\nBLUE='\\033[0;34m'   # Sets text to blue\nNC='\\033[0m'        # Resets the text color to default, no color\n\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  # Array of spinner characters for the animation\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  # Infinite loop to keep the animation running\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis  # Hide the cursor to enhance the animation appearance\n      tput el1    # Clear the line from the cursor to the beginning to display the spinner\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"  # Print the spinner and message\n      sleep 0.1   # Delay to control the speed of the animation\n      tput cub 32 # Move the cursor back 32 columns to reset the spinner position\n    done\n  done\n}\n\n# Check if the commit is a merge commit based on the presence of a second argument\nif [ -n \"$2\" ]; then\n  exit 0  # Exit script if it's a merge commit, no custom message needed\nfi\n\n# Check if the `llm` command is installed\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start the spinning animation in the background\nspin_animation &\nspin_pid=$!  # Capture the process ID of the spinning animation\n\n# Generate the commit message using `git diff` piped into `llm` command\n# The LLM command takes a system prompt from a file as input\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  # Stop the spinning animation by killing its process\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n  # Finalizing output\n  tput cnorm  # Show the cursor again\n  printf \"\\\\n\"  # Move the cursor to the next line\n\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\n# Stop the spinning animation by killing its process\nkill $spin_pid\nwait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n# Finalizing output\ntput cnorm  # Show the cursor again\necho  # Move the cursor to the next line\n\n# Display the generated commit message with color-coded headings\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\n# Write the generated commit message to the specified file (usually the commit message file in .git)\necho \"$commit_msg\" > \"$1\"\n\n\n```\n\n(ChatGPT added the documentation)\n\nIt works! And has a spinner! And catches errors! And is pretty!\n\n![](/images/posts/llm-commit-hook.gif)\n\nNow, whenever I commit without a message, the commit hook executes and sends the diff of the changes to the llm cli with the system prompt previously defined. The output is really nice!\n\n```text\nğŸ¤–ğŸ’¬ AI-powered git commit messages FTW! ğŸš€ğŸ‰\n- Updated content/post/2024-03-11-ai-git-commit-messages.md\n- Added links to my actual git hook and prompt in dotfiles repo ğŸ”—\n- Removed unnecessary code block formatting for the output example ğŸ—‘ï¸\n- AI is making us lazy devs, but who cares when commit messages are this awesome! ğŸ˜‚ğŸ‘Œ\n```\n\nYay. Much better! You can see [my hook](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg) and [my prompt](https://github.com/harperreed/dotfiles/blob/master/.config/prompts/commit-system-prompt.txt) in my dotfiles.\n\nYou can even disable it by setting the `SKIP_LLM_GITHOOK` environment variable.\n\n## How to set this up!\n\n### 1. Install `llm`.\n\nVisit [llm.datasette.io](https://llm.datasette.io/en/stable/) for instructions. I used `pipx` to install it:\n\n```bash\npipx install llm\n```\n\nRemember to set your key and default model.\n\nSet your Openai key:\n\n```bash\nllm keys set openai\n```\n\nSet which model is default:\n\n```bash\nllm models default gpt-4-turbo\n```\n\n(The `llm` cli is awesome. It supports lots of different models (including local models), and contexts. Worth digging in for sure)\n\n### 2. Create a new directory for your prompts:\n\n```bash\nmkdir -p ~/.config/prompts\n```\n\n### 3. Add your system prompt:\n\nThe hook will look in `~/.config/prompts/commit-system-prompt.txt` for the system prompt. You can create a file with the following content:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nThis prompt worked great for me - but let me know if you have changes. I consider this prompt v0.\n\n### 4. Create a new directory for your global Git hooks.\n\nFor example, you can create a directory named `git_hooks` in your home directory:\n\n```bash\nmkdir -p ~/.git_hooks\n```\n\n### 5. Touch the `prepare-commit-msg`\n\nCreate a new file named `prepare-commit-msg` (without any extension) in the `~/.git_hooks` directory.\n\n### 6. Open the `prepare-commit-msg` file in a text editor (vi or death) and add the same content as before:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'    # Sets text to red\nGREEN='\\033[0;32m'  # Sets text to green\nYELLOW='\\033[0;33m' # Sets text to yellow\nBLUE='\\033[0;34m'   # Sets text to blue\nNC='\\033[0m'        # Resets the text color to default, no color\n\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  # Array of spinner characters for the animation\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  # Infinite loop to keep the animation running\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis  # Hide the cursor to enhance the animation appearance\n      tput el1    # Clear the line from the cursor to the beginning to display the spinner\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"  # Print the spinner and message\n      sleep 0.1   # Delay to control the speed of the animation\n      tput cub 32 # Move the cursor back 32 columns to reset the spinner position\n    done\n  done\n}\n\n# Check if the commit is a merge commit based on the presence of a second argument\nif [ -n \"$2\" ]; then\n  exit 0  # Exit script if it's a merge commit, no custom message needed\nfi\n\n# Check if the `llm` command is installed\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start the spinning animation in the background\nspin_animation &\nspin_pid=$!  # Capture the process ID of the spinning animation\n\n# Generate the commit message using `git diff` piped into `llm` command\n# The LLM command takes a system prompt from a file as input\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  # Stop the spinning animation by killing its process\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n  # Finalizing output\n  tput cnorm  # Show the cursor again\n  printf \"\\\\n\"  # Move the cursor to the next line\n\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\n# Stop the spinning animation by killing its process\nkill $spin_pid\nwait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n# Finalizing output\ntput cnorm  # Show the cursor again\necho  # Move the cursor to the next line\n\n# Display the generated commit message with color-coded headings\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\n# Write the generated commit message to the specified file (usually the commit message file in .git)\necho \"$commit_msg\" > \"$1\"\n\n\n```\n\nYou can see [mine in my dotfiles](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg).\n\n### 7. Make the `prepare-commit-msg` file executable\n\nRun the following command in your terminal:\n\n```bash\nchmod +x ~/.git_hooks/prepare-commit-msg\n```\n\n### 8. Configure Git to use your global hooks directory\n\nRun the following command to set your global hooks directory\n\n```bash\ngit config --global core.hooksPath ~/.git_hooks\n```\n\n### 9. Code, build things and then commit something\n\n## Explanation on how it works\n\nThis command sets the `core.hooksPath` configuration option to your global hooks directory (`~/.git_hooks`).\n\nNow, whenever you run `git commit` in any of your repositories, Git will execute the global `prepare-commit-msg` hook located in `~/.git_hooks/prepare-commit-msg`. The hook will generate the commit message based on the staged changes using the `llm` command and the system prompt from `~/.config/prompts/commit-system-prompt.txt`.\n\nBy setting up a global `prepare-commit-msg` hook, you can have the commit message generation functionality available in all your repositories without the need to set it up individually for each repository.\n\nRemember to have the `llm` command and the `~/.config/prompts/commit-system-prompt.txt` file set up correctly for the global hook to work as expected.\n\nWith this global hook in place, you can simply stage your changes normally using `git add` or `git add -p`, and then run `git commit`.\n\nThe global `prepare-commit-msg` hook will automatically generate the commit message for you, ready for review and editing before finalizing the commit.\n\nIf you want to skip the LLM commit message generation, just commit with a message: `git commit -m â€œfixed issue #420â€`. This seems to bypass the pre commit hook.\n\n## This is just a hack. AI will hallucinate.\n\nI had fun building this, and it is hilarious.\n\nI have had it hallucinate hilarious things. Never making up changes (thus far), but doing weird shit like adding â€œFixed issue #54â€ at the end.\n\nLike everything in life, YMMV.\n\nIf this is helpful, send me an email and let me know! My email is [harper@modest.com](mailto:harper@modest.com).",
      "context": "a blog post about git commit messages",
      "response": "# ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ\nGit ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«é–¢ã™ã‚‹ãƒ–ãƒ­ã‚°è¨˜äº‹\n\n# ç¿»è¨³å¯¾è±¡ã®ãƒ†ã‚­ã‚¹ãƒˆ\n_TL;DR: `llm` CLI ã‚’å‘¼ã³å‡ºã™ `pre-commit-msg` Git ãƒ•ãƒƒã‚¯ã‚’è¨­å®šã™ã‚Œã°ã€ç›´è¿‘ã®ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã‚’è¦ç´„ã—ãŸã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•ã§ç”Ÿæˆã§ãã‚‹ã‚ˆã€‚_\n\nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒãƒƒã‚¯ã™ã‚‹ã®ã¯å¤§å¥½ããªã‚“ã ã‘ã©ã€æ„å‘³ã®ã‚ã‚‹ã‚³ãƒŸãƒƒãƒˆã‚’ä½œã‚‹ã®ã¯è¶…è‹¦æ‰‹ãªã‚“ã ã‚ˆã­ã€‚\n\nä¾‹ãˆã°:\n{{< image src=\"/images/posts/commits.png\" caption=\"My terrible commit messages\" >}}\n\nã‚´ãƒŸã¿ãŸã„ãªã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‚ã ã£ã¦ãƒ©ã‚¯ã—ãŸã„ã‚“ã ã‚‚ã‚“ï¼\n\n## å®‰å¿ƒã—ã¦ã€LLM ãŒæ¥ãŸã€‚\n\næœ€åˆã¯å‹äººã® [Kanno](https://twitter.com/ryankanno?lang=en) ãŒã€`git diff` ã‹ã‚‰ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã™ã‚‹ã‚·ãƒ³ãƒ—ãƒ«ãª git ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’æ•™ãˆã¦ãã‚ŒãŸã€‚ã‹ãªã‚Š robust ã ã£ãŸã€‚\n\n```bash\n# generate comment\ngpt = \"!f() { git diff $1 | sgpt 'Write concise, informative commit messages: Start with a summary in imperative mood, explain the 'why' behind changes, keep the summary under 50 characters, use bullet points for multiple changes, and reference related issues or tickets. What you write will be passed to git commit -m \\\"[message]\\\"'; }; f\"\n```\n\nã§ã‚‚ã€ã‚·ã‚§ãƒ« GPT ã˜ã‚ƒãªãã¦ Simon ã® [LLM CLI](https://llm.datasette.io/en/stable/) ã‚’ä½¿ã„ãŸã‹ã£ãŸã€‚LLM ã¯å¯¾å¿œãƒ¢ãƒ‡ãƒ«ãŒè±Šå¯Œã§ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«ã‚„ MLX ã‚‚ã„ã‘ã‚‹ã—ã€‚\n\nãã‚Œã¨ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã«ç½®ã„ã¦ã€`.gitconfig` ã‚’æ¯å›ã„ã˜ã‚‰ãªãã¦ã™ã‚€ã‚ˆã†ã«ã—ãŸã‹ã£ãŸã€‚\n\nãã“ã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ `~/.config/prompts/git-commit-message.txt` ã«ä¿å­˜ã€‚å†…å®¹ã¯ã“ã‚“ãªæ„Ÿã˜:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nãã—ã¦ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ã“ã†æ›´æ–°:\n\n```bash\ngpt = \"!f() { git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\" }; f\"\n```\n\nã“ã‚Œã§æœ›ã¿ã©ãŠã‚Šã€‚ãŸã ã€ã‚‚ã£ã¨ãƒ©ã‚¯ã—ãŸã„ã®ã§é­”æ³•ã‚’è¿½åŠ ã—ãŸããªã£ãŸã€‚\n\nãã“ã§ [Claude](https://claude.ai) ã«é ¼ã‚“ã§ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«ã—ã¦ã€ã‚¤ãƒã‚¤ãƒãªã‚‰ã‚³ãƒŸãƒƒãƒˆã‚’ä¸­æ­¢ã§ãã‚‹ã‚ˆã†ã«ã—ãŸã€‚\n\n```bash\nllm = \"!f() { \\\n    if git diff --quiet $1; then \\\n        echo \\\"No changes to commit. Aborting.\\\"; \\\n    else \\\n        commit_msg=$(git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    fi; \\\n}; f\"\n```\n\nã“ã‚Œã§ã‚‚è‰¯ã‹ã£ãŸã‘ã©ã€ã•ã‚‰ã« Claude ã«ãŠé¡˜ã„ã—ã¦æœ€çµ‚çš„ã«ã“ã†ãªã£ãŸ:\n\n```bash\nllm-staged = \"!f() { \\\n    git add -p; \\\n    if ! git diff --cached --quiet; then \\\n        commit_msg=$(git diff --cached | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            git reset HEAD .; \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    else \\\n        echo \\\"No changes staged for commit. Aborting.\\\"; \\\n    fi; \\\n}; f\"\n```\n\næº€è¶³ã¯ã—ãŸã‘ã©ã€ã¾ã ã‚´ãƒãƒ£ã‚´ãƒãƒ£æ„ŸãŒã‚ã‚‹ã€‚\n\n## Git Hook ã ï¼\n\nãã“ã§ã²ã‚‰ã‚ã„ãŸã€‚Git ãƒ•ãƒƒã‚¯ï¼ç¬‘  \nãªã‚“ã§è¦šãˆã¦ãŸã®ã‹ã¯è¬ã ã‘ã©ã€‚\n\nå†ã³ Claude ã«ä¾é ¼ã—ã¦ã€`prepare-commit-msg` ã‚¤ãƒ™ãƒ³ãƒˆã§å‹•ãã‚·ãƒ³ãƒ—ãƒ«ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ã„ã¦ã‚‚ã‚‰ã£ãŸã€‚\n\nã“ã‚ŒãŒæœ€é«˜ãªã®ã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªåˆ†ã§æ›¸ããŸã„ã¨ãã¯ãƒ•ãƒƒã‚¯ã‚’ã‚¹ã‚­ãƒƒãƒ—ã§ãã‚‹ã“ã¨ã€‚æ€ ã‘ãŸã„ã¨ãã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’çœç•¥ã™ã‚Œã° LLM ãŒå‘¼ã°ã‚Œã‚‹ã€‚\n\nã‚³ãƒŸãƒƒãƒˆãƒ•ãƒƒã‚¯ã¯è¶…ã‚·ãƒ³ãƒ—ãƒ«:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'    # Sets text to red\nGREEN='\\033[0;32m'  # Sets text to green\nYELLOW='\\033[0;33m' # Sets text to yellow\nBLUE='\\033[0;34m'   # Sets text to blue\nNC='\\033[0m'        # Resets the text color to default, no color\n\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  # Array of spinner characters for the animation\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  # Infinite loop to keep the animation running\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis  # Hide the cursor to enhance the animation appearance\n      tput el1    # Clear the line from the cursor to the beginning to display the spinner\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"  # Print the spinner and message\n      sleep 0.1   # Delay to control the speed of the animation\n      tput cub 32 # Move the cursor back 32 columns to reset the spinner position\n    done\n  done\n}\n\n# Check if the commit is a merge commit based on the presence of a second argument\nif [ -n \"$2\" ]; then\n  exit 0  # Exit script if it's a merge commit, no custom message needed\nfi\n\n# Check if the `llm` command is installed\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start the spinning animation in the background\nspin_animation &\nspin_pid=$!  # Capture the process ID of the spinning animation\n\n# Generate the commit message using `git diff` piped into `llm` command\n# The LLM command takes a system prompt from a file as input\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  # Stop the spinning animation by killing its process\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n  # Finalizing output\n  tput cnorm  # Show the cursor again\n  printf \"\\\\n\"  # Move the cursor to the next line\n\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\n# Stop the spinning animation by killing its process\nkill $spin_pid\nwait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n# Finalizing output\ntput cnorm  # Show the cursor again\necho  # Move the cursor to the next line\n\n# Display the generated commit message with color-coded headings\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\n# Write the generated commit message to the specified file (usually the commit message file in .git)\necho \"$commit_msg\" > \"$1\"\n```\n\n(ChatGPT ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¦ãã‚ŒãŸ)\n\nã¡ã‚ƒã‚“ã¨å‹•ãï¼ã‚¹ãƒ”ãƒŠãƒ¼ã‚‚ä»˜ã„ã¦ã‚‹ï¼ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚‚ã‚ã‚‹ï¼è¦‹ãŸç›®ã‚‚ã‚«ãƒ¯ã‚¤ã‚¤ï¼\n\n![](/images/posts/llm-commit-hook.gif)\n\nã“ã‚Œã§ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãªã—ã§ `git commit` ã™ã‚‹ã¨ãƒ•ãƒƒã‚¯ãŒç™ºç«ã—ã€diff ã‚’ LLM CLI ã«é€ã‚Šã€å…ˆã®ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã€‚å‡ºåŠ›ã‚‚ã„ã„æ„Ÿã˜ï¼\n\n```text\nğŸ¤–ğŸ’¬ AI-powered git commit messages FTW! ğŸš€ğŸ‰\n- Updated content/post/2024-03-11-ai-git-commit-messages.md\n- Added links to my actual git hook and prompt in dotfiles repo ğŸ”—\n- Removed unnecessary code block formatting for the output example ğŸ—‘ï¸\n- AI is making us lazy devs, but who cares when commit messages are this awesome! ğŸ˜‚ğŸ‘Œ\n```\n\nã‚¤ã‚§ã‚¤ã€‚ã‹ãªã‚Šè‰¯ããªã£ãŸï¼[ãƒ•ãƒƒã‚¯](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg)ã¨[ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ](https://github.com/harperreed/dotfiles/blob/master/.config/prompts/commit-system-prompt.txt)ã¯ dotfiles ã§å…¬é–‹ã—ã¦ã‚‹ã‚ˆã€‚\n\n`SKIP_LLM_GITHOOK` ç’°å¢ƒå¤‰æ•°ã‚’ã‚»ãƒƒãƒˆã™ã‚Œã°ã€ã“ã®ä»•çµ„ã¿ã‚’ç„¡åŠ¹åŒ–ã§ãã‚‹ã€‚\n\n## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ–¹æ³•ï¼\n\n### 1. `llm` ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«\n\n[llm.datasette.io](https://llm.datasette.io/en/stable/) ã‚’å‚ç…§ã€‚è‡ªåˆ†ã¯ `pipx` ã§å…¥ã‚ŒãŸ:\n\n```bash\npipx install llm\n```\n\nã‚­ãƒ¼ã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¢ãƒ‡ãƒ«ã‚’è¨­å®šã€‚\n\nOpenAI ã®ã‚­ãƒ¼ã‚’ã‚»ãƒƒãƒˆ:\n\n```bash\nllm keys set openai\n```\n\nãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¢ãƒ‡ãƒ«ã‚’æŒ‡å®š:\n\n```bash\nllm models default gpt-4-turbo\n```\n\n(`llm` CLI ã¯è¶…å„ªç§€ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«ã‚‚å«ã‚å¤šæ§˜ãªãƒ¢ãƒ‡ãƒ«ã¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã€‚æ˜ã£ã¦ã¿ã‚‹ä¾¡å€¤ã‚ã‚Š)\n\n### 2. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ\n\n```bash\nmkdir -p ~/.config/prompts\n```\n\n### 3. ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¿½åŠ \n\nãƒ•ãƒƒã‚¯ã¯ `~/.config/prompts/commit-system-prompt.txt` ã‚’æ¢ã™ã€‚ä»¥ä¸‹ã‚’ä¿å­˜:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nè‡ªåˆ†ã«ã¯ã“ã® v0 ã§ååˆ†ã€‚æ”¹å–„æ¡ˆãŒã‚ã‚Œã°ãœã²æ•™ãˆã¦ï¼\n\n### 4. ã‚°ãƒ­ãƒ¼ãƒãƒ« Git ãƒ•ãƒƒã‚¯ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ\n\nä¾‹: `~/.git_hooks` ã‚’ä½œã‚‹\n\n```bash\nmkdir -p ~/.git_hooks\n```\n\n### 5. `prepare-commit-msg` ã‚’ä½œæˆ\n\n`~/.git_hooks` ã«æ‹¡å¼µå­ãªã—ã§ `prepare-commit-msg` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹ã€‚\n\n### 6. ã‚¨ãƒ‡ã‚£ã‚¿(vi or death)ã§é–‹ãã€ä¸Šè¨˜ã¨åŒã˜å†…å®¹ã‚’è²¼ã‚Šä»˜ã‘ã‚‹:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'    # Sets text to red\nGREEN='\\033[0;32m'  # Sets text to green\nYELLOW='\\033[0;33m' # Sets text to yellow\nBLUE='\\033[0;34m'   # Sets text to blue\nNC='\\033[0m'        # Resets the text color to default, no color\n\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  # Array of spinner characters for the animation\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  # Infinite loop to keep the animation running\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis  # Hide the cursor to enhance the animation appearance\n      tput el1    # Clear the line from the cursor to the beginning to display the spinner\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"  # Print the spinner and message\n      sleep 0.1   # Delay to control the speed of the animation\n      tput cub 32 # Move the cursor back 32 columns to reset the spinner position\n    done\n  done\n}\n\n# Check if the commit is a merge commit based on the presence of a second argument\nif [ -n \"$2\" ]; then\n  exit 0  # Exit script if it's a merge commit, no custom message needed\nfi\n\n# Check if the `llm` command is installed\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start the spinning animation in the background\nspin_animation &\nspin_pid=$!  # Capture the process ID of the spinning animation\n\n# Generate the commit message using `git diff` piped into `llm` command\n# The LLM command takes a system prompt from a file as input\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  # Stop the spinning animation by killing its process\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n  # Finalizing output\n  tput cnorm  # Show the cursor again\n  printf \"\\\\n\"  # Move the cursor to the next line\n\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\n# Stop the spinning animation by killing its process\nkill $spin_pid\nwait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n# Finalizing output\ntput cnorm  # Show the cursor again\necho  # Move the cursor to the next line\n\n# Display the generated commit message with color-coded headings\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\n# Write the generated commit message to the specified file (usually the commit message file in .git)\necho \"$commit_msg\" > \"$1\"\n```\n\nå®Ÿç‰©ã¯[ã“ã“](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg)ã€‚\n\n### 7. `prepare-commit-msg` ã‚’å®Ÿè¡Œå¯èƒ½ã«ã™ã‚‹\n\n```bash\nchmod +x ~/.git_hooks/prepare-commit-msg\n```\n\n### 8. Git ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ•ãƒƒã‚¯ã®å ´æ‰€ã‚’æŒ‡å®š\n\n```bash\ngit config --global core.hooksPath ~/.git_hooks\n```\n\n### 9. ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãƒ“ãƒ«ãƒ‰ã—ã¦ã‚³ãƒŸãƒƒãƒˆã—ã‚ˆã†\n\n## ä»•çµ„ã¿\n\nã“ã®è¨­å®šã§ `core.hooksPath` ãŒ `~/.git_hooks` ã«ãªã‚‹ã€‚ã©ã®ãƒªãƒã§ã‚‚ `git commit` ã™ã‚‹ã¨ `~/.git_hooks/prepare-commit-msg` ãŒå‹•ãã€ã‚¹ãƒ†ãƒ¼ã‚¸ã—ãŸå¤‰æ›´ã‚’ `llm` ã¨ `~/.config/prompts/commit-system-prompt.txt` ã§ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã—ã¦ãã‚Œã‚‹ã€‚\n\nãƒ•ãƒƒã‚¯ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ç½®ã‘ã°ã€ãƒªãƒã”ã¨ã«è¨­å®šã™ã‚‹å¿…è¦ã¯ãªã—ã€‚`llm` ã¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã•ãˆã‚ã‚Œã° OKã€‚\n\nã„ã¤ã‚‚ã©ãŠã‚Š `git add`ï¼ˆor `git add -p`ï¼‰ã—ã¦ `git commit` ã™ã‚Œã°ã€è‡ªå‹•ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒç”Ÿæˆã•ã‚Œã€ç¢ºèªãƒ»ç·¨é›†ã§ãã‚‹ã€‚\n\nLLM ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ãŸã„ãªã‚‰å˜ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä»˜ãã§ã‚³ãƒŸãƒƒãƒˆã™ã‚Œã°ã„ã„: `git commit -m \"fixed issue #420\"`ã€‚\n\n## ã“ã‚Œã¯ãŸã ã®ãƒãƒƒã‚¯ã€‚AI ã¯å¹»è¦šã‚’è¦‹ã‚‹ã‹ã‚‚ã€‚\n\nä½œã£ã¦ã¦æ¥½ã—ã‹ã£ãŸã—çˆ†ç¬‘ã‚‚ã®ã€‚ã¨ãã©ãã€ŒFixed issue #54ã€ã¿ãŸã„ãªè¬ã®è¿½è¨˜ã‚’ã™ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚ä»Šã®ã¨ã“ã‚å¤‰æ›´ã‚’æé€ ã—ãŸã“ã¨ã¯ãªã„ã‘ã©ã€ã¾ã‚ YMMVã€‚\n\nå½¹ã«ç«‹ã£ãŸã‚‰ãƒ¡ãƒ¼ãƒ«ã—ã¦ã­ï¼ [harper@modest.com](mailto:harper@modest.com)ã€‚",
      "usage": {
        "prompt_tokens": 4165,
        "completion_tokens": 3974,
        "total_tokens": 8139
      },
      "streaming": true
    },
    "editing": {
      "model": "o3",
      "target_language": "japanese",
      "system_prompt": "\n        1. Carefully read the translated text alongside the original text in its entirety.\n        2. Compare both texts to ensure the translation accurately reflects the original meaning.\n        3. Correct any grammatical errors you find in the japanese text.\n        4. Adjust phrasing to make it sound natural and fluent for japanese speakers, making sure idioms and expressions are culturally appropriate.\n        5. Preserve the original tone, nuance, and style, including any formatting, markdown, and structure.\n        6. Avoid adding new information or altering the core meaning.\n        7. Ensure the final result doesn't feel machine-translated but remains faithful to the source.\n        8. Make only changes that genuinely improve the text's quality in japanese.\n        9. Don't be too literal. If there isn't a direct translation, provide a natural-sounding translation.\n        10. If the text contains idioms or colloquialisms, translate them into the target language while maintaining their original meaning.\n        11. If the text contains technical terms or jargon, ensure that the translation is accurate and appropriate for the target audience, if there isn't a natural translation, keep it in the original language.\n        12. If there is not natural translation, keep it in the original language.\n        ",
      "user_prompt": "# ORIGINAL TEXT\n_TL;DR: You can set a pre-commit-msg git hook to call the `llm` cli and get a summary of your recent code changes as your commit message._\n\nI love hacking on projects, but often I am super bad at making commits that make sense.\n\nFor instance:\n{{< image src=\"/images/posts/commits.png\" caption=\"My terrible commit messages\" >}}\n\nTrash commit messages. I am lazy!\n\n## Never fear, LLMs are here.\n\nOriginally my buddy [Kanno](https://twitter.com/ryankanno?lang=en) sent me a snippet that would allow you to have a simple git alias that would generate a commit message from the git diff. It was pretty robust.\n\n```bash\n# generate comment\ngpt = \"!f() { git diff $1 | sgpt 'Write concise, informative commit messages: Start with a summary in imperative mood, explain the 'why' behind changes, keep the summary under 50 characters, use bullet points for multiple changes, and reference related issues or tickets. What you write will be passed to git commit -m \\\"[message]\\\"'; }; f\"\n```\n\nHowever, I wanted to use Simonâ€™s [LLM cli](https://llm.datasette.io/en/stable/) instead of shell gpt. LLM has way more model support, and can use local models, MLX, etc.\n\nI also wanted the prompt to be stored externally so I could iterate on it without having to fuck with the `.gitconfig` over and over again.\n\nI went ahead and put my prompt in `~/.config/prompts/git-commit-message.txt`. Here is the prompt:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n\n```\n\nAnd here is the updated gpt alias:\n\n```bash\ngpt = \"!f() { git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\" }; f\"\n```\n\nThis did everything I wanted it to do. However, I am lazy, so I wanted to add a bit more magic.\n\nI asked [claude](https://claude.ai) to make it more interactive and allow me to abort the commit message if it sucked.\n\n```bash\nllm = \"!f() { \\\n    if git diff --quiet $1; then \\\n        echo \\\"No changes to commit. Aborting.\\\"; \\\n    else \\\n        commit_msg=$(git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    fi; \\\n}; f\"\n```\n\nThis was so so close. I asked claude again, and we got to this:\n\n```bash\nllm-staged = \"!f() { \\\n    git add -p; \\\n    if ! git diff --cached --quiet; then \\\n        commit_msg=$(git diff --cached | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            git reset HEAD .; \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    else \\\n        echo \\\"No changes staged for commit. Aborting.\\\"; \\\n    fi; \\\n}; f\"\n```\n\nI was satisfied, but this was still too much work, and too kludgy.\n\n## Git Hooked\n\nThen I remembered! Git hooks! Lol. Why would I have that in my brain - who knows!\n\nI asked claude again, and they whipped up a simple script that would act as a hook that triggers with the `prepare-commit-msg` event.\n\nThis is awesome, cuz if you want to add a git message, you can skip the hook. But if you are lazy, you exclude the message and it will call the LLM.\n\nThe commit hook is super simple:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'    # Sets text to red\nGREEN='\\033[0;32m'  # Sets text to green\nYELLOW='\\033[0;33m' # Sets text to yellow\nBLUE='\\033[0;34m'   # Sets text to blue\nNC='\\033[0m'        # Resets the text color to default, no color\n\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  # Array of spinner characters for the animation\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  # Infinite loop to keep the animation running\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis  # Hide the cursor to enhance the animation appearance\n      tput el1    # Clear the line from the cursor to the beginning to display the spinner\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"  # Print the spinner and message\n      sleep 0.1   # Delay to control the speed of the animation\n      tput cub 32 # Move the cursor back 32 columns to reset the spinner position\n    done\n  done\n}\n\n# Check if the commit is a merge commit based on the presence of a second argument\nif [ -n \"$2\" ]; then\n  exit 0  # Exit script if it's a merge commit, no custom message needed\nfi\n\n# Check if the `llm` command is installed\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start the spinning animation in the background\nspin_animation &\nspin_pid=$!  # Capture the process ID of the spinning animation\n\n# Generate the commit message using `git diff` piped into `llm` command\n# The LLM command takes a system prompt from a file as input\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  # Stop the spinning animation by killing its process\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n  # Finalizing output\n  tput cnorm  # Show the cursor again\n  printf \"\\\\n\"  # Move the cursor to the next line\n\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\n# Stop the spinning animation by killing its process\nkill $spin_pid\nwait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n# Finalizing output\ntput cnorm  # Show the cursor again\necho  # Move the cursor to the next line\n\n# Display the generated commit message with color-coded headings\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\n# Write the generated commit message to the specified file (usually the commit message file in .git)\necho \"$commit_msg\" > \"$1\"\n\n\n```\n\n(ChatGPT added the documentation)\n\nIt works! And has a spinner! And catches errors! And is pretty!\n\n![](/images/posts/llm-commit-hook.gif)\n\nNow, whenever I commit without a message, the commit hook executes and sends the diff of the changes to the llm cli with the system prompt previously defined. The output is really nice!\n\n```text\nğŸ¤–ğŸ’¬ AI-powered git commit messages FTW! ğŸš€ğŸ‰\n- Updated content/post/2024-03-11-ai-git-commit-messages.md\n- Added links to my actual git hook and prompt in dotfiles repo ğŸ”—\n- Removed unnecessary code block formatting for the output example ğŸ—‘ï¸\n- AI is making us lazy devs, but who cares when commit messages are this awesome! ğŸ˜‚ğŸ‘Œ\n```\n\nYay. Much better! You can see [my hook](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg) and [my prompt](https://github.com/harperreed/dotfiles/blob/master/.config/prompts/commit-system-prompt.txt) in my dotfiles.\n\nYou can even disable it by setting the `SKIP_LLM_GITHOOK` environment variable.\n\n## How to set this up!\n\n### 1. Install `llm`.\n\nVisit [llm.datasette.io](https://llm.datasette.io/en/stable/) for instructions. I used `pipx` to install it:\n\n```bash\npipx install llm\n```\n\nRemember to set your key and default model.\n\nSet your Openai key:\n\n```bash\nllm keys set openai\n```\n\nSet which model is default:\n\n```bash\nllm models default gpt-4-turbo\n```\n\n(The `llm` cli is awesome. It supports lots of different models (including local models), and contexts. Worth digging in for sure)\n\n### 2. Create a new directory for your prompts:\n\n```bash\nmkdir -p ~/.config/prompts\n```\n\n### 3. Add your system prompt:\n\nThe hook will look in `~/.config/prompts/commit-system-prompt.txt` for the system prompt. You can create a file with the following content:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nThis prompt worked great for me - but let me know if you have changes. I consider this prompt v0.\n\n### 4. Create a new directory for your global Git hooks.\n\nFor example, you can create a directory named `git_hooks` in your home directory:\n\n```bash\nmkdir -p ~/.git_hooks\n```\n\n### 5. Touch the `prepare-commit-msg`\n\nCreate a new file named `prepare-commit-msg` (without any extension) in the `~/.git_hooks` directory.\n\n### 6. Open the `prepare-commit-msg` file in a text editor (vi or death) and add the same content as before:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'    # Sets text to red\nGREEN='\\033[0;32m'  # Sets text to green\nYELLOW='\\033[0;33m' # Sets text to yellow\nBLUE='\\033[0;34m'   # Sets text to blue\nNC='\\033[0m'        # Resets the text color to default, no color\n\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  # Array of spinner characters for the animation\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  # Infinite loop to keep the animation running\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis  # Hide the cursor to enhance the animation appearance\n      tput el1    # Clear the line from the cursor to the beginning to display the spinner\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"  # Print the spinner and message\n      sleep 0.1   # Delay to control the speed of the animation\n      tput cub 32 # Move the cursor back 32 columns to reset the spinner position\n    done\n  done\n}\n\n# Check if the commit is a merge commit based on the presence of a second argument\nif [ -n \"$2\" ]; then\n  exit 0  # Exit script if it's a merge commit, no custom message needed\nfi\n\n# Check if the `llm` command is installed\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start the spinning animation in the background\nspin_animation &\nspin_pid=$!  # Capture the process ID of the spinning animation\n\n# Generate the commit message using `git diff` piped into `llm` command\n# The LLM command takes a system prompt from a file as input\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  # Stop the spinning animation by killing its process\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n  # Finalizing output\n  tput cnorm  # Show the cursor again\n  printf \"\\\\n\"  # Move the cursor to the next line\n\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\n# Stop the spinning animation by killing its process\nkill $spin_pid\nwait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n# Finalizing output\ntput cnorm  # Show the cursor again\necho  # Move the cursor to the next line\n\n# Display the generated commit message with color-coded headings\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\n# Write the generated commit message to the specified file (usually the commit message file in .git)\necho \"$commit_msg\" > \"$1\"\n\n\n```\n\nYou can see [mine in my dotfiles](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg).\n\n### 7. Make the `prepare-commit-msg` file executable\n\nRun the following command in your terminal:\n\n```bash\nchmod +x ~/.git_hooks/prepare-commit-msg\n```\n\n### 8. Configure Git to use your global hooks directory\n\nRun the following command to set your global hooks directory\n\n```bash\ngit config --global core.hooksPath ~/.git_hooks\n```\n\n### 9. Code, build things and then commit something\n\n## Explanation on how it works\n\nThis command sets the `core.hooksPath` configuration option to your global hooks directory (`~/.git_hooks`).\n\nNow, whenever you run `git commit` in any of your repositories, Git will execute the global `prepare-commit-msg` hook located in `~/.git_hooks/prepare-commit-msg`. The hook will generate the commit message based on the staged changes using the `llm` command and the system prompt from `~/.config/prompts/commit-system-prompt.txt`.\n\nBy setting up a global `prepare-commit-msg` hook, you can have the commit message generation functionality available in all your repositories without the need to set it up individually for each repository.\n\nRemember to have the `llm` command and the `~/.config/prompts/commit-system-prompt.txt` file set up correctly for the global hook to work as expected.\n\nWith this global hook in place, you can simply stage your changes normally using `git add` or `git add -p`, and then run `git commit`.\n\nThe global `prepare-commit-msg` hook will automatically generate the commit message for you, ready for review and editing before finalizing the commit.\n\nIf you want to skip the LLM commit message generation, just commit with a message: `git commit -m â€œfixed issue #420â€`. This seems to bypass the pre commit hook.\n\n## This is just a hack. AI will hallucinate.\n\nI had fun building this, and it is hilarious.\n\nI have had it hallucinate hilarious things. Never making up changes (thus far), but doing weird shit like adding â€œFixed issue #54â€ at the end.\n\nLike everything in life, YMMV.\n\nIf this is helpful, send me an email and let me know! My email is [harper@modest.com](mailto:harper@modest.com).\n\n# TRANSLATED TEXT\n# ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ\nGit ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«é–¢ã™ã‚‹ãƒ–ãƒ­ã‚°è¨˜äº‹\n\n# ç¿»è¨³å¯¾è±¡ã®ãƒ†ã‚­ã‚¹ãƒˆ\n_TL;DR: `llm` CLI ã‚’å‘¼ã³å‡ºã™ `pre-commit-msg` Git ãƒ•ãƒƒã‚¯ã‚’è¨­å®šã™ã‚Œã°ã€ç›´è¿‘ã®ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã‚’è¦ç´„ã—ãŸã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•ã§ç”Ÿæˆã§ãã‚‹ã‚ˆã€‚_\n\nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒãƒƒã‚¯ã™ã‚‹ã®ã¯å¤§å¥½ããªã‚“ã ã‘ã©ã€æ„å‘³ã®ã‚ã‚‹ã‚³ãƒŸãƒƒãƒˆã‚’ä½œã‚‹ã®ã¯è¶…è‹¦æ‰‹ãªã‚“ã ã‚ˆã­ã€‚\n\nä¾‹ãˆã°:\n{{< image src=\"/images/posts/commits.png\" caption=\"My terrible commit messages\" >}}\n\nã‚´ãƒŸã¿ãŸã„ãªã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‚ã ã£ã¦ãƒ©ã‚¯ã—ãŸã„ã‚“ã ã‚‚ã‚“ï¼\n\n## å®‰å¿ƒã—ã¦ã€LLM ãŒæ¥ãŸã€‚\n\næœ€åˆã¯å‹äººã® [Kanno](https://twitter.com/ryankanno?lang=en) ãŒã€`git diff` ã‹ã‚‰ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã™ã‚‹ã‚·ãƒ³ãƒ—ãƒ«ãª git ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’æ•™ãˆã¦ãã‚ŒãŸã€‚ã‹ãªã‚Š robust ã ã£ãŸã€‚\n\n```bash\n# generate comment\ngpt = \"!f() { git diff $1 | sgpt 'Write concise, informative commit messages: Start with a summary in imperative mood, explain the 'why' behind changes, keep the summary under 50 characters, use bullet points for multiple changes, and reference related issues or tickets. What you write will be passed to git commit -m \\\"[message]\\\"'; }; f\"\n```\n\nã§ã‚‚ã€ã‚·ã‚§ãƒ« GPT ã˜ã‚ƒãªãã¦ Simon ã® [LLM CLI](https://llm.datasette.io/en/stable/) ã‚’ä½¿ã„ãŸã‹ã£ãŸã€‚LLM ã¯å¯¾å¿œãƒ¢ãƒ‡ãƒ«ãŒè±Šå¯Œã§ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«ã‚„ MLX ã‚‚ã„ã‘ã‚‹ã—ã€‚\n\nãã‚Œã¨ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã«ç½®ã„ã¦ã€`.gitconfig` ã‚’æ¯å›ã„ã˜ã‚‰ãªãã¦ã™ã‚€ã‚ˆã†ã«ã—ãŸã‹ã£ãŸã€‚\n\nãã“ã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ `~/.config/prompts/git-commit-message.txt` ã«ä¿å­˜ã€‚å†…å®¹ã¯ã“ã‚“ãªæ„Ÿã˜:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nãã—ã¦ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ã“ã†æ›´æ–°:\n\n```bash\ngpt = \"!f() { git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\" }; f\"\n```\n\nã“ã‚Œã§æœ›ã¿ã©ãŠã‚Šã€‚ãŸã ã€ã‚‚ã£ã¨ãƒ©ã‚¯ã—ãŸã„ã®ã§é­”æ³•ã‚’è¿½åŠ ã—ãŸããªã£ãŸã€‚\n\nãã“ã§ [Claude](https://claude.ai) ã«é ¼ã‚“ã§ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«ã—ã¦ã€ã‚¤ãƒã‚¤ãƒãªã‚‰ã‚³ãƒŸãƒƒãƒˆã‚’ä¸­æ­¢ã§ãã‚‹ã‚ˆã†ã«ã—ãŸã€‚\n\n```bash\nllm = \"!f() { \\\n    if git diff --quiet $1; then \\\n        echo \\\"No changes to commit. Aborting.\\\"; \\\n    else \\\n        commit_msg=$(git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    fi; \\\n}; f\"\n```\n\nã“ã‚Œã§ã‚‚è‰¯ã‹ã£ãŸã‘ã©ã€ã•ã‚‰ã« Claude ã«ãŠé¡˜ã„ã—ã¦æœ€çµ‚çš„ã«ã“ã†ãªã£ãŸ:\n\n```bash\nllm-staged = \"!f() { \\\n    git add -p; \\\n    if ! git diff --cached --quiet; then \\\n        commit_msg=$(git diff --cached | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            git reset HEAD .; \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    else \\\n        echo \\\"No changes staged for commit. Aborting.\\\"; \\\n    fi; \\\n}; f\"\n```\n\næº€è¶³ã¯ã—ãŸã‘ã©ã€ã¾ã ã‚´ãƒãƒ£ã‚´ãƒãƒ£æ„ŸãŒã‚ã‚‹ã€‚\n\n## Git Hook ã ï¼\n\nãã“ã§ã²ã‚‰ã‚ã„ãŸã€‚Git ãƒ•ãƒƒã‚¯ï¼ç¬‘  \nãªã‚“ã§è¦šãˆã¦ãŸã®ã‹ã¯è¬ã ã‘ã©ã€‚\n\nå†ã³ Claude ã«ä¾é ¼ã—ã¦ã€`prepare-commit-msg` ã‚¤ãƒ™ãƒ³ãƒˆã§å‹•ãã‚·ãƒ³ãƒ—ãƒ«ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ã„ã¦ã‚‚ã‚‰ã£ãŸã€‚\n\nã“ã‚ŒãŒæœ€é«˜ãªã®ã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªåˆ†ã§æ›¸ããŸã„ã¨ãã¯ãƒ•ãƒƒã‚¯ã‚’ã‚¹ã‚­ãƒƒãƒ—ã§ãã‚‹ã“ã¨ã€‚æ€ ã‘ãŸã„ã¨ãã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’çœç•¥ã™ã‚Œã° LLM ãŒå‘¼ã°ã‚Œã‚‹ã€‚\n\nã‚³ãƒŸãƒƒãƒˆãƒ•ãƒƒã‚¯ã¯è¶…ã‚·ãƒ³ãƒ—ãƒ«:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'    # Sets text to red\nGREEN='\\033[0;32m'  # Sets text to green\nYELLOW='\\033[0;33m' # Sets text to yellow\nBLUE='\\033[0;34m'   # Sets text to blue\nNC='\\033[0m'        # Resets the text color to default, no color\n\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  # Array of spinner characters for the animation\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  # Infinite loop to keep the animation running\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis  # Hide the cursor to enhance the animation appearance\n      tput el1    # Clear the line from the cursor to the beginning to display the spinner\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"  # Print the spinner and message\n      sleep 0.1   # Delay to control the speed of the animation\n      tput cub 32 # Move the cursor back 32 columns to reset the spinner position\n    done\n  done\n}\n\n# Check if the commit is a merge commit based on the presence of a second argument\nif [ -n \"$2\" ]; then\n  exit 0  # Exit script if it's a merge commit, no custom message needed\nfi\n\n# Check if the `llm` command is installed\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start the spinning animation in the background\nspin_animation &\nspin_pid=$!  # Capture the process ID of the spinning animation\n\n# Generate the commit message using `git diff` piped into `llm` command\n# The LLM command takes a system prompt from a file as input\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  # Stop the spinning animation by killing its process\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n  # Finalizing output\n  tput cnorm  # Show the cursor again\n  printf \"\\\\n\"  # Move the cursor to the next line\n\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\n# Stop the spinning animation by killing its process\nkill $spin_pid\nwait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n# Finalizing output\ntput cnorm  # Show the cursor again\necho  # Move the cursor to the next line\n\n# Display the generated commit message with color-coded headings\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\n# Write the generated commit message to the specified file (usually the commit message file in .git)\necho \"$commit_msg\" > \"$1\"\n```\n\n(ChatGPT ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¦ãã‚ŒãŸ)\n\nã¡ã‚ƒã‚“ã¨å‹•ãï¼ã‚¹ãƒ”ãƒŠãƒ¼ã‚‚ä»˜ã„ã¦ã‚‹ï¼ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚‚ã‚ã‚‹ï¼è¦‹ãŸç›®ã‚‚ã‚«ãƒ¯ã‚¤ã‚¤ï¼\n\n![](/images/posts/llm-commit-hook.gif)\n\nã“ã‚Œã§ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãªã—ã§ `git commit` ã™ã‚‹ã¨ãƒ•ãƒƒã‚¯ãŒç™ºç«ã—ã€diff ã‚’ LLM CLI ã«é€ã‚Šã€å…ˆã®ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã€‚å‡ºåŠ›ã‚‚ã„ã„æ„Ÿã˜ï¼\n\n```text\nğŸ¤–ğŸ’¬ AI-powered git commit messages FTW! ğŸš€ğŸ‰\n- Updated content/post/2024-03-11-ai-git-commit-messages.md\n- Added links to my actual git hook and prompt in dotfiles repo ğŸ”—\n- Removed unnecessary code block formatting for the output example ğŸ—‘ï¸\n- AI is making us lazy devs, but who cares when commit messages are this awesome! ğŸ˜‚ğŸ‘Œ\n```\n\nã‚¤ã‚§ã‚¤ã€‚ã‹ãªã‚Šè‰¯ããªã£ãŸï¼[ãƒ•ãƒƒã‚¯](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg)ã¨[ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ](https://github.com/harperreed/dotfiles/blob/master/.config/prompts/commit-system-prompt.txt)ã¯ dotfiles ã§å…¬é–‹ã—ã¦ã‚‹ã‚ˆã€‚\n\n`SKIP_LLM_GITHOOK` ç’°å¢ƒå¤‰æ•°ã‚’ã‚»ãƒƒãƒˆã™ã‚Œã°ã€ã“ã®ä»•çµ„ã¿ã‚’ç„¡åŠ¹åŒ–ã§ãã‚‹ã€‚\n\n## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ–¹æ³•ï¼\n\n### 1. `llm` ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«\n\n[llm.datasette.io](https://llm.datasette.io/en/stable/) ã‚’å‚ç…§ã€‚è‡ªåˆ†ã¯ `pipx` ã§å…¥ã‚ŒãŸ:\n\n```bash\npipx install llm\n```\n\nã‚­ãƒ¼ã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¢ãƒ‡ãƒ«ã‚’è¨­å®šã€‚\n\nOpenAI ã®ã‚­ãƒ¼ã‚’ã‚»ãƒƒãƒˆ:\n\n```bash\nllm keys set openai\n```\n\nãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¢ãƒ‡ãƒ«ã‚’æŒ‡å®š:\n\n```bash\nllm models default gpt-4-turbo\n```\n\n(`llm` CLI ã¯è¶…å„ªç§€ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«ã‚‚å«ã‚å¤šæ§˜ãªãƒ¢ãƒ‡ãƒ«ã¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã€‚æ˜ã£ã¦ã¿ã‚‹ä¾¡å€¤ã‚ã‚Š)\n\n### 2. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ\n\n```bash\nmkdir -p ~/.config/prompts\n```\n\n### 3. ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¿½åŠ \n\nãƒ•ãƒƒã‚¯ã¯ `~/.config/prompts/commit-system-prompt.txt` ã‚’æ¢ã™ã€‚ä»¥ä¸‹ã‚’ä¿å­˜:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nè‡ªåˆ†ã«ã¯ã“ã® v0 ã§ååˆ†ã€‚æ”¹å–„æ¡ˆãŒã‚ã‚Œã°ãœã²æ•™ãˆã¦ï¼\n\n### 4. ã‚°ãƒ­ãƒ¼ãƒãƒ« Git ãƒ•ãƒƒã‚¯ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ\n\nä¾‹: `~/.git_hooks` ã‚’ä½œã‚‹\n\n```bash\nmkdir -p ~/.git_hooks\n```\n\n### 5. `prepare-commit-msg` ã‚’ä½œæˆ\n\n`~/.git_hooks` ã«æ‹¡å¼µå­ãªã—ã§ `prepare-commit-msg` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹ã€‚\n\n### 6. ã‚¨ãƒ‡ã‚£ã‚¿(vi or death)ã§é–‹ãã€ä¸Šè¨˜ã¨åŒã˜å†…å®¹ã‚’è²¼ã‚Šä»˜ã‘ã‚‹:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'    # Sets text to red\nGREEN='\\033[0;32m'  # Sets text to green\nYELLOW='\\033[0;33m' # Sets text to yellow\nBLUE='\\033[0;34m'   # Sets text to blue\nNC='\\033[0m'        # Resets the text color to default, no color\n\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  # Array of spinner characters for the animation\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  # Infinite loop to keep the animation running\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis  # Hide the cursor to enhance the animation appearance\n      tput el1    # Clear the line from the cursor to the beginning to display the spinner\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"  # Print the spinner and message\n      sleep 0.1   # Delay to control the speed of the animation\n      tput cub 32 # Move the cursor back 32 columns to reset the spinner position\n    done\n  done\n}\n\n# Check if the commit is a merge commit based on the presence of a second argument\nif [ -n \"$2\" ]; then\n  exit 0  # Exit script if it's a merge commit, no custom message needed\nfi\n\n# Check if the `llm` command is installed\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start the spinning animation in the background\nspin_animation &\nspin_pid=$!  # Capture the process ID of the spinning animation\n\n# Generate the commit message using `git diff` piped into `llm` command\n# The LLM command takes a system prompt from a file as input\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  # Stop the spinning animation by killing its process\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n  # Finalizing output\n  tput cnorm  # Show the cursor again\n  printf \"\\\\n\"  # Move the cursor to the next line\n\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\n# Stop the spinning animation by killing its process\nkill $spin_pid\nwait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n# Finalizing output\ntput cnorm  # Show the cursor again\necho  # Move the cursor to the next line\n\n# Display the generated commit message with color-coded headings\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\n# Write the generated commit message to the specified file (usually the commit message file in .git)\necho \"$commit_msg\" > \"$1\"\n```\n\nå®Ÿç‰©ã¯[ã“ã“](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg)ã€‚\n\n### 7. `prepare-commit-msg` ã‚’å®Ÿè¡Œå¯èƒ½ã«ã™ã‚‹\n\n```bash\nchmod +x ~/.git_hooks/prepare-commit-msg\n```\n\n### 8. Git ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ•ãƒƒã‚¯ã®å ´æ‰€ã‚’æŒ‡å®š\n\n```bash\ngit config --global core.hooksPath ~/.git_hooks\n```\n\n### 9. ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãƒ“ãƒ«ãƒ‰ã—ã¦ã‚³ãƒŸãƒƒãƒˆã—ã‚ˆã†\n\n## ä»•çµ„ã¿\n\nã“ã®è¨­å®šã§ `core.hooksPath` ãŒ `~/.git_hooks` ã«ãªã‚‹ã€‚ã©ã®ãƒªãƒã§ã‚‚ `git commit` ã™ã‚‹ã¨ `~/.git_hooks/prepare-commit-msg` ãŒå‹•ãã€ã‚¹ãƒ†ãƒ¼ã‚¸ã—ãŸå¤‰æ›´ã‚’ `llm` ã¨ `~/.config/prompts/commit-system-prompt.txt` ã§ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã—ã¦ãã‚Œã‚‹ã€‚\n\nãƒ•ãƒƒã‚¯ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ç½®ã‘ã°ã€ãƒªãƒã”ã¨ã«è¨­å®šã™ã‚‹å¿…è¦ã¯ãªã—ã€‚`llm` ã¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã•ãˆã‚ã‚Œã° OKã€‚\n\nã„ã¤ã‚‚ã©ãŠã‚Š `git add`ï¼ˆor `git add -p`ï¼‰ã—ã¦ `git commit` ã™ã‚Œã°ã€è‡ªå‹•ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒç”Ÿæˆã•ã‚Œã€ç¢ºèªãƒ»ç·¨é›†ã§ãã‚‹ã€‚\n\nLLM ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ãŸã„ãªã‚‰å˜ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä»˜ãã§ã‚³ãƒŸãƒƒãƒˆã™ã‚Œã°ã„ã„: `git commit -m \"fixed issue #420\"`ã€‚\n\n## ã“ã‚Œã¯ãŸã ã®ãƒãƒƒã‚¯ã€‚AI ã¯å¹»è¦šã‚’è¦‹ã‚‹ã‹ã‚‚ã€‚\n\nä½œã£ã¦ã¦æ¥½ã—ã‹ã£ãŸã—çˆ†ç¬‘ã‚‚ã®ã€‚ã¨ãã©ãã€ŒFixed issue #54ã€ã¿ãŸã„ãªè¬ã®è¿½è¨˜ã‚’ã™ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚ä»Šã®ã¨ã“ã‚å¤‰æ›´ã‚’æé€ ã—ãŸã“ã¨ã¯ãªã„ã‘ã©ã€ã¾ã‚ YMMVã€‚\n\nå½¹ã«ç«‹ã£ãŸã‚‰ãƒ¡ãƒ¼ãƒ«ã—ã¦ã­ï¼ [harper@modest.com](mailto:harper@modest.com)ã€‚\n\nPlease review and improve the translated text to make it natural and accurate in japanese.\nReturn ONLY the improved translated text without explanations or comments.",
      "response": "_TL;DR: `llm` CLI ã‚’å‘¼ã³å‡ºã™ `pre-commit-msg` Git ãƒ•ãƒƒã‚¯ã‚’è¨­å®šã™ã‚Œã°ã€ç›´è¿‘ã®ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã‚’è¦ç´„ã—ãŸã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•ç”Ÿæˆã§ãã‚‹ã‚ˆã€‚_\n\nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒãƒƒã‚¯ã™ã‚‹ã®ã¯å¤§å¥½ããªã‚“ã ã‘ã©ã€æ„å‘³ã®ã‚ã‚‹ã‚³ãƒŸãƒƒãƒˆã‚’ä½œã‚‹ã®ãŒè¶…è‹¦æ‰‹ãªã‚“ã ã‚ˆã­ã€‚\n\nä¾‹ãˆã°ã“ã‚“ãªæ„Ÿã˜:  \n{{< image src=\"/images/posts/commits.png\" caption=\"My terrible commit messages\" >}}\n\nã‚´ãƒŸã¿ãŸã„ãªã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‚ã ã£ã¦ãƒ©ã‚¯ã—ãŸã„ã‚“ã ã‚‚ã‚“ï¼\n\n## å®‰å¿ƒã—ã¦ã€LLM ã®ç™»å ´ã \n\næœ€åˆã¯å‹äººã® [Kanno](https://twitter.com/ryankanno?lang=en) ãŒã€`git diff` ã‹ã‚‰ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã™ã‚‹ã‚·ãƒ³ãƒ—ãƒ«ãª Git ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’é€ã£ã¦ãã‚ŒãŸã€‚ã‹ãªã‚Šã‚¤ã‚¤æ„Ÿã˜ã ã£ãŸã€‚\n\n```bash\n# generate comment\ngpt = \"!f() { git diff $1 | sgpt 'Write concise, informative commit messages: Start with a summary in imperative mood, explain the 'why' behind changes, keep the summary under 50 characters, use bullet points for multiple changes, and reference related issues or tickets. What you write will be passed to git commit -m \\\"[message]\\\"'; }; f\"\n```\n\nã§ã‚‚ã€Shell GPT ã˜ã‚ƒãªãã¦ Simon ã® [LLM CLI](https://llm.datasette.io/en/stable/) ã‚’ä½¿ã„ãŸã‹ã£ãŸã€‚LLM ã¯å¯¾å¿œãƒ¢ãƒ‡ãƒ«ãŒè±Šå¯Œã§ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«ã‚„ MLX ã«ã‚‚å¯¾å¿œã§ãã‚‹ã—ã€‚\n\nãã‚Œã¨ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã«ç½®ã„ã¦ `.gitconfig` ã‚’æ¯å›ã„ã˜ã‚‰ãªãã¦æ¸ˆã‚€ã‚ˆã†ã«ã—ãŸã‹ã£ãŸã€‚\n\nãã“ã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ `~/.config/prompts/git-commit-message.txt` ã«ä¿å­˜ã€‚å†…å®¹ã¯ã“ã‚“ãªæ„Ÿã˜:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nãã—ã¦ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ã“ã†æ›´æ–°:\n\n```bash\ngpt = \"!f() { git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\" }; f\"\n```\n\nã“ã‚Œã§ã‚„ã‚ŠãŸã„ã“ã¨ã¯ã»ã¼å®Ÿç¾ã€‚ã§ã‚‚ã€ã‚‚ã£ã¨ãƒ©ã‚¯ã—ãŸã„ã‹ã‚‰ã‚‚ã†å°‘ã—é­”æ³•ã‚’ã‹ã‘ãŸããªã£ãŸã€‚\n\nãã“ã§ [Claude](https://claude.ai) ã«é ¼ã‚“ã§ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«ã—ã¦ã€ã‚¤ãƒã‚¤ãƒãªã‚‰ã‚³ãƒŸãƒƒãƒˆã‚’ä¸­æ­¢ã§ãã‚‹ã‚ˆã†ã«ã—ãŸã€‚\n\n```bash\nllm = \"!f() { \\\n    if git diff --quiet $1; then \\\n        echo \\\"No changes to commit. Aborting.\\\"; \\\n    else \\\n        commit_msg=$(git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    fi; \\\n}; f\"\n```\n\nã“ã‚Œã§ã‚‚è‰¯ã‹ã£ãŸã‘ã©ã€ã•ã‚‰ã« Claude ã«ãŠé¡˜ã„ã—ã¦æœ€çµ‚çš„ã«ã“ã†ãªã£ãŸ:\n\n```bash\nllm-staged = \"!f() { \\\n    git add -p; \\\n    if ! git diff --cached --quiet; then \\\n        commit_msg=$(git diff --cached | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            git reset HEAD .; \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    else \\\n        echo \\\"No changes staged for commit. Aborting.\\\"; \\\n    fi; \\\n}; f\"\n```\n\næº€è¶³ã¯ã—ãŸã‘ã©ã€ã¾ã ã‚´ãƒãƒ£ã‚´ãƒãƒ£æ„ŸãŒã‚ã‚‹ã€‚\n\n## Git Hook ã ï¼\n\nãã“ã§ã²ã‚‰ã‚ã„ãŸã€‚Git ãƒ•ãƒƒã‚¯ï¼ãªã‚“ã§è¦šãˆã¦ãŸã®ã‹ã¯è¬ã ã‘ã©ã€‚\n\nå†ã³ Claude ã«ãŠé¡˜ã„ã—ã¦ã€`prepare-commit-msg` ã‚¤ãƒ™ãƒ³ãƒˆã§å‹•ãã‚·ãƒ³ãƒ—ãƒ«ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ã„ã¦ã‚‚ã‚‰ã£ãŸã€‚\n\nã“ã‚ŒãŒæœ€é«˜ãªã®ã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªåˆ†ã§æ›¸ããŸã„ã¨ãã¯ãƒ•ãƒƒã‚¯ã‚’ã‚¹ã‚­ãƒƒãƒ—ã§ãã‚‹ã“ã¨ã€‚æ€ ã‘ãŸã„ã¨ãã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’çœç•¥ã™ã‚Œã° LLM ãŒå‘¼ã°ã‚Œã‚‹ã€‚\n\nã‚³ãƒŸãƒƒãƒˆãƒ•ãƒƒã‚¯ã¯è¶…ã‚·ãƒ³ãƒ—ãƒ«:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[0;33m'\nBLUE='\\033[0;34m'\nNC='\\033[0m'\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis\n      tput el1\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"\n      sleep 0.1\n      tput cub 32\n    done\n  done\n}\n\n# Skip on merge commit\nif [ -n \"$2\" ]; then\n  exit 0\nfi\n\n# Check if `llm` exists\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start spinner\nspin_animation &\nspin_pid=$!\n\n# Generate commit message\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null\n  tput cnorm\n  printf \"\\\\n\"\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\n# Stop spinner\nkill $spin_pid\nwait $spin_pid 2>/dev/null\ntput cnorm\necho\n\n# Show generated message\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\n# Write message\necho \"$commit_msg\" > \"$1\"\n```\n\n(ChatGPT ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¦ãã‚ŒãŸ)\n\nã¡ã‚ƒã‚“ã¨å‹•ãï¼ã‚¹ãƒ”ãƒŠãƒ¼ã‚‚ä»˜ã„ã¦ã‚‹ï¼ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚‚ã‚ã‚‹ï¼è¦‹ãŸç›®ã‚‚ã‚«ãƒ¯ã‚¤ã‚¤ï¼\n\n![](/images/posts/llm-commit-hook.gif)\n\nã“ã‚Œã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãªã—ã§ `git commit` ã™ã‚‹ã¨ãƒ•ãƒƒã‚¯ãŒç™ºç«ã—ã€diff ã‚’ LLM CLI ã«é€ã‚Šã€å…ˆã®ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã€‚å‡ºåŠ›ã‚‚ã„ã„æ„Ÿã˜ï¼\n\n```text\nğŸ¤–ğŸ’¬ AI-powered git commit messages FTW! ğŸš€ğŸ‰\n- Updated content/post/2024-03-11-ai-git-commit-messages.md\n- Added links to my actual git hook and prompt in dotfiles repo ğŸ”—\n- Removed unnecessary code block formatting for the output example ğŸ—‘ï¸\n- AI is making us lazy devs, but who cares when commit messages are this awesome! ğŸ˜‚ğŸ‘Œ\n```\n\nã‚¤ã‚§ã‚¤ã€‚ã‹ãªã‚Šè‰¯ããªã£ãŸï¼[ãƒ•ãƒƒã‚¯](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg)ã¨[ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ](https://github.com/harperreed/dotfiles/blob/master/.config/prompts/commit-system-prompt.txt)ã¯ dotfiles ã§å…¬é–‹ã—ã¦ã‚‹ã‚ˆã€‚\n\n`SKIP_LLM_GITHOOK` ç’°å¢ƒå¤‰æ•°ã‚’ã‚»ãƒƒãƒˆã™ã‚Œã°ã€ã“ã®ä»•çµ„ã¿ã‚’ç„¡åŠ¹åŒ–ã§ãã‚‹ã€‚\n\n## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ–¹æ³•ï¼\n\n### 1. `llm` ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«\n\n[llm.datasette.io](https://llm.datasette.io/en/stable/) ã‚’å‚ç…§ã€‚è‡ªåˆ†ã¯ `pipx` ã§å…¥ã‚ŒãŸ:\n\n```bash\npipx install llm\n```\n\nã‚­ãƒ¼ã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¢ãƒ‡ãƒ«ã‚’è¨­å®š:\n\n```bash\nllm keys set openai\nllm models default gpt-4-turbo\n```\n\n(`llm` CLI ã¯è¶…å„ªç§€ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«ã‚‚å«ã‚å¤šå½©ãªãƒ¢ãƒ‡ãƒ«ã¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã®ã§ã€ãœã²è§¦ã£ã¦ã¿ã¦ã­)\n\n### 2. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ\n\n```bash\nmkdir -p ~/.config/prompts\n```\n\n### 3. ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¿½åŠ \n\nãƒ•ãƒƒã‚¯ã¯ `~/.config/prompts/commit-system-prompt.txt` ã‚’å‚ç…§ã™ã‚‹ã€‚ä»¥ä¸‹ã‚’ä¿å­˜:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nã“ã‚Œã¯ v0ã€‚æ”¹å–„æ¡ˆãŒã‚ã‚Œã°ãœã²æ•™ãˆã¦ï¼\n\n### 4. ã‚°ãƒ­ãƒ¼ãƒãƒ« Git ãƒ•ãƒƒã‚¯ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ\n\n```bash\nmkdir -p ~/.git_hooks\n```\n\n### 5. `prepare-commit-msg` ã‚’ä½œæˆ\n\n`~/.git_hooks` ã«æ‹¡å¼µå­ãªã—ã§ `prepare-commit-msg` ã‚’ä½œã‚‹ã€‚\n\n### 6. ã‚¨ãƒ‡ã‚£ã‚¿ï¼ˆvi ã§ã‚‚ãŠå¥½ã¿ã®ã‚‚ã®ã§ã‚‚ï¼‰ã§é–‹ãã€ä¸Šè¨˜ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è²¼ã‚Šä»˜ã‘ã‚‹\n\n### 7. å®Ÿè¡Œæ¨©é™ã‚’ä»˜ä¸\n\n```bash\nchmod +x ~/.git_hooks/prepare-commit-msg\n```\n\n### 8. Git ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ•ãƒƒã‚¯ã®å ´æ‰€ã‚’æŒ‡å®š\n\n```bash\ngit config --global core.hooksPath ~/.git_hooks\n```\n\n### 9. ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãƒ“ãƒ«ãƒ‰ã—ã¦ã‚³ãƒŸãƒƒãƒˆï¼\n\n## ä»•çµ„ã¿\n\n`core.hooksPath` ã‚’ `~/.git_hooks` ã«è¨­å®šã—ãŸã®ã§ã€ã©ã®ãƒªãƒã§ã‚‚ `git commit` ã™ã‚‹ã¨ `prepare-commit-msg` ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚ã‚¹ãƒ†ãƒ¼ã‚¸ã—ãŸå¤‰æ›´ã‚’ `llm` ã¨ `~/.config/prompts/commit-system-prompt.txt` ã«æ¸¡ã—ã€ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã€‚\n\n`llm` ã¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã•ãˆç”¨æ„ã—ã¦ãŠã‘ã°ã€ã™ã¹ã¦ã®ãƒªãƒã§ã“ã®ä»•çµ„ã¿ãŒä½¿ãˆã‚‹ã€‚ã„ã¤ã‚‚ã©ãŠã‚Š `git add`ï¼ˆã¾ãŸã¯ `git add -p`ï¼‰ã—ã¦ `git commit` ã™ã‚‹ã ã‘ã§ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ã‚ˆã€‚\n\nLLM ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ãŸã„ã¨ãã¯ã€æ™®é€šã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä»˜ã‘ã¦ã‚³ãƒŸãƒƒãƒˆã™ã‚Œã° OK: `git commit -m \"fixed issue #420\"`ã€‚\n\n## ã“ã‚Œã¯ãŸã ã®ãƒãƒƒã‚¯ã€‚AI ã¯å¹»è¦šã‚’è¦‹ã‚‹ã‹ã‚‚\n\nä½œã£ã¦ã¦æ¥½ã—ã‹ã£ãŸã—çˆ†ç¬‘ã‚‚ã®ã€‚ã¨ãã©ãã€ŒFixed issue #54ã€ã¿ãŸã„ãªè¬ã®è¿½è¨˜ã‚’ã™ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚ä»Šã®ã¨ã“ã‚å¤‰æ›´ã‚’æé€ ã—ãŸã“ã¨ã¯ãªã„ã‘ã©ã€ã¾ã‚ YMMVã€‚\n\nå½¹ã«ç«‹ã£ãŸã‚‰ãƒ¡ãƒ¼ãƒ«ã—ã¦ã­ï¼ [harper@modest.com](mailto:harper@modest.com)",
      "usage": {
        "prompt_tokens": 8595,
        "completion_tokens": 2793,
        "total_tokens": 11388
      },
      "streaming": true
    },
    "critique": {
      "model": "o3",
      "target_language": "japanese",
      "system_prompt": "You are a highly critical professional translator and linguistic expert specializing in japanese.\nYour task is to ruthlessly critique the translation by:\n\n1. Meticulously comparing the translated text with the original, identifying ANY inaccuracies, mistranslations, or omissions\n2. Highlighting nuances, cultural references, or idioms that were lost or mistranslated\n3. Scrutinizing for grammatical errors, awkward phrasing, or unnatural expressions in japanese\n4. Checking for inconsistencies in tone, style, or register compared to the original\n5. Verifying that technical terms are translated accurately and consistently\n6. Ensuring no content was accidentally skipped or added\n7. Finding places where the translation sounds machine-like or overly literal\n\nBe extremely thorough and critical in your assessment. Do not accept mediocre translations.\nList specific issues and suggestions for improvement, organized by severity and category.\nYour critique should be detailed enough for another translator to address all the issues.\n\nYour goal is to help create a perfect translation that reads as if originally written in japanese while being 100% faithful to the source.\n",
      "user_prompt": "# ORIGINAL TEXT\n_TL;DR: You can set a pre-commit-msg git hook to call the `llm` cli and get a summary of your recent code changes as your commit message._\n\nI love hacking on projects, but often I am super bad at making commits that make sense.\n\nFor instance:\n{{< image src=\"/images/posts/commits.png\" caption=\"My terrible commit messages\" >}}\n\nTrash commit messages. I am lazy!\n\n## Never fear, LLMs are here.\n\nOriginally my buddy [Kanno](https://twitter.com/ryankanno?lang=en) sent me a snippet that would allow you to have a simple git alias that would generate a commit message from the git diff. It was pretty robust.\n\n```bash\n# generate comment\ngpt = \"!f() { git diff $1 | sgpt 'Write concise, informative commit messages: Start with a summary in imperative mood, explain the 'why' behind changes, keep the summary under 50 characters, use bullet points for multiple changes, and reference related issues or tickets. What you write will be passed to git commit -m \\\"[message]\\\"'; }; f\"\n```\n\nHowever, I wanted to use Simonâ€™s [LLM cli](https://llm.datasette.io/en/stable/) instead of shell gpt. LLM has way more model support, and can use local models, MLX, etc.\n\nI also wanted the prompt to be stored externally so I could iterate on it without having to fuck with the `.gitconfig` over and over again.\n\nI went ahead and put my prompt in `~/.config/prompts/git-commit-message.txt`. Here is the prompt:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n\n```\n\nAnd here is the updated gpt alias:\n\n```bash\ngpt = \"!f() { git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\" }; f\"\n```\n\nThis did everything I wanted it to do. However, I am lazy, so I wanted to add a bit more magic.\n\nI asked [claude](https://claude.ai) to make it more interactive and allow me to abort the commit message if it sucked.\n\n```bash\nllm = \"!f() { \\\n    if git diff --quiet $1; then \\\n        echo \\\"No changes to commit. Aborting.\\\"; \\\n    else \\\n        commit_msg=$(git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    fi; \\\n}; f\"\n```\n\nThis was so so close. I asked claude again, and we got to this:\n\n```bash\nllm-staged = \"!f() { \\\n    git add -p; \\\n    if ! git diff --cached --quiet; then \\\n        commit_msg=$(git diff --cached | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            git reset HEAD .; \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    else \\\n        echo \\\"No changes staged for commit. Aborting.\\\"; \\\n    fi; \\\n}; f\"\n```\n\nI was satisfied, but this was still too much work, and too kludgy.\n\n## Git Hooked\n\nThen I remembered! Git hooks! Lol. Why would I have that in my brain - who knows!\n\nI asked claude again, and they whipped up a simple script that would act as a hook that triggers with the `prepare-commit-msg` event.\n\nThis is awesome, cuz if you want to add a git message, you can skip the hook. But if you are lazy, you exclude the message and it will call the LLM.\n\nThe commit hook is super simple:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'    # Sets text to red\nGREEN='\\033[0;32m'  # Sets text to green\nYELLOW='\\033[0;33m' # Sets text to yellow\nBLUE='\\033[0;34m'   # Sets text to blue\nNC='\\033[0m'        # Resets the text color to default, no color\n\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  # Array of spinner characters for the animation\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  # Infinite loop to keep the animation running\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis  # Hide the cursor to enhance the animation appearance\n      tput el1    # Clear the line from the cursor to the beginning to display the spinner\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"  # Print the spinner and message\n      sleep 0.1   # Delay to control the speed of the animation\n      tput cub 32 # Move the cursor back 32 columns to reset the spinner position\n    done\n  done\n}\n\n# Check if the commit is a merge commit based on the presence of a second argument\nif [ -n \"$2\" ]; then\n  exit 0  # Exit script if it's a merge commit, no custom message needed\nfi\n\n# Check if the `llm` command is installed\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start the spinning animation in the background\nspin_animation &\nspin_pid=$!  # Capture the process ID of the spinning animation\n\n# Generate the commit message using `git diff` piped into `llm` command\n# The LLM command takes a system prompt from a file as input\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  # Stop the spinning animation by killing its process\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n  # Finalizing output\n  tput cnorm  # Show the cursor again\n  printf \"\\\\n\"  # Move the cursor to the next line\n\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\n# Stop the spinning animation by killing its process\nkill $spin_pid\nwait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n# Finalizing output\ntput cnorm  # Show the cursor again\necho  # Move the cursor to the next line\n\n# Display the generated commit message with color-coded headings\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\n# Write the generated commit message to the specified file (usually the commit message file in .git)\necho \"$commit_msg\" > \"$1\"\n\n\n```\n\n(ChatGPT added the documentation)\n\nIt works! And has a spinner! And catches errors! And is pretty!\n\n![](/images/posts/llm-commit-hook.gif)\n\nNow, whenever I commit without a message, the commit hook executes and sends the diff of the changes to the llm cli with the system prompt previously defined. The output is really nice!\n\n```text\nğŸ¤–ğŸ’¬ AI-powered git commit messages FTW! ğŸš€ğŸ‰\n- Updated content/post/2024-03-11-ai-git-commit-messages.md\n- Added links to my actual git hook and prompt in dotfiles repo ğŸ”—\n- Removed unnecessary code block formatting for the output example ğŸ—‘ï¸\n- AI is making us lazy devs, but who cares when commit messages are this awesome! ğŸ˜‚ğŸ‘Œ\n```\n\nYay. Much better! You can see [my hook](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg) and [my prompt](https://github.com/harperreed/dotfiles/blob/master/.config/prompts/commit-system-prompt.txt) in my dotfiles.\n\nYou can even disable it by setting the `SKIP_LLM_GITHOOK` environment variable.\n\n## How to set this up!\n\n### 1. Install `llm`.\n\nVisit [llm.datasette.io](https://llm.datasette.io/en/stable/) for instructions. I used `pipx` to install it:\n\n```bash\npipx install llm\n```\n\nRemember to set your key and default model.\n\nSet your Openai key:\n\n```bash\nllm keys set openai\n```\n\nSet which model is default:\n\n```bash\nllm models default gpt-4-turbo\n```\n\n(The `llm` cli is awesome. It supports lots of different models (including local models), and contexts. Worth digging in for sure)\n\n### 2. Create a new directory for your prompts:\n\n```bash\nmkdir -p ~/.config/prompts\n```\n\n### 3. Add your system prompt:\n\nThe hook will look in `~/.config/prompts/commit-system-prompt.txt` for the system prompt. You can create a file with the following content:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nThis prompt worked great for me - but let me know if you have changes. I consider this prompt v0.\n\n### 4. Create a new directory for your global Git hooks.\n\nFor example, you can create a directory named `git_hooks` in your home directory:\n\n```bash\nmkdir -p ~/.git_hooks\n```\n\n### 5. Touch the `prepare-commit-msg`\n\nCreate a new file named `prepare-commit-msg` (without any extension) in the `~/.git_hooks` directory.\n\n### 6. Open the `prepare-commit-msg` file in a text editor (vi or death) and add the same content as before:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'    # Sets text to red\nGREEN='\\033[0;32m'  # Sets text to green\nYELLOW='\\033[0;33m' # Sets text to yellow\nBLUE='\\033[0;34m'   # Sets text to blue\nNC='\\033[0m'        # Resets the text color to default, no color\n\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  # Array of spinner characters for the animation\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  # Infinite loop to keep the animation running\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis  # Hide the cursor to enhance the animation appearance\n      tput el1    # Clear the line from the cursor to the beginning to display the spinner\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"  # Print the spinner and message\n      sleep 0.1   # Delay to control the speed of the animation\n      tput cub 32 # Move the cursor back 32 columns to reset the spinner position\n    done\n  done\n}\n\n# Check if the commit is a merge commit based on the presence of a second argument\nif [ -n \"$2\" ]; then\n  exit 0  # Exit script if it's a merge commit, no custom message needed\nfi\n\n# Check if the `llm` command is installed\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start the spinning animation in the background\nspin_animation &\nspin_pid=$!  # Capture the process ID of the spinning animation\n\n# Generate the commit message using `git diff` piped into `llm` command\n# The LLM command takes a system prompt from a file as input\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  # Stop the spinning animation by killing its process\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n  # Finalizing output\n  tput cnorm  # Show the cursor again\n  printf \"\\\\n\"  # Move the cursor to the next line\n\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\n# Stop the spinning animation by killing its process\nkill $spin_pid\nwait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n# Finalizing output\ntput cnorm  # Show the cursor again\necho  # Move the cursor to the next line\n\n# Display the generated commit message with color-coded headings\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\n# Write the generated commit message to the specified file (usually the commit message file in .git)\necho \"$commit_msg\" > \"$1\"\n\n\n```\n\nYou can see [mine in my dotfiles](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg).\n\n### 7. Make the `prepare-commit-msg` file executable\n\nRun the following command in your terminal:\n\n```bash\nchmod +x ~/.git_hooks/prepare-commit-msg\n```\n\n### 8. Configure Git to use your global hooks directory\n\nRun the following command to set your global hooks directory\n\n```bash\ngit config --global core.hooksPath ~/.git_hooks\n```\n\n### 9. Code, build things and then commit something\n\n## Explanation on how it works\n\nThis command sets the `core.hooksPath` configuration option to your global hooks directory (`~/.git_hooks`).\n\nNow, whenever you run `git commit` in any of your repositories, Git will execute the global `prepare-commit-msg` hook located in `~/.git_hooks/prepare-commit-msg`. The hook will generate the commit message based on the staged changes using the `llm` command and the system prompt from `~/.config/prompts/commit-system-prompt.txt`.\n\nBy setting up a global `prepare-commit-msg` hook, you can have the commit message generation functionality available in all your repositories without the need to set it up individually for each repository.\n\nRemember to have the `llm` command and the `~/.config/prompts/commit-system-prompt.txt` file set up correctly for the global hook to work as expected.\n\nWith this global hook in place, you can simply stage your changes normally using `git add` or `git add -p`, and then run `git commit`.\n\nThe global `prepare-commit-msg` hook will automatically generate the commit message for you, ready for review and editing before finalizing the commit.\n\nIf you want to skip the LLM commit message generation, just commit with a message: `git commit -m â€œfixed issue #420â€`. This seems to bypass the pre commit hook.\n\n## This is just a hack. AI will hallucinate.\n\nI had fun building this, and it is hilarious.\n\nI have had it hallucinate hilarious things. Never making up changes (thus far), but doing weird shit like adding â€œFixed issue #54â€ at the end.\n\nLike everything in life, YMMV.\n\nIf this is helpful, send me an email and let me know! My email is [harper@modest.com](mailto:harper@modest.com).\n\n# CURRENT TRANSLATION\n_TL;DR: `prepare-commit-msg` Git ãƒ•ãƒƒã‚¯ã« `llm` CLI ã‚’ä»•è¾¼ã‚ã°ã€ç›´è¿‘ã®å¤‰æ›´ã‚’ã–ã£ãã‚Šã¾ã¨ã‚ãŸã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•ã§ç”Ÿæˆã§ãã‚‹ï¼ˆTL;DR ã§ã¯ pre-commit-msg ã£ã¦æ›¸ã„ã¡ã‚ƒã£ãŸã‘ã©ã€ã“ã®è¨˜äº‹ã§ã¯ prepare-commit-msg ã‚’ä½¿ã†ãï¼‰ã€‚_\n\nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒãƒƒã‚¯ã™ã‚‹ã®ã¯å¤§å¥½ãã ã‘ã©ã€ã¾ã¨ã‚‚ãªã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ›¸ãã®ã¯è¶…è‹¦æ‰‹ã€‚ã»ã‚“ã¨æ€ ã‘è€…ãªã‚“ã ã‚ˆã­ã€‚\n\nãŸã¨ãˆã°ã“ã‚Œ:  \n{{< image src=\"/images/posts/commits.png\" caption=\"My terrible commit messages\" >}}\n\nã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚´ãƒŸåŒç„¶ã€‚ã‚¯ã‚½æ€ ã‘è€…ã§ã™ã‚ã€‚\n\n## Never fear, LLMs are here.\n\nç›¸æ£’ã® [Kanno](https://twitter.com/ryankanno?lang=en) ãŒã€`git diff` ã‹ã‚‰ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã‚·ãƒ³ãƒ—ãƒ«ãª Git ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’é€ã£ã¦ãã‚ŒãŸã€‚ã‹ãªã‚Šã—ã£ã‹ã‚Šå‹•ããƒ¤ãƒ„ã€‚\n\n```bash\n# generate comment\ngpt = \"!f() { git diff $1 | sgpt 'Write concise, informative commit messages: Start with a summary in imperative mood, explain the 'why' behind changes, keep the summary under 50 characters, use bullet points for multiple changes, and reference related issues or tickets. What you write will be passed to git commit -m \\\"[message]\\\"'; }; f\"\n```\n\nã§ã‚‚ã‚ªãƒ¬ã¯ shell-gpt ã˜ã‚ƒãªãã¦ Simon ã® `llm` CLI ã‚’ä½¿ã„ãŸã‹ã£ãŸã€‚`llm` ã¯å¯¾å¿œãƒ¢ãƒ‡ãƒ«ãŒæ®µé•ã„ã«å¤šã„ã—ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«ã‚„ MLX ã‚‚ä½¿ãˆã‚‹ã€‚\n\nãã‚Œã¨ `.gitconfig` ã‚’ã„ã¡ã„ã¡ã‚¯ã‚½å¼„ã‚Šå›ã™ã®ã¯é¢å€’ãã•éãã‚‹ã‹ã‚‰ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã«ã—ã¦ãŠããŸã„ã€‚\n\nã¨ã„ã†ã‚ã‘ã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ `~/.config/prompts/git-commit-message.txt` ã«çªã£è¾¼ã‚“ã ã€‚ä¸­èº«ã¯ã“ã‚“ãªæ„Ÿã˜:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nãã‚Œã‚’è¸ã¾ãˆã¦ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ã“ã†æ›´æ–°:\n\n```bash\ngpt = \"!f() { git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\" }; f\"\n```\n\nã“ã‚Œã§ã‚„ã‚ŠãŸã„ã“ã¨ã¯ã»ã¼å‡ºæ¥ãŸã€‚ã§ã‚‚ã‚ªãƒ¬ã¯æ€ ã‘è€…ã ã—ã€ã¾ã å ´å½“ãŸã‚Šãƒãƒƒã‚¯æ„ŸãŒå¼·ã™ãã‚‹ã€‚\n\nãã“ã§ [Claude](https://claude.ai) ã«é ¼ã‚“ã§ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«ã—ã¦ã€Œãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ°—ã«é£Ÿã‚ãªãã‚ƒ abortã€ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã‚‚ã‚‰ã£ãŸã€‚\n\n```bash\nllm = \"!f() { \\\n    if git diff --quiet $1; then \\\n        echo \\\"No changes to commit. Aborting.\\\"; \\\n    else \\\n        commit_msg=$(git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    fi; \\\n}; f\"\n```\n\nã‚ã¨ä¸€æ­©ã£ã¦æ„Ÿã˜ã ã£ãŸã‘ã©ã€ã•ã‚‰ã«è©°ã‚ã¦ã“ã†ãªã£ãŸ:\n\n```bash\nllm-staged = \"!f() { \\\n    git add -p; \\\n    if ! git diff --cached --quiet; then \\\n        commit_msg=$(git diff --cached | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            git reset HEAD .; \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    else \\\n        echo \\\"No changes staged for commit. Aborting.\\\"; \\\n    fi; \\\n}; f\"\n```\n\næº€è¶³ã¯ã—ãŸã‘ã©ã€ã¾ã ã”ã¡ã‚ƒã£ã¨ã—éãã¦ã‚‹ã€‚\n\n## Git Hook ã« Get HookedğŸ”¥\n\nãã“ã§ã€Œãã†ã ã€Git ãƒ•ãƒƒã‚¯ãŒã‚ã£ãŸã˜ã‚ƒã‚“ï½—ã€ã¨ã²ã‚‰ã‚ã„ãŸã€‚\n\nClaude ã«ã‚‚ã†ä¸€å›ãŠé¡˜ã„ã—ã¦ã€`prepare-commit-msg` ã‚¤ãƒ™ãƒ³ãƒˆã§èµ°ã‚‹ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ•ãƒƒã‚¯ã‚’æ›¸ã„ã¦ã‚‚ã‚‰ã£ãŸã€‚\n\nè‡ªåˆ†ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã™ã‚Œã°ãƒ•ãƒƒã‚¯ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹ã€‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’çœã‘ã° LLM ãŒå‘¼ã°ã‚Œã‚‹ã€‚æœ€é«˜ã™ãã€‚\n\nãƒ•ãƒƒã‚¯ã¯ã“ã‚“ãªæ„Ÿã˜:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[0;33m'\nBLUE='\\033[0;34m'\nNC='\\033[0m'\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis\n      tput el1\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"\n      sleep 0.1\n      tput cub 32\n    done\n  done\n}\n\n# Skip on merge commits\nif [ -n \"$2\" ]; then\n  exit 0\nfi\n\n# Check if `llm` exists\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start spinner\nspin_animation &\nspin_pid=$!\n\n# Generate commit message\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null\n  tput cnorm\n  printf \"\\\\n\"\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\nkill $spin_pid\nwait $spin_pid 2>/dev/null\ntput cnorm\necho\n\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\necho \"$commit_msg\" > \"$1\"\n```\n\n(ChatGPT ãŒã‚³ãƒ¡ãƒ³ãƒˆã‚’ç››ã‚Šã¾ãã£ã¦ãã‚ŒãŸ)\n\nã¡ã‚ƒã‚“ã¨å‹•ãã—ã€ã‚¹ãƒ”ãƒŠãƒ¼ã‚‚ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚ã‚ã£ã¦è¦‹ãŸç›®ã‚‚ã‚¯ãƒ¼ãƒ«ï¼\n\n![](/images/posts/llm-commit-hook.gif)\n\nã“ã‚Œã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç„¡ã—ã§ `git commit` ã™ã‚‹ã¨ãƒ•ãƒƒã‚¯ãŒç™ºç«ã—ã€ã‚¹ãƒ†ãƒ¼ã‚¸æ¸ˆã¿ã®å¤‰æ›´ã‚’ `llm` CLI ã«é€ã‚Šã€å…ˆã®ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã€‚å‡ºåŠ›ã‚‚ã„ã„æ„Ÿã˜:\n\n```text\nğŸ¤–ğŸ’¬ AI-powered git commit messages FTW! ğŸš€ğŸ‰\n- Updated content/post/2024-03-11-ai-git-commit-messages.md\n- Added links to my actual git hook and prompt in dotfiles repo ğŸ”—\n- Removed unnecessary code block formatting for the output example ğŸ—‘ï¸\n- AI is making us lazy devs, but who cares when commit messages are this awesome! ğŸ˜‚ğŸ‘Œ\n```\n\nã‚„ã£ãŸãƒ¼ï¼ã€€ã‚ªãƒ¬ã® [ãƒ•ãƒƒã‚¯](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg) ã¨ [ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ](https://github.com/harperreed/dotfiles/blob/master/.config/prompts/commit-system-prompt.txt) ã¯ dotfiles ã«ç½®ã„ã¦ã‚ã‚‹ã‹ã‚‰ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¦ã­ã€‚`SKIP_LLM_GITHOOK` ç’°å¢ƒå¤‰æ•°ã‚’ã‚»ãƒƒãƒˆã™ã‚Œã°ã“ã®ä»•çµ„ã¿ã¯ç„¡åŠ¹åŒ–ã§ãã‚‹ã€‚\n\n## How to set this up!\n\n### 1. Install `llm`.\n\n[llm.datasette.io](https://llm.datasette.io/en/stable/) ã‚’å‚ç…§ã€‚ã‚ªãƒ¬ã¯ `pipx` ã§å…¥ã‚ŒãŸ:\n\n```bash\npipx install llm\n```\n\nOpenAI ã‚­ãƒ¼ã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¢ãƒ‡ãƒ«ã‚’è¨­å®š:\n\n```bash\nllm keys set openai\nllm models default gpt-4-turbo\n```\n\n(`llm` CLI ã¯ãƒã‚¸å„ªç§€ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«å«ã‚ã„ã‚ã‚“ãªãƒ¢ãƒ‡ãƒ«ãŒä½¿ãˆã‚‹ã—ã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚‚æŸ”è»Ÿã«ã„ã˜ã‚Œã‚‹ã€‚æ˜ã‚Šç”²æ–ã‚ã‚‹ã‚ˆ)\n\n### 2. Create a new directory for your prompts:\n\n```bash\nmkdir -p ~/.config/prompts\n```\n\n### 3. Add your system prompt:\n\nãƒ•ãƒƒã‚¯ã¯ `~/.config/prompts/commit-system-prompt.txt` ã‚’èª­ã‚€ã€‚ä»¥ä¸‹ã‚’ä¿å­˜:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nã“ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯ã¨ã‚Šã‚ãˆãš v0ã€‚ã‚‚ã£ã¨è‰¯ã„ã‚¢ã‚¤ãƒ‡ã‚¢ãŒã‚ã‚Œã°æ•™ãˆã¦ãã‚Œã€‚\n\n### 4. Create a new directory for your global Git hooks.\n\n```bash\nmkdir -p ~/.git_hooks\n```\n\n### 5. Touch the `prepare-commit-msg`\n\n`~/.git_hooks` ã«æ‹¡å¼µå­ãªã—ã§ `prepare-commit-msg` ã‚’ä½œæˆã€‚\n\n### 6. Open the `prepare-commit-msg` file in a text editor (vi or death) and add the same content as before:\n\nä¸Šã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ãã®ã¾ã¾è²¼ã‚Šä»˜ã‘ã¦ä¿å­˜ã€‚\n\n### 7. Make the `prepare-commit-msg` file executable\n\n```bash\nchmod +x ~/.git_hooks/prepare-commit-msg\n```\n\n### 8. Configure Git to use your global hooks directory\n\n```bash\ngit config --global core.hooksPath ~/.git_hooks\n```\n\n### 9. Code, build things and then commit something\n\n## Explanation on how it works\n\n`core.hooksPath` ã‚’ `~/.git_hooks` ã«è¨­å®šã—ãŸã“ã¨ã§ã€ã©ã®ãƒªãƒã§ã‚‚ `git commit` ã™ã‚‹ã¨ã‚°ãƒ­ãƒ¼ãƒãƒ« `prepare-commit-msg` ãŒèµ°ã‚‹ã€‚ãƒ•ãƒƒã‚¯ã¯ã‚¹ãƒ†ãƒ¼ã‚¸æ¸ˆã¿ã®å¤‰æ›´ã‚’ `llm` ã¨ `~/.config/prompts/commit-system-prompt.txt` ã«æ¸¡ã—ã€ç”Ÿæˆã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã‚€ã€‚\n\nLLM ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ãŸã„ï¼Ÿã€€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä»˜ãã§ã‚³ãƒŸãƒƒãƒˆã™ã‚Œã° OK:\n\n```bash\ngit commit -m \"fixed issue #420\"\n```\n\nã“ã‚Œã§ pre-commit ãƒ•ãƒƒã‚¯ã‚‚ã™ã£é£›ã°ã•ã‚Œã‚‹ã£ã½ã„ ğŸ¤”\n\n## This is just a hack. AI will hallucinate.\n\nä½œã£ã¦ã¦ã‚ã¡ã‚ƒãã¡ã‚ƒæ¥½ã—ã‹ã£ãŸã—ç¬‘ãˆã‚‹ã€‚ã§ã‚‚ãŸã¾ã«ã€ŒFixed issue #54ã€ã¿ãŸã„ãªè¬ã‚’ã­ã˜è¾¼ã‚“ã§ãã‚‹ã€‚ã„ã¾ã®ã¨ã“ã‚å®Ÿéš›ã®å¤‰æ›´ã‚’æé€ ã—ãŸã“ã¨ã¯ãªã„ã‘ã©ã€YMMVï¼ˆYour Mileage May Varyâ€•çµæœã¯äººãã‚Œãã‚Œï¼‰ã ã€‚\n\nã‚‚ã—å½¹ã«ç«‹ã£ãŸã‚‰ãƒ¡ãƒ¼ãƒ«ãã‚Œï¼ [harper@modest.com](mailto:harper@modest.com)\n\nPlease critique this translation mercilessly and provide detailed feedback on what needs to be improved.\nFormat your critique as a structured list of issues, organized by severity and category.\nInclude specific suggestions for how to fix each issue.",
      "response": "ã€é‡å¤§åº¦ï¼šé«˜ã€€â”€ã€€æ„å‘³ã®èª¤è¨³ãƒ»æƒ…å ±ã®è¿½åŠ ï¼æ¬ è½ã€‘\n\n1. TL;DR ã®å†…å®¹æ”¹å¤‰  \n   åŸæ–‡: â€œYou can set a pre-commit-msg git hook â€¦â€  \n   ç¿»è¨³: â€œprepare-commit-msg ã‚’ä½¿ã†ãâ€ ã¨æ–­å®šã—ã€ã•ã‚‰ã« â€œTL;DR ã§ã¯ pre-commit-msg ã£ã¦æ›¸ã„ã¡ã‚ƒã£ãŸã‘ã©â€¦â€ ã¨ç‹¬è‡ªã®æ³¨é‡ˆã‚’æŒ¿å…¥ã€‚  \n   å•é¡Œ: åŸæ–‡ã«ã¯ã€Œæ›¸ãé–“é•ã„ã‚’è‡ªè¦šã—ã¦ã„ã‚‹ã€ã¨ã„ã†ãƒ¡ã‚¿æƒ…å ±ã¯ãªã„ã€‚èª­è€…ã«ã€ŒåŸä½œè€…ãŒãƒŸã‚¹ã—ãŸã€ã‚ˆã†ãªå°è±¡ã‚’ä¸ãˆã€äº‹å®Ÿã‚’ã­ã˜æ›²ã’ã¦ã„ã‚‹ã€‚  \n   ä¿®æ­£æ¡ˆ: åŸæ–‡ã©ãŠã‚Š pre-commit-msg ã‚’æ¡ç”¨ã—ã€æ³¨é‡ˆã‚’å…¥ã‚Œãªã„ã€‚ã‚‚ã—å¾Œæ®µã§ prepare-commit-msg ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹ä¸ä¸€è‡´ã‚’èª¬æ˜ã—ãŸã„å ´åˆã§ã‚‚ã€Œè¨³æ³¨ã€ã¨æ˜ç¤ºã—è§’æ‹¬å¼§ã§è£œã†ã€‚\n\n2. pre-commit ã¨ prepare-commit ã®æ··åœ¨  \n   å¾ŒåŠã§ã‚‚ â€œpre-commit ãƒ•ãƒƒã‚¯ã‚‚ã™ã£é£›ã°ã•ã‚Œã‚‹ã£ã½ã„ ğŸ¤”â€ ã¨æ›¸ãã€ä¾ç„¶ã¨ã—ã¦ãƒ•ãƒƒã‚¯åãŒæºã‚Œã¦ã„ã‚‹ã€‚  \n   ä¿®æ­£æ¡ˆ: å…¨æ–‡ã§ â€œprepare-commit-msg ãƒ•ãƒƒã‚¯â€ ã«çµ±ä¸€ï¼ˆã‚‚ã—ãã¯åŸæ–‡ã«å¿ å®Ÿã« pre-commit-msg ã§çµ±ä¸€ï¼‰ã€è„±å­—ã€Œ-msgã€ã‚’è£œå®Œã€‚\n\n3. â€œvi or deathâ€ ã®æœªè¨³ãƒ»èª­ç‚¹æ¬ è½  \n   åŸæ–‡ã¯é»’ã„ãƒ¦ãƒ¼ãƒ¢ã‚¢ (â€œuse vi or die tryingâ€) ãŒè¾¼ã‚ã‚‰ã‚Œã¦ã„ã‚‹ãŒã€ã€Œvi or deathã€ã¨ãã®ã¾ã¾æ®‹ã—æ„å‘³ãŒæ›–æ˜§ã€‚  \n   ä¿®æ­£æ¡ˆ: ã€Œ(vi ã‚’ä½¿ã†ã‹æ­»ã‹ã ãœ)ã€ãªã©æ„å›³ã‚’ç¤ºã™ã‹ã€èª­è€…ãŒç†è§£ã§ãã‚‹è¨€ã„æ›ãˆã‚’æ³¨é‡ˆä»˜ãã§æç¤ºã€‚\n\n4. â€œChatGPT added the documentationâ€  \n   åŸæ–‡ã§ã¯å˜ã« 1 è¡Œã ãŒã€è¨³æ–‡ã¯ â€œChatGPT ãŒã‚³ãƒ¡ãƒ³ãƒˆã‚’ç››ã‚Šã¾ãã£ã¦ãã‚ŒãŸâ€ ã¨èª‡å¼µè¡¨ç¾ã‚’è¿½åŠ ã€‚  \n   ä¿®æ­£æ¡ˆ: ã€Œ(ChatGPT ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ãŸ)ã€ç¨‹åº¦ã«æŠ‘ãˆã€ä¸è¦ãªè„šè‰²ã‚’é¿ã‘ã‚‹ã€‚\n\nã€é‡å¤§åº¦ï¼šä¸­ã€€â”€ã€€ãƒˆãƒ¼ãƒ³ãƒ»ãƒ¬ã‚¸ã‚¹ã‚¿ã®ä¸æ•´åˆã€‘\n\n5. ä¸€äººç§°ãƒ»èªèª¿ã®ä¹±ã‚Œ  \n   ãƒ»â€œã‚ªãƒ¬â€â€œã‚¯ã‚½æ€ ã‘è€…ã§ã™ã‚â€â€œã‚„ã£ãŸãƒ¼â€ ç­‰ã€ç”·æ€§å£èªãƒ»å¥³è¨€è‘‰ãƒ»ç •ã‘ãŸè‹¥è€…è¨€è‘‰ãŒæ··åœ¨ã€‚  \n   ãƒ»â€œã§ã™ï¼ã¾ã™â€ä½“ã¨å¸¸ä½“ãŒæ®µè½ã”ã¨ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹ã€‚  \n   ä¿®æ­£æ¡ˆ: åŸæ–‡ã¯ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ã§ä¸€è²«ã—ã¦ã„ã‚‹ãŸã‚ã€æ—¥æœ¬èªã‚‚å¸¸ä½“ï¼‹ã‚„ã‚„ç •ã‘ãŸèªèª¿ã§çµ±ä¸€ (â€œä¿ºã¯ã€œâ€â€œã‚¯ã‚½æ€ ã‘è€…ã â€)ã€ã‚ã‚‹ã„ã¯ä¸å¯§ä½“ã«çµ±ä¸€ã€‚\n\n6. ç½µå€’èªã®å¼·åº¦ä¸Šã’éã  \n   â€œTrash commit messagesâ€ â†’ â€œã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚´ãƒŸåŒç„¶â€ ç¨‹åº¦ã§ååˆ†ã ãŒã€ã€Œã‚¯ã‚½æ€ ã‘è€…ã€ã€Œã‚¯ã‚½å¼„ã‚Šå›ã™ã€ãªã©åŸæ–‡ä»¥ä¸Šã«ä¸‹å“ã€‚  \n   ä¿®æ­£æ¡ˆ: åŸæ–‡ã¨åŒç¨‹åº¦ã®è»½ã„ç½µå€’ã«æŠ‘ãˆã‚‹ (â€œã‚ã¡ã‚ƒãã¡ã‚ƒæ€ ã‘è€…â€).\n\n7. ä¸è‡ªç„¶ãªå’Œè£½è‹±èªæ··åˆã‚¿ã‚¤ãƒˆãƒ«  \n   â€œGit Hook ã« Get HookedğŸ”¥â€ ã¯ãƒ€ã‚¸ãƒ£ãƒ¬ã‚’å¼·å¼•ã«æ—¥æœ¬èªã¸æŒã¡è¾¼ã‚“ã§ãŠã‚Šèª­ã¿ã¥ã‚‰ã„ã€‚  \n   ä¿®æ­£æ¡ˆ: ã€ŒGit Hook ã«ãƒãƒã‚‹ã€ã€ŒGit Hook ã§è§£æ±ºï¼ã€ãªã©ã‚·ãƒ³ãƒ—ãƒ«ã«ã€‚\n\nã€é‡å¤§åº¦ï¼šä¸­ã€€â”€ã€€æŠ€è¡“ç”¨èªãƒ»è¡¨è¨˜ã€‘\n\n8. ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã®è¨³æ³¨ãªã—  \n   è¨˜äº‹å†…ã§ `git-commit-message.txt` ã¨ `commit-system-prompt.txt` ãŒæ··åœ¨ã™ã‚‹ãŒã€è¨³æ–‡ã¯åŸæ–‡ã®æ··åœ¨ã‚’ãã®ã¾ã¾è¸è¥²ã—èª¬æ˜ã‚’è£œã£ã¦ã„ãªã„ã€‚  \n   ä¿®æ­£æ¡ˆ: â€œâ€»ã“ã®è¨˜äº‹ã§ã¯é€”ä¸­ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«åãŒå¤‰ã‚ã‚‹ãŒâ€¦ â€ã¨è¨³æ³¨ã§è£œè¶³ã™ã‚‹ã‹ã€è„šæ³¨ã§æ•´ç†ã€‚\n\n9. ã‚³ãƒãƒ³ãƒ‰åã®å…¨è§’å¼•ç”¨ç¬¦  \n   â€œgit commit -m â€œfixed issue #420â€â€ ã®äºŒé‡å¼•ç”¨ç¬¦ãŒå…¨è§’ã«ãªã£ã¦ã„ã‚‹ã€‚ã‚·ã‚§ãƒ«ã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦èª¤å‹•ä½œã™ã‚‹ã€‚  \n   ä¿®æ­£æ¡ˆ: åŠè§’ã® \"\" ã‚’ä½¿ç”¨ã€‚\n\nã€é‡å¤§åº¦ï¼šå°ã€€â”€ã€€æ–‡æ³•ãƒ»è¨€ã„å›ã—ã€‘\n\n10. ã€Œã»ã‚“ã¨æ€ ã‘è€…ãªã‚“ã ã‚ˆã­ã€‚ã€  \n    â€œãªã‚“ã ã‚ˆã­â€ ã®èªå°¾ã¯å£èªãŒå¼·ã™ãã€ç¶šãæ–‡ã§ â€œã§ã™ã‚â€ ã¨å™›ã¿åˆã‚ãªã„ã€‚èªèª¿çµ±ä¸€ã‚’ã€‚  \n\n11. ã€Œvi or death ã‚’å‚ç…§ã€  \n    ç›´è¨³æ„ŸãŒå¼·ã„ã€‚å‰è¿°ã®ã¨ãŠã‚Šæ„è¨³ï¼‹è£œè¶³ã‚’å…¥ã‚Œã‚‹ã€‚\n\n12. ã€Œæ˜ã‚Šç”²æ–ã‚ã‚‹ã‚ˆã€  \n    æ„å‘³ã¯ä¼ã‚ã‚‹ãŒã€Œã„ã˜ã‚‹ä¾¡å€¤ãŒã‚ã‚‹ã‚ˆã€ã€Œè©¦ã™ä¾¡å€¤ãŒã‚ã‚‹ã‚ˆã€ã®ã»ã†ãŒè‡ªç„¶ã€‚\n\n13. emoji ã®å¤šç”¨  \n    åŸæ–‡ã‚‚å¤šå°‘ emoji ã‚’ç”¨ã„ã¦ã„ã‚‹ãŒã€è¨³æ–‡ã§è¿½åŠ ã—ãŸ ğŸ¤”ğŸ”¥ ã¯ä¸è¦ã€‚åŸæ–‡ã®çµµæ–‡å­—ã ã‘ã‚’ç¶­æŒã€‚\n\nã€é‡å¤§åº¦ï¼šå°ã€€â”€ã€€æ©Ÿæ¢°ç¿»è¨³è‡­ãƒ»ãã“ã¡ãªã•ã€‘\n\n14. â€œå ´å½“ãŸã‚Šãƒãƒƒã‚¯æ„ŸãŒå¼·ã™ãã‚‹â€  \n    â€œå ´å½“ãŸã‚Šçš„ã™ãã‚‹â€ ã®ã»ã†ãŒè‡ªç„¶ã€‚\n\n15. ã€Œæœ€é«˜ã™ãã€  \n    å£èªã¨ã—ã¦æˆç«‹ã™ã‚‹ãŒ â€œãƒã‚¸æœ€é«˜â€ ã‚„ â€œæœ€é«˜ã â€ ã®æ–¹ãŒæ»‘ã‚‰ã‹ã€‚\n\nã€ã¾ã¨ã‚ã€‘\n\nãƒ»TL;DR ã®å‹æ‰‹ãªè£œè¶³ã€ãƒ•ãƒƒã‚¯åã®æ··ä¹±ã€éåº¦ã®è„šè‰²ï¼ˆemoji/ã‚¹ãƒ©ãƒ³ã‚°/ç½µå€’èªï¼‰ã¯æœ€å„ªå…ˆã§ä¿®æ­£ã€‚  \nãƒ»èªèª¿ã‚’å¸¸ä½“ã«çµ±ä¸€ã—ã€ç½µå€’èªã®å¼·åº¦ã‚’åŸæ–‡ç›¸å½“ã«ä¸‹ã’ã‚‹ã€‚  \nãƒ»åŸæ–‡ã§å®Ÿéš›ã«å­˜åœ¨ã—ãªã„æƒ…å ±ã‚„è©•ä¾¡ã‚’è¿½åŠ ã—ãªã„ã€‚  \nãƒ»æŠ€è¡“æƒ…å ±ï¼ˆãƒ‘ã‚¹åãƒ»ã‚³ãƒãƒ³ãƒ‰ï¼‰ã®æºã‚Œã‚„å…¨è§’è¨˜å·ã‚’æ­£ã™ã€‚  \n\nä»¥ä¸Šã‚’ç›´ã›ã°ã€åŸæ–‡ã®ãƒãƒªã‚’ä¿ã¡ã¤ã¤ã‚‚èª­ã¿ã‚„ã™ãã€æ­£ç¢ºãªæ—¥æœ¬èªè¨³ã«ãªã‚‹ã€‚",
      "usage": {
        "prompt_tokens": 7329,
        "completion_tokens": 1405,
        "total_tokens": 8734
      },
      "streaming": true
    },
    "feedback": {
      "model": "o3",
      "target_language": "japanese",
      "system_prompt": "You are a master translator and editor specializing in japanese.\nYour task is to improve a translation based on detailed critique feedback.\n\n1. Carefully read the original text, current translation, and the critique feedback\n2. Address ALL issues identified in the critique\n3. Apply the specific suggestions for improvement\n4. Ensure the translation is accurate, natural-sounding, and faithful to the original\n5. Preserve all formatting, markdown, and structure of the original text\n6. Make sure the final text reads as if it were originally written in japanese\n\nDo not ignore any of the critique points. Every issue identified must be addressed in your improved version.\n",
      "user_prompt": "# ORIGINAL TEXT\n_TL;DR: You can set a pre-commit-msg git hook to call the `llm` cli and get a summary of your recent code changes as your commit message._\n\nI love hacking on projects, but often I am super bad at making commits that make sense.\n\nFor instance:\n{{< image src=\"/images/posts/commits.png\" caption=\"My terrible commit messages\" >}}\n\nTrash commit messages. I am lazy!\n\n## Never fear, LLMs are here.\n\nOriginally my buddy [Kanno](https://twitter.com/ryankanno?lang=en) sent me a snippet that would allow you to have a simple git alias that would generate a commit message from the git diff. It was pretty robust.\n\n```bash\n# generate comment\ngpt = \"!f() { git diff $1 | sgpt 'Write concise, informative commit messages: Start with a summary in imperative mood, explain the 'why' behind changes, keep the summary under 50 characters, use bullet points for multiple changes, and reference related issues or tickets. What you write will be passed to git commit -m \\\"[message]\\\"'; }; f\"\n```\n\nHowever, I wanted to use Simonâ€™s [LLM cli](https://llm.datasette.io/en/stable/) instead of shell gpt. LLM has way more model support, and can use local models, MLX, etc.\n\nI also wanted the prompt to be stored externally so I could iterate on it without having to fuck with the `.gitconfig` over and over again.\n\nI went ahead and put my prompt in `~/.config/prompts/git-commit-message.txt`. Here is the prompt:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n\n```\n\nAnd here is the updated gpt alias:\n\n```bash\ngpt = \"!f() { git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\" }; f\"\n```\n\nThis did everything I wanted it to do. However, I am lazy, so I wanted to add a bit more magic.\n\nI asked [claude](https://claude.ai) to make it more interactive and allow me to abort the commit message if it sucked.\n\n```bash\nllm = \"!f() { \\\n    if git diff --quiet $1; then \\\n        echo \\\"No changes to commit. Aborting.\\\"; \\\n    else \\\n        commit_msg=$(git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    fi; \\\n}; f\"\n```\n\nThis was so so close. I asked claude again, and we got to this:\n\n```bash\nllm-staged = \"!f() { \\\n    git add -p; \\\n    if ! git diff --cached --quiet; then \\\n        commit_msg=$(git diff --cached | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            git reset HEAD .; \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    else \\\n        echo \\\"No changes staged for commit. Aborting.\\\"; \\\n    fi; \\\n}; f\"\n```\n\nI was satisfied, but this was still too much work, and too kludgy.\n\n## Git Hooked\n\nThen I remembered! Git hooks! Lol. Why would I have that in my brain - who knows!\n\nI asked claude again, and they whipped up a simple script that would act as a hook that triggers with the `prepare-commit-msg` event.\n\nThis is awesome, cuz if you want to add a git message, you can skip the hook. But if you are lazy, you exclude the message and it will call the LLM.\n\nThe commit hook is super simple:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'    # Sets text to red\nGREEN='\\033[0;32m'  # Sets text to green\nYELLOW='\\033[0;33m' # Sets text to yellow\nBLUE='\\033[0;34m'   # Sets text to blue\nNC='\\033[0m'        # Resets the text color to default, no color\n\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  # Array of spinner characters for the animation\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  # Infinite loop to keep the animation running\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis  # Hide the cursor to enhance the animation appearance\n      tput el1    # Clear the line from the cursor to the beginning to display the spinner\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"  # Print the spinner and message\n      sleep 0.1   # Delay to control the speed of the animation\n      tput cub 32 # Move the cursor back 32 columns to reset the spinner position\n    done\n  done\n}\n\n# Check if the commit is a merge commit based on the presence of a second argument\nif [ -n \"$2\" ]; then\n  exit 0  # Exit script if it's a merge commit, no custom message needed\nfi\n\n# Check if the `llm` command is installed\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start the spinning animation in the background\nspin_animation &\nspin_pid=$!  # Capture the process ID of the spinning animation\n\n# Generate the commit message using `git diff` piped into `llm` command\n# The LLM command takes a system prompt from a file as input\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  # Stop the spinning animation by killing its process\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n  # Finalizing output\n  tput cnorm  # Show the cursor again\n  printf \"\\\\n\"  # Move the cursor to the next line\n\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\n# Stop the spinning animation by killing its process\nkill $spin_pid\nwait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n# Finalizing output\ntput cnorm  # Show the cursor again\necho  # Move the cursor to the next line\n\n# Display the generated commit message with color-coded headings\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\n# Write the generated commit message to the specified file (usually the commit message file in .git)\necho \"$commit_msg\" > \"$1\"\n\n\n```\n\n(ChatGPT added the documentation)\n\nIt works! And has a spinner! And catches errors! And is pretty!\n\n![](/images/posts/llm-commit-hook.gif)\n\nNow, whenever I commit without a message, the commit hook executes and sends the diff of the changes to the llm cli with the system prompt previously defined. The output is really nice!\n\n```text\nğŸ¤–ğŸ’¬ AI-powered git commit messages FTW! ğŸš€ğŸ‰\n- Updated content/post/2024-03-11-ai-git-commit-messages.md\n- Added links to my actual git hook and prompt in dotfiles repo ğŸ”—\n- Removed unnecessary code block formatting for the output example ğŸ—‘ï¸\n- AI is making us lazy devs, but who cares when commit messages are this awesome! ğŸ˜‚ğŸ‘Œ\n```\n\nYay. Much better! You can see [my hook](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg) and [my prompt](https://github.com/harperreed/dotfiles/blob/master/.config/prompts/commit-system-prompt.txt) in my dotfiles.\n\nYou can even disable it by setting the `SKIP_LLM_GITHOOK` environment variable.\n\n## How to set this up!\n\n### 1. Install `llm`.\n\nVisit [llm.datasette.io](https://llm.datasette.io/en/stable/) for instructions. I used `pipx` to install it:\n\n```bash\npipx install llm\n```\n\nRemember to set your key and default model.\n\nSet your Openai key:\n\n```bash\nllm keys set openai\n```\n\nSet which model is default:\n\n```bash\nllm models default gpt-4-turbo\n```\n\n(The `llm` cli is awesome. It supports lots of different models (including local models), and contexts. Worth digging in for sure)\n\n### 2. Create a new directory for your prompts:\n\n```bash\nmkdir -p ~/.config/prompts\n```\n\n### 3. Add your system prompt:\n\nThe hook will look in `~/.config/prompts/commit-system-prompt.txt` for the system prompt. You can create a file with the following content:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nThis prompt worked great for me - but let me know if you have changes. I consider this prompt v0.\n\n### 4. Create a new directory for your global Git hooks.\n\nFor example, you can create a directory named `git_hooks` in your home directory:\n\n```bash\nmkdir -p ~/.git_hooks\n```\n\n### 5. Touch the `prepare-commit-msg`\n\nCreate a new file named `prepare-commit-msg` (without any extension) in the `~/.git_hooks` directory.\n\n### 6. Open the `prepare-commit-msg` file in a text editor (vi or death) and add the same content as before:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'    # Sets text to red\nGREEN='\\033[0;32m'  # Sets text to green\nYELLOW='\\033[0;33m' # Sets text to yellow\nBLUE='\\033[0;34m'   # Sets text to blue\nNC='\\033[0m'        # Resets the text color to default, no color\n\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  # Array of spinner characters for the animation\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  # Infinite loop to keep the animation running\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis  # Hide the cursor to enhance the animation appearance\n      tput el1    # Clear the line from the cursor to the beginning to display the spinner\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"  # Print the spinner and message\n      sleep 0.1   # Delay to control the speed of the animation\n      tput cub 32 # Move the cursor back 32 columns to reset the spinner position\n    done\n  done\n}\n\n# Check if the commit is a merge commit based on the presence of a second argument\nif [ -n \"$2\" ]; then\n  exit 0  # Exit script if it's a merge commit, no custom message needed\nfi\n\n# Check if the `llm` command is installed\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start the spinning animation in the background\nspin_animation &\nspin_pid=$!  # Capture the process ID of the spinning animation\n\n# Generate the commit message using `git diff` piped into `llm` command\n# The LLM command takes a system prompt from a file as input\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  # Stop the spinning animation by killing its process\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n  # Finalizing output\n  tput cnorm  # Show the cursor again\n  printf \"\\\\n\"  # Move the cursor to the next line\n\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\n# Stop the spinning animation by killing its process\nkill $spin_pid\nwait $spin_pid 2>/dev/null  # Wait for the process to terminate and suppress error messages\n\n# Finalizing output\ntput cnorm  # Show the cursor again\necho  # Move the cursor to the next line\n\n# Display the generated commit message with color-coded headings\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\n# Write the generated commit message to the specified file (usually the commit message file in .git)\necho \"$commit_msg\" > \"$1\"\n\n\n```\n\nYou can see [mine in my dotfiles](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg).\n\n### 7. Make the `prepare-commit-msg` file executable\n\nRun the following command in your terminal:\n\n```bash\nchmod +x ~/.git_hooks/prepare-commit-msg\n```\n\n### 8. Configure Git to use your global hooks directory\n\nRun the following command to set your global hooks directory\n\n```bash\ngit config --global core.hooksPath ~/.git_hooks\n```\n\n### 9. Code, build things and then commit something\n\n## Explanation on how it works\n\nThis command sets the `core.hooksPath` configuration option to your global hooks directory (`~/.git_hooks`).\n\nNow, whenever you run `git commit` in any of your repositories, Git will execute the global `prepare-commit-msg` hook located in `~/.git_hooks/prepare-commit-msg`. The hook will generate the commit message based on the staged changes using the `llm` command and the system prompt from `~/.config/prompts/commit-system-prompt.txt`.\n\nBy setting up a global `prepare-commit-msg` hook, you can have the commit message generation functionality available in all your repositories without the need to set it up individually for each repository.\n\nRemember to have the `llm` command and the `~/.config/prompts/commit-system-prompt.txt` file set up correctly for the global hook to work as expected.\n\nWith this global hook in place, you can simply stage your changes normally using `git add` or `git add -p`, and then run `git commit`.\n\nThe global `prepare-commit-msg` hook will automatically generate the commit message for you, ready for review and editing before finalizing the commit.\n\nIf you want to skip the LLM commit message generation, just commit with a message: `git commit -m â€œfixed issue #420â€`. This seems to bypass the pre commit hook.\n\n## This is just a hack. AI will hallucinate.\n\nI had fun building this, and it is hilarious.\n\nI have had it hallucinate hilarious things. Never making up changes (thus far), but doing weird shit like adding â€œFixed issue #54â€ at the end.\n\nLike everything in life, YMMV.\n\nIf this is helpful, send me an email and let me know! My email is [harper@modest.com](mailto:harper@modest.com).\n\n# CURRENT TRANSLATION\n_TL;DR: `prepare-commit-msg` Git ãƒ•ãƒƒã‚¯ã« `llm` CLI ã‚’ä»•è¾¼ã‚ã°ã€ç›´è¿‘ã®å¤‰æ›´ã‚’ã–ã£ãã‚Šã¾ã¨ã‚ãŸã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•ã§ç”Ÿæˆã§ãã‚‹ï¼ˆTL;DR ã§ã¯ pre-commit-msg ã£ã¦æ›¸ã„ã¡ã‚ƒã£ãŸã‘ã©ã€ã“ã®è¨˜äº‹ã§ã¯ prepare-commit-msg ã‚’ä½¿ã†ãï¼‰ã€‚_\n\nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒãƒƒã‚¯ã™ã‚‹ã®ã¯å¤§å¥½ãã ã‘ã©ã€ã¾ã¨ã‚‚ãªã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ›¸ãã®ã¯è¶…è‹¦æ‰‹ã€‚ã»ã‚“ã¨æ€ ã‘è€…ãªã‚“ã ã‚ˆã­ã€‚\n\nãŸã¨ãˆã°ã“ã‚Œ:  \n{{< image src=\"/images/posts/commits.png\" caption=\"My terrible commit messages\" >}}\n\nã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚´ãƒŸåŒç„¶ã€‚ã‚¯ã‚½æ€ ã‘è€…ã§ã™ã‚ã€‚\n\n## Never fear, LLMs are here.\n\nç›¸æ£’ã® [Kanno](https://twitter.com/ryankanno?lang=en) ãŒã€`git diff` ã‹ã‚‰ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã‚·ãƒ³ãƒ—ãƒ«ãª Git ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’é€ã£ã¦ãã‚ŒãŸã€‚ã‹ãªã‚Šã—ã£ã‹ã‚Šå‹•ããƒ¤ãƒ„ã€‚\n\n```bash\n# generate comment\ngpt = \"!f() { git diff $1 | sgpt 'Write concise, informative commit messages: Start with a summary in imperative mood, explain the 'why' behind changes, keep the summary under 50 characters, use bullet points for multiple changes, and reference related issues or tickets. What you write will be passed to git commit -m \\\"[message]\\\"'; }; f\"\n```\n\nã§ã‚‚ã‚ªãƒ¬ã¯ shell-gpt ã˜ã‚ƒãªãã¦ Simon ã® `llm` CLI ã‚’ä½¿ã„ãŸã‹ã£ãŸã€‚`llm` ã¯å¯¾å¿œãƒ¢ãƒ‡ãƒ«ãŒæ®µé•ã„ã«å¤šã„ã—ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«ã‚„ MLX ã‚‚ä½¿ãˆã‚‹ã€‚\n\nãã‚Œã¨ `.gitconfig` ã‚’ã„ã¡ã„ã¡ã‚¯ã‚½å¼„ã‚Šå›ã™ã®ã¯é¢å€’ãã•éãã‚‹ã‹ã‚‰ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã«ã—ã¦ãŠããŸã„ã€‚\n\nã¨ã„ã†ã‚ã‘ã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ `~/.config/prompts/git-commit-message.txt` ã«çªã£è¾¼ã‚“ã ã€‚ä¸­èº«ã¯ã“ã‚“ãªæ„Ÿã˜:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nãã‚Œã‚’è¸ã¾ãˆã¦ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ã“ã†æ›´æ–°:\n\n```bash\ngpt = \"!f() { git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\" }; f\"\n```\n\nã“ã‚Œã§ã‚„ã‚ŠãŸã„ã“ã¨ã¯ã»ã¼å‡ºæ¥ãŸã€‚ã§ã‚‚ã‚ªãƒ¬ã¯æ€ ã‘è€…ã ã—ã€ã¾ã å ´å½“ãŸã‚Šãƒãƒƒã‚¯æ„ŸãŒå¼·ã™ãã‚‹ã€‚\n\nãã“ã§ [Claude](https://claude.ai) ã«é ¼ã‚“ã§ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«ã—ã¦ã€Œãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ°—ã«é£Ÿã‚ãªãã‚ƒ abortã€ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã‚‚ã‚‰ã£ãŸã€‚\n\n```bash\nllm = \"!f() { \\\n    if git diff --quiet $1; then \\\n        echo \\\"No changes to commit. Aborting.\\\"; \\\n    else \\\n        commit_msg=$(git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    fi; \\\n}; f\"\n```\n\nã‚ã¨ä¸€æ­©ã£ã¦æ„Ÿã˜ã ã£ãŸã‘ã©ã€ã•ã‚‰ã«è©°ã‚ã¦ã“ã†ãªã£ãŸ:\n\n```bash\nllm-staged = \"!f() { \\\n    git add -p; \\\n    if ! git diff --cached --quiet; then \\\n        commit_msg=$(git diff --cached | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            git reset HEAD .; \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    else \\\n        echo \\\"No changes staged for commit. Aborting.\\\"; \\\n    fi; \\\n}; f\"\n```\n\næº€è¶³ã¯ã—ãŸã‘ã©ã€ã¾ã ã”ã¡ã‚ƒã£ã¨ã—éãã¦ã‚‹ã€‚\n\n## Git Hook ã« Get HookedğŸ”¥\n\nãã“ã§ã€Œãã†ã ã€Git ãƒ•ãƒƒã‚¯ãŒã‚ã£ãŸã˜ã‚ƒã‚“ï½—ã€ã¨ã²ã‚‰ã‚ã„ãŸã€‚\n\nClaude ã«ã‚‚ã†ä¸€å›ãŠé¡˜ã„ã—ã¦ã€`prepare-commit-msg` ã‚¤ãƒ™ãƒ³ãƒˆã§èµ°ã‚‹ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ•ãƒƒã‚¯ã‚’æ›¸ã„ã¦ã‚‚ã‚‰ã£ãŸã€‚\n\nè‡ªåˆ†ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã™ã‚Œã°ãƒ•ãƒƒã‚¯ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹ã€‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’çœã‘ã° LLM ãŒå‘¼ã°ã‚Œã‚‹ã€‚æœ€é«˜ã™ãã€‚\n\nãƒ•ãƒƒã‚¯ã¯ã“ã‚“ãªæ„Ÿã˜:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[0;33m'\nBLUE='\\033[0;34m'\nNC='\\033[0m'\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis\n      tput el1\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"\n      sleep 0.1\n      tput cub 32\n    done\n  done\n}\n\n# Skip on merge commits\nif [ -n \"$2\" ]; then\n  exit 0\nfi\n\n# Check if `llm` exists\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start spinner\nspin_animation &\nspin_pid=$!\n\n# Generate commit message\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null\n  tput cnorm\n  printf \"\\\\n\"\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\nkill $spin_pid\nwait $spin_pid 2>/dev/null\ntput cnorm\necho\n\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\necho \"$commit_msg\" > \"$1\"\n```\n\n(ChatGPT ãŒã‚³ãƒ¡ãƒ³ãƒˆã‚’ç››ã‚Šã¾ãã£ã¦ãã‚ŒãŸ)\n\nã¡ã‚ƒã‚“ã¨å‹•ãã—ã€ã‚¹ãƒ”ãƒŠãƒ¼ã‚‚ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚ã‚ã£ã¦è¦‹ãŸç›®ã‚‚ã‚¯ãƒ¼ãƒ«ï¼\n\n![](/images/posts/llm-commit-hook.gif)\n\nã“ã‚Œã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç„¡ã—ã§ `git commit` ã™ã‚‹ã¨ãƒ•ãƒƒã‚¯ãŒç™ºç«ã—ã€ã‚¹ãƒ†ãƒ¼ã‚¸æ¸ˆã¿ã®å¤‰æ›´ã‚’ `llm` CLI ã«é€ã‚Šã€å…ˆã®ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã€‚å‡ºåŠ›ã‚‚ã„ã„æ„Ÿã˜:\n\n```text\nğŸ¤–ğŸ’¬ AI-powered git commit messages FTW! ğŸš€ğŸ‰\n- Updated content/post/2024-03-11-ai-git-commit-messages.md\n- Added links to my actual git hook and prompt in dotfiles repo ğŸ”—\n- Removed unnecessary code block formatting for the output example ğŸ—‘ï¸\n- AI is making us lazy devs, but who cares when commit messages are this awesome! ğŸ˜‚ğŸ‘Œ\n```\n\nã‚„ã£ãŸãƒ¼ï¼ã€€ã‚ªãƒ¬ã® [ãƒ•ãƒƒã‚¯](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg) ã¨ [ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ](https://github.com/harperreed/dotfiles/blob/master/.config/prompts/commit-system-prompt.txt) ã¯ dotfiles ã«ç½®ã„ã¦ã‚ã‚‹ã‹ã‚‰ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¦ã­ã€‚`SKIP_LLM_GITHOOK` ç’°å¢ƒå¤‰æ•°ã‚’ã‚»ãƒƒãƒˆã™ã‚Œã°ã“ã®ä»•çµ„ã¿ã¯ç„¡åŠ¹åŒ–ã§ãã‚‹ã€‚\n\n## How to set this up!\n\n### 1. Install `llm`.\n\n[llm.datasette.io](https://llm.datasette.io/en/stable/) ã‚’å‚ç…§ã€‚ã‚ªãƒ¬ã¯ `pipx` ã§å…¥ã‚ŒãŸ:\n\n```bash\npipx install llm\n```\n\nOpenAI ã‚­ãƒ¼ã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¢ãƒ‡ãƒ«ã‚’è¨­å®š:\n\n```bash\nllm keys set openai\nllm models default gpt-4-turbo\n```\n\n(`llm` CLI ã¯ãƒã‚¸å„ªç§€ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«å«ã‚ã„ã‚ã‚“ãªãƒ¢ãƒ‡ãƒ«ãŒä½¿ãˆã‚‹ã—ã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚‚æŸ”è»Ÿã«ã„ã˜ã‚Œã‚‹ã€‚æ˜ã‚Šç”²æ–ã‚ã‚‹ã‚ˆ)\n\n### 2. Create a new directory for your prompts:\n\n```bash\nmkdir -p ~/.config/prompts\n```\n\n### 3. Add your system prompt:\n\nãƒ•ãƒƒã‚¯ã¯ `~/.config/prompts/commit-system-prompt.txt` ã‚’èª­ã‚€ã€‚ä»¥ä¸‹ã‚’ä¿å­˜:\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nã“ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯ã¨ã‚Šã‚ãˆãš v0ã€‚ã‚‚ã£ã¨è‰¯ã„ã‚¢ã‚¤ãƒ‡ã‚¢ãŒã‚ã‚Œã°æ•™ãˆã¦ãã‚Œã€‚\n\n### 4. Create a new directory for your global Git hooks.\n\n```bash\nmkdir -p ~/.git_hooks\n```\n\n### 5. Touch the `prepare-commit-msg`\n\n`~/.git_hooks` ã«æ‹¡å¼µå­ãªã—ã§ `prepare-commit-msg` ã‚’ä½œæˆã€‚\n\n### 6. Open the `prepare-commit-msg` file in a text editor (vi or death) and add the same content as before:\n\nä¸Šã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ãã®ã¾ã¾è²¼ã‚Šä»˜ã‘ã¦ä¿å­˜ã€‚\n\n### 7. Make the `prepare-commit-msg` file executable\n\n```bash\nchmod +x ~/.git_hooks/prepare-commit-msg\n```\n\n### 8. Configure Git to use your global hooks directory\n\n```bash\ngit config --global core.hooksPath ~/.git_hooks\n```\n\n### 9. Code, build things and then commit something\n\n## Explanation on how it works\n\n`core.hooksPath` ã‚’ `~/.git_hooks` ã«è¨­å®šã—ãŸã“ã¨ã§ã€ã©ã®ãƒªãƒã§ã‚‚ `git commit` ã™ã‚‹ã¨ã‚°ãƒ­ãƒ¼ãƒãƒ« `prepare-commit-msg` ãŒèµ°ã‚‹ã€‚ãƒ•ãƒƒã‚¯ã¯ã‚¹ãƒ†ãƒ¼ã‚¸æ¸ˆã¿ã®å¤‰æ›´ã‚’ `llm` ã¨ `~/.config/prompts/commit-system-prompt.txt` ã«æ¸¡ã—ã€ç”Ÿæˆã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã‚€ã€‚\n\nLLM ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ãŸã„ï¼Ÿã€€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä»˜ãã§ã‚³ãƒŸãƒƒãƒˆã™ã‚Œã° OK:\n\n```bash\ngit commit -m \"fixed issue #420\"\n```\n\nã“ã‚Œã§ pre-commit ãƒ•ãƒƒã‚¯ã‚‚ã™ã£é£›ã°ã•ã‚Œã‚‹ã£ã½ã„ ğŸ¤”\n\n## This is just a hack. AI will hallucinate.\n\nä½œã£ã¦ã¦ã‚ã¡ã‚ƒãã¡ã‚ƒæ¥½ã—ã‹ã£ãŸã—ç¬‘ãˆã‚‹ã€‚ã§ã‚‚ãŸã¾ã«ã€ŒFixed issue #54ã€ã¿ãŸã„ãªè¬ã‚’ã­ã˜è¾¼ã‚“ã§ãã‚‹ã€‚ã„ã¾ã®ã¨ã“ã‚å®Ÿéš›ã®å¤‰æ›´ã‚’æé€ ã—ãŸã“ã¨ã¯ãªã„ã‘ã©ã€YMMVï¼ˆYour Mileage May Varyâ€•çµæœã¯äººãã‚Œãã‚Œï¼‰ã ã€‚\n\nã‚‚ã—å½¹ã«ç«‹ã£ãŸã‚‰ãƒ¡ãƒ¼ãƒ«ãã‚Œï¼ [harper@modest.com](mailto:harper@modest.com)\n\n# CRITIQUE FEEDBACK\nã€é‡å¤§åº¦ï¼šé«˜ã€€â”€ã€€æ„å‘³ã®èª¤è¨³ãƒ»æƒ…å ±ã®è¿½åŠ ï¼æ¬ è½ã€‘\n\n1. TL;DR ã®å†…å®¹æ”¹å¤‰  \n   åŸæ–‡: â€œYou can set a pre-commit-msg git hook â€¦â€  \n   ç¿»è¨³: â€œprepare-commit-msg ã‚’ä½¿ã†ãâ€ ã¨æ–­å®šã—ã€ã•ã‚‰ã« â€œTL;DR ã§ã¯ pre-commit-msg ã£ã¦æ›¸ã„ã¡ã‚ƒã£ãŸã‘ã©â€¦â€ ã¨ç‹¬è‡ªã®æ³¨é‡ˆã‚’æŒ¿å…¥ã€‚  \n   å•é¡Œ: åŸæ–‡ã«ã¯ã€Œæ›¸ãé–“é•ã„ã‚’è‡ªè¦šã—ã¦ã„ã‚‹ã€ã¨ã„ã†ãƒ¡ã‚¿æƒ…å ±ã¯ãªã„ã€‚èª­è€…ã«ã€ŒåŸä½œè€…ãŒãƒŸã‚¹ã—ãŸã€ã‚ˆã†ãªå°è±¡ã‚’ä¸ãˆã€äº‹å®Ÿã‚’ã­ã˜æ›²ã’ã¦ã„ã‚‹ã€‚  \n   ä¿®æ­£æ¡ˆ: åŸæ–‡ã©ãŠã‚Š pre-commit-msg ã‚’æ¡ç”¨ã—ã€æ³¨é‡ˆã‚’å…¥ã‚Œãªã„ã€‚ã‚‚ã—å¾Œæ®µã§ prepare-commit-msg ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹ä¸ä¸€è‡´ã‚’èª¬æ˜ã—ãŸã„å ´åˆã§ã‚‚ã€Œè¨³æ³¨ã€ã¨æ˜ç¤ºã—è§’æ‹¬å¼§ã§è£œã†ã€‚\n\n2. pre-commit ã¨ prepare-commit ã®æ··åœ¨  \n   å¾ŒåŠã§ã‚‚ â€œpre-commit ãƒ•ãƒƒã‚¯ã‚‚ã™ã£é£›ã°ã•ã‚Œã‚‹ã£ã½ã„ ğŸ¤”â€ ã¨æ›¸ãã€ä¾ç„¶ã¨ã—ã¦ãƒ•ãƒƒã‚¯åãŒæºã‚Œã¦ã„ã‚‹ã€‚  \n   ä¿®æ­£æ¡ˆ: å…¨æ–‡ã§ â€œprepare-commit-msg ãƒ•ãƒƒã‚¯â€ ã«çµ±ä¸€ï¼ˆã‚‚ã—ãã¯åŸæ–‡ã«å¿ å®Ÿã« pre-commit-msg ã§çµ±ä¸€ï¼‰ã€è„±å­—ã€Œ-msgã€ã‚’è£œå®Œã€‚\n\n3. â€œvi or deathâ€ ã®æœªè¨³ãƒ»èª­ç‚¹æ¬ è½  \n   åŸæ–‡ã¯é»’ã„ãƒ¦ãƒ¼ãƒ¢ã‚¢ (â€œuse vi or die tryingâ€) ãŒè¾¼ã‚ã‚‰ã‚Œã¦ã„ã‚‹ãŒã€ã€Œvi or deathã€ã¨ãã®ã¾ã¾æ®‹ã—æ„å‘³ãŒæ›–æ˜§ã€‚  \n   ä¿®æ­£æ¡ˆ: ã€Œ(vi ã‚’ä½¿ã†ã‹æ­»ã‹ã ãœ)ã€ãªã©æ„å›³ã‚’ç¤ºã™ã‹ã€èª­è€…ãŒç†è§£ã§ãã‚‹è¨€ã„æ›ãˆã‚’æ³¨é‡ˆä»˜ãã§æç¤ºã€‚\n\n4. â€œChatGPT added the documentationâ€  \n   åŸæ–‡ã§ã¯å˜ã« 1 è¡Œã ãŒã€è¨³æ–‡ã¯ â€œChatGPT ãŒã‚³ãƒ¡ãƒ³ãƒˆã‚’ç››ã‚Šã¾ãã£ã¦ãã‚ŒãŸâ€ ã¨èª‡å¼µè¡¨ç¾ã‚’è¿½åŠ ã€‚  \n   ä¿®æ­£æ¡ˆ: ã€Œ(ChatGPT ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ãŸ)ã€ç¨‹åº¦ã«æŠ‘ãˆã€ä¸è¦ãªè„šè‰²ã‚’é¿ã‘ã‚‹ã€‚\n\nã€é‡å¤§åº¦ï¼šä¸­ã€€â”€ã€€ãƒˆãƒ¼ãƒ³ãƒ»ãƒ¬ã‚¸ã‚¹ã‚¿ã®ä¸æ•´åˆã€‘\n\n5. ä¸€äººç§°ãƒ»èªèª¿ã®ä¹±ã‚Œ  \n   ãƒ»â€œã‚ªãƒ¬â€â€œã‚¯ã‚½æ€ ã‘è€…ã§ã™ã‚â€â€œã‚„ã£ãŸãƒ¼â€ ç­‰ã€ç”·æ€§å£èªãƒ»å¥³è¨€è‘‰ãƒ»ç •ã‘ãŸè‹¥è€…è¨€è‘‰ãŒæ··åœ¨ã€‚  \n   ãƒ»â€œã§ã™ï¼ã¾ã™â€ä½“ã¨å¸¸ä½“ãŒæ®µè½ã”ã¨ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹ã€‚  \n   ä¿®æ­£æ¡ˆ: åŸæ–‡ã¯ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ã§ä¸€è²«ã—ã¦ã„ã‚‹ãŸã‚ã€æ—¥æœ¬èªã‚‚å¸¸ä½“ï¼‹ã‚„ã‚„ç •ã‘ãŸèªèª¿ã§çµ±ä¸€ (â€œä¿ºã¯ã€œâ€â€œã‚¯ã‚½æ€ ã‘è€…ã â€)ã€ã‚ã‚‹ã„ã¯ä¸å¯§ä½“ã«çµ±ä¸€ã€‚\n\n6. ç½µå€’èªã®å¼·åº¦ä¸Šã’éã  \n   â€œTrash commit messagesâ€ â†’ â€œã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚´ãƒŸåŒç„¶â€ ç¨‹åº¦ã§ååˆ†ã ãŒã€ã€Œã‚¯ã‚½æ€ ã‘è€…ã€ã€Œã‚¯ã‚½å¼„ã‚Šå›ã™ã€ãªã©åŸæ–‡ä»¥ä¸Šã«ä¸‹å“ã€‚  \n   ä¿®æ­£æ¡ˆ: åŸæ–‡ã¨åŒç¨‹åº¦ã®è»½ã„ç½µå€’ã«æŠ‘ãˆã‚‹ (â€œã‚ã¡ã‚ƒãã¡ã‚ƒæ€ ã‘è€…â€).\n\n7. ä¸è‡ªç„¶ãªå’Œè£½è‹±èªæ··åˆã‚¿ã‚¤ãƒˆãƒ«  \n   â€œGit Hook ã« Get HookedğŸ”¥â€ ã¯ãƒ€ã‚¸ãƒ£ãƒ¬ã‚’å¼·å¼•ã«æ—¥æœ¬èªã¸æŒã¡è¾¼ã‚“ã§ãŠã‚Šèª­ã¿ã¥ã‚‰ã„ã€‚  \n   ä¿®æ­£æ¡ˆ: ã€ŒGit Hook ã«ãƒãƒã‚‹ã€ã€ŒGit Hook ã§è§£æ±ºï¼ã€ãªã©ã‚·ãƒ³ãƒ—ãƒ«ã«ã€‚\n\nã€é‡å¤§åº¦ï¼šä¸­ã€€â”€ã€€æŠ€è¡“ç”¨èªãƒ»è¡¨è¨˜ã€‘\n\n8. ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã®è¨³æ³¨ãªã—  \n   è¨˜äº‹å†…ã§ `git-commit-message.txt` ã¨ `commit-system-prompt.txt` ãŒæ··åœ¨ã™ã‚‹ãŒã€è¨³æ–‡ã¯åŸæ–‡ã®æ··åœ¨ã‚’ãã®ã¾ã¾è¸è¥²ã—èª¬æ˜ã‚’è£œã£ã¦ã„ãªã„ã€‚  \n   ä¿®æ­£æ¡ˆ: â€œâ€»ã“ã®è¨˜äº‹ã§ã¯é€”ä¸­ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«åãŒå¤‰ã‚ã‚‹ãŒâ€¦ â€ã¨è¨³æ³¨ã§è£œè¶³ã™ã‚‹ã‹ã€è„šæ³¨ã§æ•´ç†ã€‚\n\n9. ã‚³ãƒãƒ³ãƒ‰åã®å…¨è§’å¼•ç”¨ç¬¦  \n   â€œgit commit -m â€œfixed issue #420â€â€ ã®äºŒé‡å¼•ç”¨ç¬¦ãŒå…¨è§’ã«ãªã£ã¦ã„ã‚‹ã€‚ã‚·ã‚§ãƒ«ã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦èª¤å‹•ä½œã™ã‚‹ã€‚  \n   ä¿®æ­£æ¡ˆ: åŠè§’ã® \"\" ã‚’ä½¿ç”¨ã€‚\n\nã€é‡å¤§åº¦ï¼šå°ã€€â”€ã€€æ–‡æ³•ãƒ»è¨€ã„å›ã—ã€‘\n\n10. ã€Œã»ã‚“ã¨æ€ ã‘è€…ãªã‚“ã ã‚ˆã­ã€‚ã€  \n    â€œãªã‚“ã ã‚ˆã­â€ ã®èªå°¾ã¯å£èªãŒå¼·ã™ãã€ç¶šãæ–‡ã§ â€œã§ã™ã‚â€ ã¨å™›ã¿åˆã‚ãªã„ã€‚èªèª¿çµ±ä¸€ã‚’ã€‚  \n\n11. ã€Œvi or death ã‚’å‚ç…§ã€  \n    ç›´è¨³æ„ŸãŒå¼·ã„ã€‚å‰è¿°ã®ã¨ãŠã‚Šæ„è¨³ï¼‹è£œè¶³ã‚’å…¥ã‚Œã‚‹ã€‚\n\n12. ã€Œæ˜ã‚Šç”²æ–ã‚ã‚‹ã‚ˆã€  \n    æ„å‘³ã¯ä¼ã‚ã‚‹ãŒã€Œã„ã˜ã‚‹ä¾¡å€¤ãŒã‚ã‚‹ã‚ˆã€ã€Œè©¦ã™ä¾¡å€¤ãŒã‚ã‚‹ã‚ˆã€ã®ã»ã†ãŒè‡ªç„¶ã€‚\n\n13. emoji ã®å¤šç”¨  \n    åŸæ–‡ã‚‚å¤šå°‘ emoji ã‚’ç”¨ã„ã¦ã„ã‚‹ãŒã€è¨³æ–‡ã§è¿½åŠ ã—ãŸ ğŸ¤”ğŸ”¥ ã¯ä¸è¦ã€‚åŸæ–‡ã®çµµæ–‡å­—ã ã‘ã‚’ç¶­æŒã€‚\n\nã€é‡å¤§åº¦ï¼šå°ã€€â”€ã€€æ©Ÿæ¢°ç¿»è¨³è‡­ãƒ»ãã“ã¡ãªã•ã€‘\n\n14. â€œå ´å½“ãŸã‚Šãƒãƒƒã‚¯æ„ŸãŒå¼·ã™ãã‚‹â€  \n    â€œå ´å½“ãŸã‚Šçš„ã™ãã‚‹â€ ã®ã»ã†ãŒè‡ªç„¶ã€‚\n\n15. ã€Œæœ€é«˜ã™ãã€  \n    å£èªã¨ã—ã¦æˆç«‹ã™ã‚‹ãŒ â€œãƒã‚¸æœ€é«˜â€ ã‚„ â€œæœ€é«˜ã â€ ã®æ–¹ãŒæ»‘ã‚‰ã‹ã€‚\n\nã€ã¾ã¨ã‚ã€‘\n\nãƒ»TL;DR ã®å‹æ‰‹ãªè£œè¶³ã€ãƒ•ãƒƒã‚¯åã®æ··ä¹±ã€éåº¦ã®è„šè‰²ï¼ˆemoji/ã‚¹ãƒ©ãƒ³ã‚°/ç½µå€’èªï¼‰ã¯æœ€å„ªå…ˆã§ä¿®æ­£ã€‚  \nãƒ»èªèª¿ã‚’å¸¸ä½“ã«çµ±ä¸€ã—ã€ç½µå€’èªã®å¼·åº¦ã‚’åŸæ–‡ç›¸å½“ã«ä¸‹ã’ã‚‹ã€‚  \nãƒ»åŸæ–‡ã§å®Ÿéš›ã«å­˜åœ¨ã—ãªã„æƒ…å ±ã‚„è©•ä¾¡ã‚’è¿½åŠ ã—ãªã„ã€‚  \nãƒ»æŠ€è¡“æƒ…å ±ï¼ˆãƒ‘ã‚¹åãƒ»ã‚³ãƒãƒ³ãƒ‰ï¼‰ã®æºã‚Œã‚„å…¨è§’è¨˜å·ã‚’æ­£ã™ã€‚  \n\nä»¥ä¸Šã‚’ç›´ã›ã°ã€åŸæ–‡ã®ãƒãƒªã‚’ä¿ã¡ã¤ã¤ã‚‚èª­ã¿ã‚„ã™ãã€æ­£ç¢ºãªæ—¥æœ¬èªè¨³ã«ãªã‚‹ã€‚\n\nPlease address ALL issues identified in the critique and provide an improved translation.\nReturn ONLY the improved translated text without explanations or comments.",
      "response": "_TL;DR: pre-commit-msg Git ãƒ•ãƒƒã‚¯ã« `llm` CLI ã‚’çµ„ã¿è¾¼ã‚ã°ã€æœ€è¿‘ã®ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã‚’è¦ç´„ã—ãŸã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè‡ªå‹•ã§ç”Ÿæˆã•ã‚Œã‚‹ã€‚_\n\nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã„ã˜ã‚‹ã®ã¯å¤§å¥½ããªã®ã«ã€æ„å‘³ã®ã‚ã‚‹ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ›¸ãã®ã¯ã‚ã¡ã‚ƒãã¡ã‚ƒè‹¦æ‰‹ã€‚è‡ªåˆ†ã§ã‚‚é©šãã»ã©æ€ ã‘è€…ã ã€‚\n\nãŸã¨ãˆã°ã“ã‚Œ:  \n{{< image src=\"/images/posts/commits.png\" caption=\"My terrible commit messages\" >}}\n\nã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå®Œå…¨ã«ãƒ€ãƒ¡ã€‚\n\n## Never fear, LLMs are here.\n\nå‹äººã® [Kanno](https://twitter.com/ryankanno?lang=en) ãŒã€`git diff` ã‹ã‚‰ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã‚·ãƒ³ãƒ—ãƒ«ãª Git ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’é€ã£ã¦ãã‚ŒãŸã€‚ã‹ãªã‚Šã—ã£ã‹ã‚Šå‹•ãã€‚\n\n```bash\n# generate comment\ngpt = \"!f() { git diff $1 | sgpt 'Write concise, informative commit messages: Start with a summary in imperative mood, explain the \\'why\\' behind changes, keep the summary under 50 characters, use bullet points for multiple changes, and reference related issues or tickets. What you write will be passed to git commit -m \\\"[message]\\\"'; }; f\"\n```\n\nã‘ã‚Œã©è‡ªåˆ†ã¯ shell-gpt ã§ã¯ãªãã€Simon ã® [LLM CLI](https://llm.datasette.io/en/stable/) ã‚’ä½¿ã„ãŸã‹ã£ãŸã€‚LLM ã¯å¯¾å¿œãƒ¢ãƒ‡ãƒ«ãŒè±Šå¯Œã§ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«ã‚„ MLX ã‚‚åˆ©ç”¨ã§ãã‚‹ã€‚\n\nã•ã‚‰ã« `.gitconfig` ã‚’ä½•åº¦ã‚‚ã„ã˜ã‚‹ã®ã¯é¢å€’ãªã®ã§ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ†ã‘ãŸã„ã€‚\n\nãã“ã§ `~/.config/prompts/git-commit-message.txt` ã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä¿å­˜ã—ãŸã€‚å†…å®¹ã¯ã“ã†ã :\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’æ¬¡ã®ã‚ˆã†ã«æ›´æ–°ã—ãŸ:\n\n```bash\ngpt = \"!f() { git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\" }; f\"\n```\n\nã“ã‚Œã§ã‚„ã‚ŠãŸã„ã“ã¨ã¯ã»ã¨ã‚“ã©å®Ÿç¾ã—ãŸãŒã€ã¾ã æ‰‹é–“ãŒæ®‹ã‚‹ã€‚\n\nãã“ã§ [Claude](https://claude.ai) ã«é ¼ã‚“ã§ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ°—ã«å…¥ã‚‰ãªã‘ã‚Œã°ã‚³ãƒŸãƒƒãƒˆã‚’ä¸­æ–­ã§ãã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆã‚’ä½œã£ã¦ã‚‚ã‚‰ã£ãŸã€‚\n\n```bash\nllm = \"!f() { \\\n    if git diff --quiet $1; then \\\n        echo \\\"No changes to commit. Aborting.\\\"; \\\n    else \\\n        commit_msg=$(git diff $1 | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    fi; \\\n}; f\"\n```\n\nã‚ã¨ä¸€æ­©ã¨ã„ã†ã¨ã“ã‚ã ã£ãŸã®ã§ã€ã•ã‚‰ã«è©°ã‚ã¦ã“ã†ãªã£ãŸ:\n\n```bash\nllm-staged = \"!f() { \\\n    git add -p; \\\n    if ! git diff --cached --quiet; then \\\n        commit_msg=$(git diff --cached | llm -s \\\"$(cat ~/.config/prompts/commit-system-prompt.txt)\\\"); \\\n        echo \\\"Commit message:\\n$commit_msg\\\"; \\\n        read -p \\\"Do you want to commit with this message? [y/N] \\\" confirm; \\\n        if [[ $confirm =~ ^[Yy]$ ]]; then \\\n            git commit -m \\\"$commit_msg\\\"; \\\n        else \\\n            git reset HEAD .; \\\n            echo \\\"Commit aborted.\\\"; \\\n        fi; \\\n    else \\\n        echo \\\"No changes staged for commit. Aborting.\\\"; \\\n    fi; \\\n}; f\"\n```\n\næº€è¶³ã§ããŸã‘ã‚Œã©ã€ã¾ã ã‚´ãƒãƒ£ã‚´ãƒãƒ£ã—ã¦ã„ã‚‹ã€‚\n\n## Git Hooked\n\nãã“ã§æ€ã„å‡ºã—ãŸã®ãŒ Git ãƒ•ãƒƒã‚¯ã ã€‚\n\nClaude ã«å†åº¦é ¼ã‚“ã§ã€`prepare-commit-msg` ã‚¤ãƒ™ãƒ³ãƒˆã§å‹•ãã‚·ãƒ³ãƒ—ãƒ«ãªãƒ•ãƒƒã‚¯ã‚’æ›¸ã„ã¦ã‚‚ã‚‰ã£ãŸã€‚\n\nãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªåˆ†ã§å…¥åŠ›ã™ã‚Œã°ãƒ•ãƒƒã‚¯ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹ã—ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’çœã‘ã° LLM ãŒå‘¼ã°ã‚Œã‚‹ã€‚\n\nãƒ•ãƒƒã‚¯ã®å†…å®¹ã¯ä»¥ä¸‹ã®ã¨ãŠã‚Š:\n\n```bash\n#!/bin/sh\n\n# Exit if the `SKIP_LLM_GITHOOK` environment variable is set\nif [ ! -z \"$SKIP_LLM_GITHOOK\" ]; then\n  exit 0\nfi\n\n# ANSI color codes for styling the output\nRED='\\033[0;31m'    # Sets text to red\nGREEN='\\033[0;32m'  # Sets text to green\nYELLOW='\\033[0;33m' # Sets text to yellow\nBLUE='\\033[0;34m'   # Sets text to blue\nNC='\\033[0m'        # Resets the text color to default, no color\n\n\n# Function to display a spinning animation during the LLM processing\nspin_animation() {\n  spinner=(\"â ‹\" \"â ™\" \"â ¹\" \"â ¸\" \"â ¼\" \"â ´\" \"â ¦\" \"â §\" \"â ‡\" \"â \")\n  while true; do\n    for i in \"${spinner[@]}\"; do\n      tput civis\n      tput el1\n      printf \"\\\\r${YELLOW}%s${NC} Generating LLM commit message...\" \"$i\"\n      sleep 0.1\n      tput cub 32\n    done\n  done\n}\n\n# Skip on merge commits\nif [ -n \"$2\" ]; then\n  exit 0\nfi\n\n# Check if the `llm` command is installed\nif ! command -v llm &> /dev/null; then\n  echo \"${RED}Error: 'llm' command is not installed. Please install it and try again.${NC}\"\n  exit 1\nfi\n\n# Start the spinner\nspin_animation &\nspin_pid=$!\n\n# Generate the commit message\nif ! commit_msg=$(git diff --cached | llm -s \"$(cat ~/.config/prompts/commit-system-prompt.txt)\" 2>&1); then\n  kill $spin_pid\n  wait $spin_pid 2>/dev/null\n  tput cnorm\n  printf \"\\\\n\"\n  printf \"${RED}Error: 'llm' command failed to generate the commit message:\\\\n${commit_msg}${NC}\\\\n\\\\nManually set the commit message\"\n  exit 1\nfi\n\nkill $spin_pid\nwait $spin_pid 2>/dev/null\ntput cnorm\necho\n\necho \"${BLUE}=== Generated Commit Message ===${NC}\"\necho \"${GREEN}$commit_msg${NC}\"\necho \"${BLUE}=================================${NC}\"\necho\n\necho \"$commit_msg\" > \"$1\"\n```\n\n(ChatGPT added the documentation)\n\nã¡ã‚ƒã‚“ã¨å‹•ãã—ã€ã‚¹ãƒ”ãƒŠãƒ¼ã‚‚ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚‚ã‚ã£ã¦è¦‹ãŸç›®ã‚‚ã„ã„ã€‚\n\n![](/images/posts/llm-commit-hook.gif)\n\nã“ã‚Œã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãªã—ã§ `git commit` ã™ã‚‹ã¨ãƒ•ãƒƒã‚¯ãŒç™ºç«ã—ã€ã‚¹ãƒ†ãƒ¼ã‚¸ã—ãŸå¤‰æ›´ã‚’ `llm` CLI ã¨ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«é€ã‚Šã€ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã€‚å‡ºåŠ›ã¯ã“ã‚“ãªæ„Ÿã˜:\n\n```text\nğŸ¤–ğŸ’¬ AI-powered git commit messages FTW! ğŸš€ğŸ‰\n- Updated content/post/2024-03-11-ai-git-commit-messages.md\n- Added links to my actual git hook and prompt in dotfiles repo ğŸ”—\n- Removed unnecessary code block formatting for the output example ğŸ—‘ï¸\n- AI is making us lazy devs, but who cares when commit messages are this awesome! ğŸ˜‚ğŸ‘Œ\n```\n\næœ€é«˜ã ã€‚è‡ªåˆ†ã® [ãƒ•ãƒƒã‚¯](https://github.com/harperreed/dotfiles/blob/master/.git_hooks/prepare-commit-msg) ã¨ [ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ](https://github.com/harperreed/dotfiles/blob/master/.config/prompts/commit-system-prompt.txt) ã¯ dotfiles ã«ç½®ã„ã¦ã‚ã‚‹ã®ã§å‚è€ƒã«ã©ã†ãã€‚`SKIP_LLM_GITHOOK` ç’°å¢ƒå¤‰æ•°ã‚’ã‚»ãƒƒãƒˆã™ã‚Œã°ç„¡åŠ¹åŒ–ã§ãã‚‹ã€‚\n\n## How to set this up!\n\n### 1. Install `llm`.\n\næ‰‹é †ã¯ [llm.datasette.io](https://llm.datasette.io/en/stable/) ã‚’å‚ç…§ã€‚è‡ªåˆ†ã¯ `pipx` ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã€‚\n\n```bash\npipx install llm\n```\n\nOpenAI ã®ã‚­ãƒ¼ã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¢ãƒ‡ãƒ«ã‚’è¨­å®š:\n\n```bash\nllm keys set openai\nllm models default gpt-4-turbo\n```\n\n(LLM CLI ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«ã‚’å«ã‚€å¤šæ•°ã®ãƒ¢ãƒ‡ãƒ«ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ãŠã‚Šã€è©¦ã™ä¾¡å€¤ã‚ã‚Š)\n\n### 2. Create a new directory for your prompts:\n\n```bash\nmkdir -p ~/.config/prompts\n```\n\n### 3. Add your system prompt:\n\nãƒ•ãƒƒã‚¯ã¯ `~/.config/prompts/commit-system-prompt.txt` ã‚’èª­ã¿è¾¼ã‚€ã€‚æ¬¡ã®å†…å®¹ã‚’ä¿å­˜ã—ã‚ˆã†ã€‚\n\n```text\nWrite short commit messages:\n- The first line should be a short summary of the changes\n- Remember to mention the files that were changed, and what was changed\n- Explain the 'why' behind changes\n- Use bullet points for multiple changes\n- Tone: Use a LOT of emojis, be funny, and expressive. Feel free to be profane, but don't be offensive\n- If there are no changes, or the input is blank - then return a blank string\n\nThink carefully before you write your commit message.\n\nThe output format should be:\n\nSummary of changes\n- changes\n- changes\n\nWhat you write will be passed directly to git commit -m \"[message]\"\n```\n\nã“ã‚Œã¯æš«å®šç‰ˆ (v0)ã€‚æ”¹å–„æ¡ˆãŒã‚ã‚Œã°ãœã²æ•™ãˆã¦ã»ã—ã„ã€‚\n\n### 4. Create a new directory for your global Git hooks.\n\n```bash\nmkdir -p ~/.git_hooks\n```\n\n### 5. Touch the `prepare-commit-msg`\n\n`~/.git_hooks` ã«æ‹¡å¼µå­ãªã—ã§ `prepare-commit-msg` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚\n\n### 6. Open the `prepare-commit-msg` file in a text editor (vi or death) and add the same content as before:\n\n(è¨³æ³¨: â€œvi or deathâ€ ã¯ã€Œvi ã‚’ä½¿ã†ã‹æ­»ã¬ã‹ã ãœã€ã¨ã„ã†ã‚¸ãƒ§ãƒ¼ã‚¯)\n\nå…ˆã»ã©ã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ãã®ã¾ã¾è²¼ã‚Šä»˜ã‘ã¦ä¿å­˜ã€‚\n\n### 7. Make the `prepare-commit-msg` file executable\n\n```bash\nchmod +x ~/.git_hooks/prepare-commit-msg\n```\n\n### 8. Configure Git to use your global hooks directory\n\n```bash\ngit config --global core.hooksPath ~/.git_hooks\n```\n\n### 9. Code, build things and then commit something\n\n## Explanation on how it works\n\n`core.hooksPath` ã‚’ `~/.git_hooks` ã«è¨­å®šã—ãŸã“ã¨ã§ã€ã©ã®ãƒªãƒã‚¸ãƒˆãƒªã§ã‚‚ `git commit` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã‚°ãƒ­ãƒ¼ãƒãƒ« `prepare-commit-msg` ãƒ•ãƒƒã‚¯ãŒèµ°ã‚‹ã€‚ãƒ•ãƒƒã‚¯ã¯ã‚¹ãƒ†ãƒ¼ã‚¸ã—ãŸå¤‰æ›´ã‚’ `llm` ã¨ `~/.config/prompts/commit-system-prompt.txt` ã«æ¸¡ã—ã€ç”Ÿæˆã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã‚€ã€‚\n\nLLM ã®ç”Ÿæˆã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ãŸã„å ´åˆã¯ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä»˜ã‘ã¦ã‚³ãƒŸãƒƒãƒˆã™ã‚Œã°ã„ã„:\n\n```bash\ngit commit -m \"fixed issue #420\"\n```\n\n## This is just a hack. AI will hallucinate.\n\nä½œã‚‹ã®ã¯ã¨ã¦ã‚‚æ¥½ã—ã‹ã£ãŸã—ç¬‘ãˆã‚‹ã€‚ã§ã‚‚ã¨ãã©ãã€ŒFixed issue #54ã€ã¿ãŸã„ãªè¬è¡Œã‚’ä»˜ã‘è¶³ã™ã“ã¨ãŒã‚ã‚‹ã€‚ä»Šã®ã¨ã“ã‚å¤‰æ›´å†…å®¹ã‚’æé€ ã—ãŸä¾‹ã¯ãªã„ã‘ã‚Œã©ã€çµæœã¯äººãã‚Œãã‚Œã ã€‚\n\nå½¹ã«ç«‹ã£ãŸã‚‰ãœã²ãƒ¡ãƒ¼ãƒ«ã—ã¦ã»ã—ã„ â†’ [harper@modest.com](mailto:harper@modest.com)",
      "usage": {
        "prompt_tokens": 9062,
        "completion_tokens": 2759,
        "total_tokens": 11821
      },
      "streaming": true
    },
    "frontmatter": {
      "model": "o3",
      "target_language": "japanese",
      "system_prompt": "You are a professional translator. Translate the following frontmatter fields to japanese.\nEach field is in the format \"field_name: content\". Translate ONLY the content, not the field names.\nReturn the translated content in the exact same format, preserving all field names.",
      "user_prompt": "title: Use an llm to automagically generate meaningful git commit messages\n\ndescription: I've transformed my git commit process by using an AI to automatically generate meaningful messages. This setup involves a nifty integration of the llm CLI and git hooks, saving me time. Now I can fuck off while the robots document my commits\n\n",
      "response": "title: LLMã‚’ä½¿ã£ã¦è‡ªå‹•ã§æ„å‘³ã®ã‚ã‚‹Gitã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã™ã‚‹\ndescription: AIã‚’åˆ©ç”¨ã—ã¦æ„å‘³ã®ã‚ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã“ã¨ã§ã€Gitã‚³ãƒŸãƒƒãƒˆã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ä¸€æ–°ã—ã¾ã—ãŸã€‚ã“ã®ä»•çµ„ã¿ã¯llm CLIã¨Gitãƒ•ãƒƒã‚¯ã‚’å·§ã¿ã«çµ±åˆã—ãŸã‚‚ã®ã§ã€æ™‚é–“ã‚’ç¯€ç´„ã§ãã¾ã™ã€‚ã“ã‚Œã§ç§ã¯ã‚µãƒœã£ã¦ã„ã‚‹é–“ã«ãƒ­ãƒœãƒƒãƒˆãŒã‚³ãƒŸãƒƒãƒˆã‚’æ›¸ã„ã¦ãã‚Œã¾ã™",
      "usage": {
        "prompt_tokens": 118,
        "completion_tokens": 102,
        "total_tokens": 220
      },
      "fields": [
        "title",
        "description"
      ],
      "streaming": true
    },
    "all_critiques": [
      "ç·è©•  \nåŸæ–‡ã®æƒ…å ±é‡ã‚„ãƒãƒªã¯æ¦‚ã­ç¶­æŒã§ãã¦ã„ã¾ã™ãŒã€â‘ ç´°ã‹ãªæ„å‘³ã®è„±è½ãƒ»èª¤è§£ã€â‘¡ç •ã‘ãŸè‹±èªç‰¹æœ‰ã®ãƒ¦ãƒ¼ãƒ¢ã‚¢ï¼ç½µã‚Šè¨€è‘‰ã®ãƒˆãƒ¼ãƒ³ã®å¸Œè–„åŒ–ã€â‘¢æ—¥æœ¬èªã¨ã—ã¦ã®ä¸è‡ªç„¶ã•ãƒ»èªèª¿ã‚†ã‚Œã€â‘£æŠ€è¡“ç”¨èªãƒ»ãƒ•ã‚¡ã‚¤ãƒ«åã®è¡¨è¨˜ã‚†ã‚ŒãŒæ•£è¦‹ã•ã‚Œã¾ã™ã€‚ã¨ãã«ãƒ–ãƒ­ã‚°è¨˜äº‹ã‚‰ã—ã„è»½å¦™ãªãƒªã‚ºãƒ ã‚„èªæ°—ãƒ»ä¸‹å“ã•ã‚’ã‚‚ã†å°‘ã—æ‹¾ã‚ãªã„ã¨ã€Œä½œè€…ã®å£°ã€ãŒå¼±ããªã‚Šã¾ã™ã€‚ä»¥ä¸‹ã€é‡å¤§åº¦åˆ¥ã«æŒ‡æ‘˜ã—ã¾ã™ã€‚  \n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nã€Criticalï¼šæ„å‘³ã‚’æãªã†èª¤è¨³ãƒ»è„±è½ãƒ»èª¤æƒ…å ±ã€‘  \n1. â€œtoo much work, and too kludgyâ€  \n   â€¢ è¨³ï¼šã€Œã¾ã ã‚´ãƒãƒ£ã‚´ãƒãƒ£æ„ŸãŒã‚ã‚‹ã€  \n   â€¢ å•é¡Œï¼š â€œtoo much workâ€ï¼ã€Œæ‰‹é–“ãŒæ›ã‹ã‚Šéãã‚‹ã€ãŒæŠœã‘ã¦ã„ã‚‹ã€‚  \n   â€¢ æ”¹å–„ä¾‹ï¼š  \n     ã€Œæº€è¶³ã¯ã—ãŸã‘ã©ã€ã¾ã æ‰‹é–“ãŒå¤šã„ã—ã‚´ãƒãƒ£ã‚´ãƒãƒ£ã—ã¦ã‚‹ã€‚ã€  \n\n2. â€œjust commit with a message: `git commit -m â€œfixed issue #420â€`. This seems to bypass the pre-commit hook.â€  \n   â€¢ è¨³ï¼šå¾ŒåŠã® â€œThis seems to bypass â€¦â€ ãŒã‚«ãƒƒãƒˆã€‚  \n   â€¢ æ”¹å–„ä¾‹ï¼š  \n     ã€Œ`git commit -m \"fixed issue #420\"` ã®ã‚ˆã†ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä»˜ãã§ã‚³ãƒŸãƒƒãƒˆã™ã‚Œã°ãƒ•ãƒƒã‚¯ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹ã£ã½ã„ã€‚ã€  \n\n3. â€œI also wanted the prompt â€¦ without having to fuck with the .gitconfig over and over again.â€  \n   â€¢ è¨³ï¼šç½µã‚ŠèªãŒçœã‹ã‚Œãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ãŒå¼±ã„ã€‚  \n   â€¢ æ”¹å–„ä¾‹ï¼š  \n     ã€Œæ¯å› .gitconfig ã‚’ã„ã˜ãã‚Šå›ã™ï¼ˆfuck withï¼‰å¿…è¦ãŒãªã„ã‚ˆã†ã«ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã«ã—ãŸã‹ã£ãŸã€‚ã€  \n\n4. è¦‹å‡ºã— â€œGit Hookedâ€ ã®é§„æ´’è½  \n   â€¢ è¨³ï¼šã€ŒGit Hook ã ï¼ã€  \n   â€¢ å•é¡Œï¼šå‹•è© â€œhookedâ€ ã¨ Git Hook ã®èªå‘‚åˆã‚ã›ãŒæ¶ˆå¤±ã€‚  \n   â€¢ æ”¹å–„ä¾‹ï¼š  \n     ã€ŒGit ã«â€œHook ã•ã‚Œâ€ã¡ã‚ƒãˆï¼ã€ ãªã©èªå‘‚éŠã³ã‚’å…¥ã‚Œã‚‹ã€‚  \n\n5. â€œNever fear, LLMs are here.â€  \n   â€¢ è¨³ï¼šã€Œå®‰å¿ƒã—ã¦ã€LLM ã®ç™»å ´ã ã€  \n   â€¢ å•é¡Œï¼šåŸæ–‡ã¯éŸ»ã‚’è¸ã‚“ã ã‚­ãƒ£ãƒƒãƒã€‚ã‚„ã‚„å¹³å‡¡ã€‚  \n   â€¢ æ”¹å–„ä¾‹ï¼š  \n     ã€Œæã‚Œã‚‹ãªï¼LLM ãŒæ¥ãŸãğŸ’¥ã€  \n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nã€Majorï¼šãƒˆãƒ¼ãƒ³ãƒ»èªèª¿ãƒ»æ—¥æœ¬èªã®ä¸è‡ªç„¶ã•ã€‘  \n1. æ–‡ä½“ã‚†ã‚Œï¼ˆã‚¿ãƒ¡å£â‡”ã§ã™/ã¾ã™ï¼‰  \n   â€¢ è¨˜äº‹å…¨ä½“ã§ã€Œã€œã ã‚ˆã€ã€Œã‚¤ã‚¤æ„Ÿã˜ã ã£ãŸã€ã€Œã€œã§ã™ã€ãªã©ãŒæ··åœ¨ã€‚  \n   â€¢ æ–¹é‡ã‚’æ±ºã‚ã¦çµ±ä¸€ï¼ˆå®Œå…¨ã«ç •ã‘ãŸå£èªãªã‚‰ã€Œã§ã™/ã¾ã™ã€ã¯æ’é™¤ï¼‰ã€‚  \n\n2. ç½µã‚Šèªãƒ»ä¸‹å“ãƒ¦ãƒ¼ãƒ¢ã‚¢ã®å¸Œè–„åŒ–  \n   â€¢ åŸæ–‡ã¯ â€œfuckâ€, â€œtrashâ€, â€œkludgyâ€ ãªã©ä¸‹ä¸–è©±ã€‚è¨³ã¯ãƒã‚¤ãƒ«ãƒ‰ã€‚  \n   â€¢ ãƒ–ãƒ­ã‚°ã®ã‚­ãƒ£ãƒ©ã‚’æ´»ã‹ã™ãªã‚‰è»½ã„ç½µã‚Šèªã‚„ã‚¹ãƒ©ãƒ³ã‚°ã‚’æ®‹ã™  \n     ä¾‹ï¼šã€Œã‚´ãƒŸã¿ãŸã„ãªã€â†’OKã ãŒ â€œI am lazy!â€ ã®è¨³ã¯ã€Œã‚ªãƒ¬ã¯ã‚¯ã‚½æ€ ã‘è€…ã ã‹ã‚‰ï¼ã€ãã‚‰ã„ã§ã‚‚è‰¯ã„ã€‚  \n\n3. â€œChatGPT added the documentationâ€  \n   â€¢ è¨³ï¼šã€ŒChatGPT ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¦ãã‚ŒãŸã€  \n   â€¢ â€œdocumentationâ€ ã¯ã“ã“ã§ã¯ã€Œã‚³ãƒ¡ãƒ³ãƒˆã€ã€‚  \n   â€¢ æ”¹å–„ä¾‹ï¼šã€Œï¼ˆã‚³ãƒ¡ãƒ³ãƒˆã¯ ChatGPT ãŒä»˜ã‘ã¦ãã‚ŒãŸï¼‰ã€  \n\n4. â€œvi or deathâ€ ã‚¸ãƒ§ãƒ¼ã‚¯æœªåæ˜   \n   â€¢ è¨³ï¼šãŸã ã®ã€Œvi ã§ã‚‚ãŠå¥½ã¿ã®ã‚‚ã®ã§ã‚‚ã€  \n   â€¢ æ”¹å–„ä¾‹ï¼šã€Œã‚¨ãƒ‡ã‚£ã‚¿ã¯ vi ä¸€æŠï¼ï¼ˆæ­»ã‚’é¸ã¶ã‹ vi ã‹ã€ã£ã¦ã‚„ã¤ï¼‰ã€  \n\n5. â€œpretty!â€â†’ã€Œã‚«ãƒ¯ã‚¤ã‚¤ã€  \n   â€¢ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å½¢å®¹ã™ã‚‹ã®ã«ã€Œã‚«ãƒ¯ã‚¤ã‚¤ã€ã¯é•å’Œæ„Ÿã€‚  \n   â€¢ ã€Œã‚¤ã‚±ã¦ã‚‹ã€ã€Œã‚¯ãƒ¼ãƒ«ã€ç­‰ã«ç½®æ›ã€‚  \n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nã€Minorï¼šç´°éƒ¨ã®è¡¨è¨˜ã‚†ã‚Œãƒ»èª¤å­—ãƒ»ã‚¹ã‚¿ã‚¤ãƒ«ã€‘  \n1. è‹±èªã‚³ãƒãƒ³ãƒ‰åã®å…¨è§’å¼•ç”¨ã‚„ã‚¹ãƒšãƒ¼ã‚¹  \n   ä¾‹ï¼šã€ŒLLM CLIã€ã‚ˆã‚Šã‚‚ `llm` CLI ã¨ãƒãƒƒã‚¯ã‚¯ã‚©ãƒ¼ãƒˆã§çµ±ä¸€ã€‚  \n\n2. â€œShell GPTâ€ ã¨ â€œsgptâ€  \n   â€¢ åŸæ–‡ã® alias ã«åˆã‚ã› `sgpt` ã¨æ˜ç¤ºã—ãŸæ–¹ãŒè¦ªåˆ‡ã€‚  \n\n3. â€œClaudeâ€ ã®è¡¨è¨˜  \n   â€¢ æ‰€ã€… â€œClaudeâ€ / â€œclaudeâ€ ã¨åŸæ–‡åŒæ§˜æºã‚ŒãŒã‚ã‚‹ã€‚ã‚«ã‚¿ã‚«ãƒŠåŒ–ï¼ˆã‚¯ãƒ­ãƒ¼ãƒ‰ï¼‰orè‹±èªã§çµ±ä¸€ã€‚  \n\n4. ã€Œã‚¹ãƒ”ãƒŠãƒ¼ã€ãªã©ã‚«ã‚¿ã‚«ãƒŠç”¨èªã®æºã‚Œ  \n   â€¢ â€œspinnerâ€ ã‚’ã€Œã‚¹ãƒ”ãƒŠãƒ¼ã‚¢ãƒ‹ãƒ¡ã€ãªã©è¡¨ç¾çµ±ä¸€ã€‚  \n\n5. è·é›¢ãŒå‡ºã‚‹åŠ©è©  \n   â€¢ ã€Œã“ã‚Œã§ã‚„ã‚ŠãŸã„ã“ã¨ã¯ã»ã¼å®Ÿç¾ã€‚ã§ã‚‚ã€ã‚‚ã£ã¨ãƒ©ã‚¯ã—ãŸã„ã‹ã‚‰â€¦ã€  \n     â†’ã€Œã“ã‚Œã§ã ã„ãŸã„ç›®çš„ã¯é”æˆã€‚ã§ã‚‚ã¾ã ã¾ã ãƒ©ã‚¯ã—ãŸã„ã‹ã‚‰â€¦ã€  \n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nã€Terminology / ä¸€è²«æ€§ã€‘  \n1. ãƒ•ãƒƒã‚¯å  \n   â€¢ TL;DR ã§ã¯ â€œpre-commit-msgâ€ã€å®Ÿéš›ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ â€œprepare-commit-msgâ€ã€‚  \n   â€¢ åŸæ–‡é€šã‚Šã¨ã¯ã„ãˆèª­è€…ã«æ··ä¹±ã‚’ä¸ãˆã‚‹ã®ã§è„šæ³¨ã§èª¬æ˜ã‚’è£œã†ã‹è¨³æ³¨ã‚’å…¥ã‚Œã‚‹ã€‚  \n\n2. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å  \n   â€¢ åŸæ–‡ã‚‚æ··åœ¨ã—ã¦ã„ã‚‹ãŒã€Œgit-commit-message.txtã€ã¨ã€Œcommit-system-prompt.txtã€ãŒå…¥ã‚Šäº¤ã˜ã‚‹ã€‚è¨³æ–‡å†…ã§æ³¨é‡ˆã‚’å…¥ã‚Œã‚‹ã‹ â€œï¼ˆâ€»åŸæ–‡ã§ã¯ãƒ•ã‚¡ã‚¤ãƒ«åãŒãƒ–ãƒ¬ã¦ã„ã‚‹ï¼‰â€ ã¨è£œè¶³ã€‚  \n\n3. â€œllm cliâ€ ã®è¡¨è¨˜  \n   â€¢ `llm` CLI / LLM CLI ãŒæ··åœ¨ã€‚ã‚³ãƒ¼ãƒ‰ã¨åŒã˜ãƒãƒƒã‚¯ã‚¯ã‚©ãƒ¼ãƒˆã§ `llm` ã«çµ±ä¸€ã€‚  \n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nã€æ©Ÿæ¢°ç¿»è¨³è‡­ãƒ»ç›´è¨³èª¿ãŒç›®ç«‹ã¤ç®‡æ‰€ã€‘  \nãƒ»ã€Œã‚³ãƒŸãƒƒãƒˆãƒ•ãƒƒã‚¯ã¯è¶…ã‚·ãƒ³ãƒ—ãƒ«:ã€â†’è‹±èªèªé †ã®ã¾ã¾ã€‚  \nã€€â†’ã€Œã‚³ãƒŸãƒƒãƒˆãƒ•ãƒƒã‚¯ã¯è¶…ã‚·ãƒ³ãƒ—ãƒ«ã ã€‚ã€  \nãƒ»ã€Œå…ˆã®ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹ã€‚ã€  \nã€€â†’ã€Œã•ã£ãè¨­å®šã—ãŸã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½¿ã£ã¦ï½ã€  \n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nã€ä¿®æ­£ã®æŒ‡é‡ã€‘  \nâ€¢ æ–‡ä½“ã‚’ã€Œç •ã‘ãŸã‚¿ãƒ¡å£ï¼‹è‹±èªã‚¹ãƒ©ãƒ³ã‚°å¯„ã‚Šã€ã§çµ±ä¸€ã€‚  \nâ€¢ ã‚¸ãƒ§ãƒ¼ã‚¯ãƒ»ä¸‹å“ã•ã‚’æã‚Œãšæ®‹ã™ï¼ˆãŸã ã—å·®åˆ¥è¡¨ç¾ã¯çœãï¼‰ã€‚  \nâ€¢ ãƒ•ã‚¡ã‚¤ãƒ«åãƒ»ãƒ•ãƒƒã‚¯åãªã©æŠ€è¡“çš„è¡¨è¨˜ã¯ãƒãƒƒã‚¯ã‚¯ã‚©ãƒ¼ãƒˆã§çµ±ä¸€ã—ã€åŸæ–‡ã®ãƒ–ãƒ¬ã¯è¨³æ³¨ã§ãƒ•ã‚©ãƒ­ãƒ¼ã€‚  \nâ€¢ ã€Œvi or deathã€ã€ŒGit Hookedã€ãªã©è¨€è‘‰éŠã³ã¯æ—¥æœ¬èªã§ã‚‚ä½•ã‚‰ã‹ã®ãƒ€ã‚¸ãƒ£ãƒ¬ã‚’å…¥ã‚Œã¦å†ç¾ã€‚  \nâ€¢ â€œprettyâ€ï¼ã€Œã‚¯ãƒ¼ãƒ«ã€ã€Œã‚¤ã‚±ã¦ã‚‹ã€ã€ â€œkludgyâ€ï¼ã€Œãƒ€ã‚µã„ã€ã€Œã¨ã£æ•£ã‚‰ã‹ã£ã¦ã‚‹ã€ãªã©è‡ªç„¶ãªè¨³èªã‚’ã€‚  \n\nä»¥ä¸Šã‚’ä¿®æ­£ã™ã‚Œã°ã€åŸæ–‡ç‰¹æœ‰ã®ç”Ÿã£ã½ã„å‹¢ã„ã¨ãƒ¦ãƒ¼ãƒ¢ã‚¢ãŒã‚ˆã‚Šè‡ªç„¶ãªæ—¥æœ¬èªã§ä¼ã‚ã‚Šã¾ã™ã€‚",
      "ã€ç·è©•ã€‘  \nåŸæ–‡ã®ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ã§ãƒã‚¤ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ãªâ€œé–‹ç™ºè€…ãƒ–ãƒ­ã‚°æ–‡ä½“â€ã¯æ¦‚ã­å†ç¾ã§ãã¦ã„ã¾ã™ãŒã€ç”¨èªã®å–ã‚Šé•ãˆãƒ»è»½å¾®ãªæ¬ è½ãƒ»ä¸è¦ãªæ„è¨³ãƒ»æ—¥æœ¬èªã¨ã—ã¦ã®ä¸è‡ªç„¶ã•ãŒéšæ‰€ã«æ®‹ã£ã¦ã„ã¾ã™ã€‚  \næŠ€è¡“è¨˜äº‹ã¨ã—ã¦èª­ã¾ã›ã‚‹ãªã‚‰ã€ã‚„ã‚„èª‡å¼µæ°—å‘³ã®ã‚¹ãƒ©ãƒ³ã‚°ã‚„èª¤è¨³ã‚’å‰Šãã€  \r\nãƒ‘ã‚¹åãƒ»ãƒ•ãƒƒã‚¯åãªã©æ©Ÿæ¢°ãŒèª­ã‚€éƒ¨åˆ†ã¯ 1 byte ã‚‚é•ãˆãªã„â”€â”€ã¨ã„ã†å§¿å‹¢ãŒå¿…è¦ã§ã™ã€‚\n\nä»¥ä¸‹ã€é‡å¤§åº¦é †ã«å•é¡Œç‚¹ã¨ä¿®æ­£æ¡ˆã‚’åˆ—æŒ™ã—ã¾ã™ã€‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nâ– A. ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ï¼ˆèª¤è¨³ãƒ»äº‹å®Ÿèª¤èªï¼‰  \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \n1. ãƒ•ãƒƒã‚¯åã®å¤‰æ›´ï¼ˆ`pre-commit-msg` â†’ `prepare-commit-msg`ï¼‰  \nã€€â€¢ åŸæ–‡ TL;DR ã¯ â€œpre-commit-msgâ€ ã¨æ˜è¨˜ã€‚è¨³æ–‡ã¯ã€Œprepare-commit-msgã€ã«æ›¸ãæ›ãˆã€æ‹¬å¼§ã§æ³¨è¨˜ã‚’å…¥ã‚Œã¦ã„ã‚‹ãŒã€  \nã€€ã€€ãƒ»åŸæ–‡ã‚’æ”¹å¤‰ã—ã¦ã„ã‚‹  \nã€€ã€€ãƒ»å¾Œç¶šã®èª¬æ˜ã¨é£Ÿã„é•ã†ï¼ˆåŸæ–‡ã¯é€”ä¸­ã‹ã‚‰ `prepare-commit-msg` ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹ãŸã‚ä½™è¨ˆã«æ··ä¹±ï¼‰  \nã€€ã€ä¿®æ­£ã€‘TL;DR ã¯åŸæ–‡ã©ãŠã‚Š `pre-commit-msg` ã¨ã—ã€ã€Œå®Ÿéš›ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã¯ prepare-commit-msg ã‚’ä½¿ã£ã¦ã„ã‚‹ã€ã¨è„šæ³¨ã§è£œè¶³ã€‚\n\n2. â€œskip the hookâ€ ã®æŒ™å‹•èª¬æ˜ä¸è¶³  \nã€€â€¢ åŸæ–‡ â€œâ€¦you can skip the hook. But if you are lazy, you exclude the message and it will call the LLM.â€  \nã€€ã€€è¨³æ–‡ã¯ã€Œãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªåˆ†ã§æ›¸ããŸã„ã¨ãã¯ãƒ•ãƒƒã‚¯ã‚’ã‚¹ã‚­ãƒƒãƒ—ã§ãã‚‹ã€ã§æ­¢ã¾ã£ã¦ã„ã‚‹ã€‚  \nã€€ã€€â€œãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’çœç•¥ã™ã‚‹ã¨è‡ªå‹•ç”Ÿæˆâ€ã¨ã„ã†å¯¾ã«ãªã‚‹èª¬æ˜ãŒå¼±ã„ã€‚  \nã€€ã€ä¿®æ­£ã€‘ï¼’è¡Œæ§‹æˆã§å¯¾æ¯”ã‚’å¼·èª¿ã€‚ä¾‹:  \nã€€ã€€ã€Œãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªåˆ†ã§æ›¸ã‘ã°ãƒ•ãƒƒã‚¯ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹ã€‚ä¸€æ–¹ã€ä½•ã‚‚æ›¸ã‹ãšã« `git commit` ã™ã‚Œã° LLM ãŒå‘¼ã°ã‚Œã‚‹ã€‚ã€\n\n3. â€œfuck with the .gitconfigâ€ ã®è¨³å‡º  \nã€€â€¢ â€œfuck withâ€ ã¯ã€Œã„ã˜ãã‚Šå›ã™ï¼ã”ã¡ã‚ƒã”ã¡ã‚ƒè§¦ã‚‹ã€ãŒè‡ªç„¶ã€‚  \nã€€ã€€è¨³æ–‡ã€Œã„ã˜ãã‚Šå›ã•ãªãã¦ã‚‚æ¸ˆã‚€ã‚ˆã†ã«ã€ã§ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã¯æ‹¾ãˆã¦ã„ã‚‹ãŒã€å‰ã®æ‹¬å¼§\r\nã€€ã€€ã€€ã€Œï¼ˆfuck with `.gitconfig` ã¯ã‚‚ã†ã‚¤ãƒ¤ï¼‰ã€ã¯ä¸è‡ªç„¶ã€‚  \r\nã€€ã€ä¿®æ­£ã€‘æ‹¬å¼§å†…ã®ãƒ©ãƒ•ã•ã‚’æ®‹ã™ãªã‚‰ã€Œï¼ˆ.gitconfig ã‚’ã„ã˜ãã‚Šå›ã™ã®ã¯ã‚¦ãƒ³ã‚¶ãƒªã ï¼‰ã€ç¨‹åº¦ã€‚\n\n4. â€œIt was pretty robust.â€  \nã€€â€¢ è¨³æ–‡ã€Œã‹ãªã‚Šã‚¤ã‚¤æ„Ÿã˜ã€‚ã€ã¯ã€Œrobustï¼å …ç‰¢ã€ã‚’ååˆ†ã«ä¼ãˆãšã€ã‚„ã‚„è»½ã„ã€‚  \nã€€ã€ä¿®æ­£ã€‘ã€Œå‹•ä½œã¯ã‹ãªã‚Šå …ç‰¢ã ã£ãŸã€‚ã€ãªã©æŠ€è¡“çš„ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã‚’æ˜ç¤ºã€‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nâ– B. é‡è¦ï¼ˆãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹æ¬ è½ãƒ»ä¸é©åˆ‡ãªè¨€ã„æ›ãˆï¼‰  \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \n1. â€œTrash commit messages. I am lazy!â€  \nã€€â€¢ è¨³æ–‡ã€Œã‚´ãƒŸã¿ãŸã„ãªã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‚ãƒ©ã‚¯ã—ãŸã„ã‚“ã ã‚ˆï¼ã€  \nã€€ã€€å‰æ®µã® â€œTrash commit messages.â€ ã¯ã€Œã²ã©ã„ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã ã‚ï¼Ÿã€ã¨ã„ã†èª­è€…ã¸ã®å‘¼ã³ã‹ã‘ã€‚  \r\nã€€ã€ä¿®æ­£ã€‘ã€Œã²ã©ã„ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã—ã‚‡ï¼Ÿ ã‚ªãƒ¬ã¯æ€ ã‘è€…ãªã‚“ã ï¼ã€ç­‰ã€ç›¸æ‰‹ã«è¦‹ã›ã‚‹èª¿å­ã‚’è¶³ã™ã€‚\n\n2. â€œI was satisfied, but this was still too much work, and too kludgy.â€  \nã€€â€¢ ã€Œã‚´ãƒãƒ£ã‚´ãƒãƒ£ã—ã¦ã‚‹ã€ã¯ â€œkludgyâ€ ã®åŠåˆ†ã ã‘ã€‚  \r\nã€€ã€ä¿®æ­£ã€‘ã€Œæº€è¶³ã¯ã—ãŸã‘ã©ã€æ‰‹é–“ã¯ã¾ã å¤šã„ã—ã€ä½œã‚Šã‚‚ã‚´ãƒ†ã‚´ãƒ†ã®ãƒãƒƒã‚¯æ„Ÿæº€è¼‰ã ã€‚ã€ãªã©å†—é•·ã•ã‚’è£œã†ã€‚\n\n3. â€œGit ã« â€œHookâ€ ã•ã‚Œã¡ã¾ãˆï¼â€  \nã€€â€¢ åŸæ–‡ â€œGit Hookedâ€ ã¯ â€œGet Hookedï¼ˆãƒãƒã‚‹ï¼‰â€ ã®ã‚‚ã˜ã‚Šã€‚  \r\nã€€ã€€è¨³ã¯ã€ŒGit ã«ãƒ•ãƒƒã‚¯ã•ã‚Œã‚‹ã€ã«ãªã‚Šæ„å‘³ãŒè£è¿”ã‚‹ã€‚  \nã€€ã€ä¿®æ­£ã€‘ã€ŒGit ãƒ•ãƒƒã‚¯ã«ãƒãƒã‚Œï¼ã€ãªã© pun ã‚’ä¿ã£ãŸã¾ã¾æ–¹å‘ã‚’æ­£ã™ã€‚\n\n4. â€œvi ã‹æ­»ã‹ã€ã ã‚ï¼Ÿâ€  \nã€€â€¢ â€œvi or deathâ€œ ã¯æ–‡åŒ–ãƒã‚¿ã€‚â€œvi ã‹æ­»ã‹â€ ã¯ç›´è¨³ã ãŒæ¥µç«¯ã€‚  \r\nã€€ã€ä¿®æ­£ã€‘ã€Œvi ã‹æ­»ã‹ï¼ˆ= Emacs ã¯ãªã„ï¼‰ã€ã¨è£œè¶³ã™ã‚‹ã‹ã€è»½å£ã«ç•™ã‚ã‚‹ã€‚\n\n5. â€œ(`llm` CLI ã¯ãƒã‚¸ã§å¼·åŠ›ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«å«ã‚ã„ã‚ã‚“ãªãƒ¢ãƒ‡ãƒ«ã¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã‚‹ã‹ã‚‰æ·±æ˜ã‚Šæ¨å¥¨)â€  \nã€€â€¢ â€œcontextsâ€ ã¯ â€œã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆé•·â€ ã¾ãŸã¯ â€œãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®å‰å¾Œæ–‡è„ˆâ€ ã‚’ç¤ºã™å¯èƒ½æ€§ã€‚  \r\nã€€ã€ä¿®æ­£ã€‘ã€Œã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆé•·ã®åˆ‡ã‚Šæ›¿ãˆãªã©ã‚‚æŸ”è»Ÿã€ç­‰ã€æŠ€è¡“çš„æ„å‘³ã‚’å…·ä½“åŒ–ã€‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nâ– C. ä¸­ç¨‹åº¦ï¼ˆèªèª¿ãƒ»æ–‡ä½“ãƒ»ä¸€è²«æ€§ï¼‰  \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \n1. ä¸€äººç§° â€œã‚ªãƒ¬â€ ã®ä¹±ç”¨  \nã€€â€¢ åŸæ–‡ã¯ â€œIâ€ ã ãŒã€ãƒ–ãƒ­ã‚°å…¨ä½“ã®å£èª¿ã¯ â€œfriendly/dev casualâ€ ã§ â€œã‚ªãƒ¬â€ ã»ã©ãƒ¤ãƒ³ãƒãƒ£ã§ã¯ãªã„ã€‚  \nã€€ã€ä¿®æ­£ã€‘â€œåƒ•â€ â€œè‡ªåˆ†â€ ãªã©æŸ”ã‚‰ã‹ã‚ã«æƒãˆã‚‹ã‹ã€å°‘ãªãã¨ã‚‚æ•¬ä½“ã«æ··ãœãªã„ã€‚\n\n2. ã‚¹ãƒ©ãƒ³ã‚°ã®éå‰°å¼·èª¿  \nã€€â€¢ â€œã‚¯ã‚½æ€ ã‘è€…â€ â€œã‚´ãƒŸã¿ãŸã„ãªâ€ ãªã©ç½µå€’èªãŒåŸæ–‡ã‚ˆã‚Šå¼·ã‚ã€‚  \r\nã€€ã€ä¿®æ­£ã€‘â€œè¶…æ€ ã‘è€…â€â€œã²ã©ã„â€ ç¨‹åº¦ã«æŠ‘ãˆã€èª­ã¿æ‰‹ã‚’é¸ã°ãªã„ç¨¿ã«ã€‚\n\n3. åŠè§’ã‚«ãƒŠï¼å…¨è§’è‹±å­—ã®æ··åœ¨  \nã€€â€¢ â€œLLM ãŒæ¥ãŸãœğŸ’¥â€ â€œHookâ€ ãªã©ã€å¤§æ–‡å­—è‹±å˜èªã‚’å¼•ç”¨ç¬¦ã§å›²ã‚€ãªã‚‰çµ±ä¸€ (â€œhookâ€ ã‹ â€œHookâ€)ã€‚  \r\nã€€ã€ä¿®æ­£ã€‘è‹±å˜èªã¯ãƒãƒƒã‚¯ã‚¯ã‚©ãƒ¼ãƒˆã‹å…¨è§’å¼•ç”¨ç¬¦ã§ä¸€å¾‹ã€‚\n\n4. ç®‡æ¡æ›¸ããƒ»ç•ªå·è¦‹å‡ºã—ã®ã‚ºãƒ¬  \nã€€â€¢ æ‰‹é † 6 è¦‹å‡ºã—ã€Œã‚¨ãƒ‡ã‚£ã‚¿ã§é–‹ãï¼ˆvi ã‹æ­»ã‹ã€ã ã‚ï¼Ÿï¼‰ã€ãŒæ¨ªé•·ã€‚  \r\nã€€ã€ä¿®æ­£ã€‘ã€Œ6. ã‚¨ãƒ‡ã‚£ã‚¿ã§é–‹ã„ã¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è²¼ã‚Šä»˜ã‘ã‚‹ï¼ˆvi or dieğŸ¤˜ï¼‰ã€ãªã©è¦‹å‡ºã—ã‚’ç°¡æ½”ã«ã€‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nâ– D. è»½å¾®ï¼ˆè¡¨è¨˜ãƒ»ã‚¿ã‚¤ãƒãƒ»æ©Ÿæ¢°ç¿»è¨³è‡­ï¼‰  \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \n1. â€œChatGPT added the documentationâ€ â†’ â€œï¼ˆã‚³ãƒ¡ãƒ³ãƒˆã¯ ChatGPT ãŒä»˜ã‘ã¦ãã‚ŒãŸï¼‰â€  \nã€€â€¢ â€œdocumentationâ€ ã¯ â€œã‚³ãƒ¡ãƒ³ãƒˆï¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆâ€ ã©ã¡ã‚‰ã‚‚å¯ã ãŒã€ã“ã“ã§ã¯ã‚³ãƒ¼ãƒ‰å†…ã‚³ãƒ¡ãƒ³ãƒˆã€‚  \r\nã€€ã€ä¿®æ­£ã€‘ã€Œï¼ˆã‚³ãƒ¡ãƒ³ãƒˆæ–‡ã¯ ChatGPT ç”£ï¼‰ã€ã§ååˆ†ã€‚\n\n2. â€œã‚¤ã‚§ã‚¤ã€‚â€  \nã€€â€¢ â€œYay.â€ ã«å¯¾ã—ã¦ç‰‡ä»®å â€œã‚¤ã‚§ã‚¤â€ ã¯ç›®ç«‹ã¤ã€‚  \r\nã€€ã€ä¿®æ­£ã€‘ã€Œã‚„ã£ãŸãƒ¼ã€‚ã€ãªã©ä¸€èˆ¬çš„è¡¨ç¾ã«ã€‚\n\n3. ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸­ã®ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯å¼•ç”¨è¡Œæœ«ã®å…¨è§’ã‚¹ãƒšãƒ¼ã‚¹  \nã€€â€¢ Markdown è§£ææ™‚ã«ä¸è¦ãªæ”¹è¡ŒãŒå‡ºã‚‹å¯èƒ½æ€§ã€‚  \nã€€ã€ä¿®æ­£ã€‘è¡Œæœ«ã®å…¨è§’ã‚¹ãƒšãƒ¼ã‚¹ã‚’é™¤å»ã€‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nâ– E. ç”¨èªãƒ»ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ•´åˆæ€§  \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \n| è‹±èªåŸæ–‡ | æ­£è¨³ä¾‹ | è¨³æ–‡ |\n|----------|---------|-------|\n| staged changes | ã‚¹ãƒ†ãƒ¼ã‚¸æ¸ˆã¿ã®å¤‰æ›´ | â€œã‚¹ãƒ†ãƒ¼ã‚¸æ¸ˆã¿ã® diffâ€ â†’ diff ã¯å·®åˆ†ã®æ„ã§å†—é•· |\n| cached diff (`git diff --cached`) | ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®å·®åˆ† | â€œã‚¹ãƒ†ãƒ¼ã‚¸æ¸ˆã¿ã® diffâ€ ã§å¯ã ãŒè„šæ³¨ãŒã‚ã‚‹ã¨è¦ªåˆ‡ |\n| kludgy | ãƒãƒªãƒœãƒ†æ„Ÿã®ã‚ã‚‹ï¼æ³¥è‡­ã„ | â€œã‚´ãƒãƒ£ã‚´ãƒãƒ£ã—ã¦ã‚‹â€ |\n| Skip the hook | ãƒ•ãƒƒã‚¯ã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ | â€œãƒã‚¤ãƒ‘ã‚¹ã•ã‚Œã‚‹ã£ã½ã„â€ ã¨æ›–æ˜§ |\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nâ– ã¾ã¨ã‚ä¿®æ­£æ¡ˆï¼ˆå†’é ­éƒ¨åˆ†ã®ä¾‹ç¤ºï¼‰  \nåŸæ–‡:  \nTL;DR: You can set a pre-commit-msg git hook â€¦  \n\næ”¹å–„è¨³ï¼ˆæ¡ˆï¼‰:  \nTL;DR: `pre-commit-msg` Git ãƒ•ãƒƒã‚¯ã« `llm` CLI ã‚’ä»•è¾¼ã‚ã°ã€ç›´è¿‘ã®å¤‰æ›´ã‚’è¦ç´„ã—ãŸã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•ç”Ÿæˆã§ãã‚‹ã€‚  \nï¼ˆâ€»å®Ÿéš›ã®å®Ÿè£…ä¾‹ã§ã¯ `prepare-commit-msg` ã‚’ä½¿ã£ã¦ã„ã‚‹ï¼‰\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nã“ã®ä¸€è¦§ã‚’åæ˜ ã™ã‚Œã°ã€  \nãƒ»æŠ€è¡“çš„æƒ…å ±ã®æ­£ç¢ºã•  \nãƒ»åŸæ–‡ã‚¸ãƒ§ãƒ¼ã‚¯ã®ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹  \nãƒ»æ—¥æœ¬èªã¨ã—ã¦ã®èª­ã¿ã‚„ã™ã•  \nã®ä¸‰ç‚¹ãŒæƒã£ãŸè¨³æ–‡ã«ãªã‚Šã¾ã™ã€‚",
      "ã€ç·è©•ã€‘  \nå…¨ä½“ã¨ã—ã¦åŸæ–‡ã®å†…å®¹ã¯å¤§ç­‹ã§ä¼ã‚ã£ã¦ã„ã‚‹ãŒã€ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ãƒ»å£èª¿ãƒ»èªå½™ã®ã‚ºãƒ¬ã‚„ç´°ã‹ãªæ¬ è½ãŒæ•£è¦‹ã•ã‚Œã‚‹ã€‚ã¨ãã«åŸæ–‡ç‰¹æœ‰ã®â€œç •ã‘ãŸæ‚ªãƒãƒªæ„Ÿâ€â€œè»½ã„ä¸‹å“ã•â€â€œè¨€è‘‰éŠã³ï¼ˆGit Hooked ï¼ Get Hookedã®é§„æ´’è½ï¼‰â€ãŒå¼±ã¾ã‚Šã€è‘—è€…ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒã¼ã‚„ã‘ã¦ã„ã‚‹ã€‚ã¾ãŸã€ã„ãã¤ã‹ã®æ–‡è¨€ã¯ã‚„ã‚„æ„è¨³ã—éãã¦æ„å‘³ãŒå¤‰ã‚ã£ã¦ã„ã‚‹ã‹ã€æƒ…å ±ã‚’è¿½åŠ ï¼å‰Šé™¤ã—ã¦ã„ã‚‹ã€‚ä»¥ä¸‹ã€æ·±åˆ»åº¦ã”ã¨ã«å•é¡Œç‚¹ã¨æ”¹å–„æ¡ˆã‚’åˆ—æŒ™ã™ã‚‹ã€‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nâ—†ã€Criticalï¼é‡å¤§ã€‘æ„å‘³ã‚„äº‹å®Ÿã®èª¤ã‚Šãƒ»æ¬ è½  \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \n1. hook åç§°ã®æ··ä¹±  \nã€€ãƒ»åŸæ–‡ TL;DR: â€œpre-commit-msg git hookâ€  \nã€€ãƒ»è¨³: ã€Œ`pre-commit-msg` Git ãƒ•ãƒƒã‚¯â€¦ã€ã¨ã—ã¤ã¤è„šæ³¨ã§ã€Œå®Ÿè£…ä¾‹ã§ã¯ `prepare-commit-msg`ã€ã‚’æŒ¿å…¥ã€‚  \nã€€â†’ èª­è€…ãŒã€Œpre-commit-msg ã¨ prepare-commit-msg ã®ã©ã£ã¡ï¼Ÿã€ã¨æ··ä¹±ã™ã‚‹ã€‚  \nã€æ”¹å–„ã€‘è„šæ³¨ã§ã¯ãªãæœ¬æ–‡ã§ã€Œè¨˜äº‹å†…ã®å®Ÿè£…ã§ã¯ `prepare-commit-msg` ã‚’ä½¿ã†ãŒ TL;DR ã¨ã—ã¦ã¯ â€˜pre-commit-msg ç›¸å½“â€™ã€ã¨æ˜ç¤ºã—ã€è£œè¶³ã‚’æœ€å°é™ã«ã€‚\n\n2. è¿½åŠ æƒ…å ±ã®æŒ¿å…¥ï¼ˆè„šæ³¨ãƒ»â€œãƒãƒªãƒœãƒ†æ„Ÿâ€ãªã©ï¼‰  \nã€€åŸæ–‡ã«ãªã„æƒ…å ±ã‚’ä»»æ„ã«è£œè¶³ã—ã¦ãŠã‚Šã€**ã€Œ100% å¿ å®Ÿã€**ã®è¦ä»¶ã«æŠµè§¦ã€‚  \nã€æ”¹å–„ã€‘è„šæ³¨ã‚„å½¢å®¹ã¯ã€æœ¬æ–‡ã‚’æ”¹å¤‰ã—ãªã„ç¯„å›²ã§ã€Œè¨³æ³¨: â€¦ã€ã¨æ˜ç¤ºã™ã‚‹ã‹å‰Šé™¤ã€‚\n\n3. â€œThis seems to bypass the pre commit hook.â€ ã®çœç•¥  \nã€€LLM ã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ã¨ *pre-commit*ï¼ˆprepare-commit-msg ã§ã¯ãªã„ï¼‰ã®ãƒ•ãƒƒã‚¯ãŒå›é¿ã•ã‚Œã‚‹ã¨ã„ã†æ³¨æ„æ›¸ããŒä¸¸ã”ã¨è½ã¡ã¦ã„ã‚‹ã€‚  \nã€æ”¹å–„ã€‘ã€Œâ€¦ã“ã‚Œã§ pre-commit ãƒ•ãƒƒã‚¯ã‚‚ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹ã£ã½ã„ ğŸ¤”ã€ç­‰ã€åŸæ–‡ã©ãŠã‚Šè£œå®Œã€‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nâ—†ã€Majorï¼å¤§ãã‚ã€‘ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ãƒ»å£èª¿ãƒ»èªæ„Ÿã®ã‚ºãƒ¬  \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \n4. ç½µèªãƒ»ã‚¹ãƒ©ãƒ³ã‚°ã®å¼±ä½“åŒ–  \nã€€ãƒ»â€œfuck with the .gitconfigâ€ â†’ ã€Œã„ã˜ãã‚Šå›ã™ã€  \nã€€ãƒ»â€œTrash commit messagesâ€ â†’ ã€Œã²ã©ã„ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã—ã‚‡ï¼Ÿã€  \nã€€â†’ åŸæ–‡ã®ä¸‹å“ã•ãƒ»è‡ªå·±å‘ä¸‹ãŒè–„ã‚Œã€è‘—è€…ã®ã‚­ãƒ£ãƒ©ãŒãƒã‚¤ãƒ«ãƒ‰ã«ãªã‚Šéãã€‚  \nã€æ”¹å–„ã€‘ã€Œã‚¯ã‚½ã¿ãŸã„ãªã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã€Œ.gitconfig ã‚’ã„ã¡ã„ã¡ã‚´ãƒ‹ãƒ§ã‚´ãƒ‹ãƒ§å¼„ã‚‹ã®ã¯ã‚¦ãƒ³ã‚¶ãƒªã ï¼ˆã‚¯ã‚½ã‚ã‚“ã©ã„ï¼‰ã€ãªã©ã€è»½ã‚ã®ä¿—èªã§å†ç¾ã€‚\n\n5. ãƒ€ã‚¸ãƒ£ãƒ¬ â€œGit Hookedâ€  \nã€€è¨³ã€ŒGit ãƒ•ãƒƒã‚¯ã«ãƒãƒã‚Œï¼ã€ã¯ç›´è¨³ãã¿ã§èªå‘‚éŠã³ãŒæ­»ã‚“ã§ã„ã‚‹ã€‚  \nã€æ”¹å–„ã€‘ã€ŒGit Hook ã« Get HookedğŸ”¥ã€ã€ŒGit ãƒ•ãƒƒã‚¯æ²¼ã¸ã‚ˆã†ã“ãã€ãªã©èªå‘‚ã‚’ç”Ÿã‹ã™ã€‚\n\n6. â€œkludgyâ€ â†’ ã€Œãƒãƒªãƒœãƒ†æ„Ÿã€  \nã€€â€œkludgyâ€ ã¯ã€Œå ´å½“ãŸã‚Šçš„ã§ã”ã¡ã‚ƒã£ã¨ã—ãŸã€ã®æ„ã€‚ã€Œãƒãƒªãƒœãƒ†æ„Ÿã€ã¯â€œlooks nice but fakeâ€å¯„ã‚Šã§ã‚ºãƒ¬ã€‚  \nã€æ”¹å–„ã€‘ã€Œã¾ã å ´å½“ãŸã‚Šãƒãƒƒã‚¯æ„ŸãŒå¼·ã„ã€ã€Œã”ã¡ã‚ƒã£ã¨ã—éãã€ãªã©ã€‚\n\n7. â€œso so closeâ€ â†’ ã€Œãã“ãã“è‰¯ã‹ã£ãŸã€  \nã€€â€œã‚ã¨ä¸€æ­©â€â€œã‚‚ã†ã»ã¼å®Œæˆâ€ ãŒè¿‘ã„ã€‚  \nã€æ”¹å–„ã€‘ã€Œã‚ã¨ä¸€æ­©ã£ã¦æ„Ÿã˜ã ã£ãŸã‘ã©ã€\n\n8. å†—è«‡ã®çœç•¥  \nã€€â€œLol. Why would I have that in my brain â€“ who knows!â€ ãŒã”ã£ãã‚Šå‰Šé™¤ã€‚  \nã€æ”¹å–„ã€‘ã€Œãªã‚“ã§ã“ã‚“ãªã®è¦šãˆã¦ãŸã‚“ã ã‚ã€æˆ‘ãªãŒã‚‰è¬ï½—ã€ãªã©è¿½åŠ ã€‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nâ—†ã€Moderateï¼ä¸­ç¨‹åº¦ã€‘èªå¥ãƒ»æ–‡ä½“ã®ä¸è‡ªç„¶ã•ï¼é›‘ãªæ©Ÿæ¢°ç¿»è¨³è‡­  \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \n9. ã€ŒGit ãƒ•ãƒƒã‚¯ã«ãƒãƒã‚Œï¼ã€ã®å‘½ä»¤å½¢ãŒç¡¬ã„  \nã€æ”¹å–„ã€‘ã€ŒGit ãƒ•ãƒƒã‚¯ã«æ²¼ã‚Œï¼ã€ã€ŒGit ãƒ•ãƒƒã‚¯ã§ã‚¤ã£ã¡ã‚ƒãŠã†ï¼ã€ç­‰ã§ã‚‚ã£ã¨ç •ã‘ãŸèªæ„Ÿã«ã€‚\n\n10. ã€Œåƒ•ã¯æ€ ã‘è€…ãªã‚“ã ã€ã‚’äºŒåº¦ç¹°ã‚Šè¿”ã—  \nã€€åŸæ–‡ã¯ä¸€åº¦ã ã‘ã€‚å†—é•·ã€‚  \nã€æ”¹å–„ã€‘å†’é ­ã®ä¸€å›ã«ç•™ã‚ã‚‹ã€‚\n\n11. ã€Œvi or die ğŸ¤˜ã€  \nã€€åŸæ–‡â€œvi or deathâ€ã€‚die ã§ã‚‚æ„å‘³ã¯ä¼ã‚ã‚‹ãŒã€ç´°éƒ¨ã®å¿ å®Ÿã•ã‚’æœŸã™ãªã‚‰ â€œdeathâ€ ã«ã€‚\n\n12. å’Œæ–‡ä¸­ã®ã‚³ãƒ¼ãƒ‰ã‚„è‹±èªå¥ã®å…¨è§’ï¼åŠè§’ãƒ»ãƒãƒƒã‚¯ã‚¯ã‚©ãƒ¼ãƒˆè¡¨è¨˜ã‚†ã‚Œ  \nã€€ä¾‹: `shell gpt` â†’ åŸæ–‡ã¯ â€œshell gptâ€ ã§ãªã â€œshell gpt (shell-gpt)â€ã€‚  \nã€æ”¹å–„ã€‘æŠ€è¡“èªã¯ã™ã¹ã¦åŸç¶´ãƒ»åŠè§’çµ±ä¸€ã§ã€‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nâ—†ã€Minorï¼è»½å¾®ã€‘ã‚¹ã‚¿ã‚¤ãƒ«ãƒ»ç”¨å­—ç”¨èª  \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \n13. çµµæ–‡å­—ã®è¿½åŠ ä½ç½®  \nã€€è¨³æ–‡ã§ ğŸ’¥ ã‚’è¿½åŠ ã—ãŸãŒã€åŸæ–‡è¦‹å‡ºã—ã«ã¯ç„¡ã—ï¼ˆâ€œLLMs are here.â€ï¼‰ã€‚ä¸è¦ãªã‚‰å‰Šé™¤ã€‚  \n14. ã€Œvi or die ğŸ¤˜ã€ã€Œvi or death ğŸ¤˜ã€ã®ğŸ¤˜ã¯åŸæ–‡ã«ç„¡ã„ã€‚å‰Šã‚‹ã‹è¨³æ³¨æ‰±ã„ã§ã€‚  \n15. â€œYMMVâ€ â†’ ã€Œè‡ªå·±è²¬ä»»ã§ã­ã€  \nã€€æ„ã¯åˆã†ãŒ â€œçµæœã¯äººãã‚Œãã‚Œ (YMMV)â€ ç­‰ã§ç›´è¨³è£œè¶³ãŒãƒ™ã‚¿ãƒ¼ã€‚  \n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nâ—†ã€Terminologyï¼ç”¨èªçµ±ä¸€ã€‘  \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \n16. â€œstage/unstageâ€ â†’ ã€Œã‚¹ãƒ†ãƒ¼ã‚¸ã€ã€Œã‚¢ãƒ³ã‚¹ãƒ†ãƒ¼ã‚¸ã€ã§çµ±ä¸€  \n17. pre-commit ã¨ prepare-commit-msg ã‚’æ•´ç†  \n18. â€œshell-gptâ€ ã®ãƒã‚¤ãƒ•ãƒ³æŠœã‘ (`shell gpt` è¡¨è¨˜)  \n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nâ—†ä¿®æ­£ã‚µãƒ³ãƒ—ãƒ«ï¼ˆæŠœç²‹ï¼‰  \nåŸ: ã“ã‚Œã§ç›®çš„ã¯ã ã„ãŸã„é”æˆã€‚ã§ã‚‚ã¾ã æ‰‹é–“ãŒå¤šã„ã—ã€ã‚´ãƒ†ã‚´ãƒ†ã®ãƒãƒƒã‚¯æ„Ÿæº€è¼‰ã ã€‚  \næ”¹: ã“ã‚Œã§ã‚„ã‚ŠãŸã„ã“ã¨ã¯ã»ã¼å‡ºæ¥ãŸã€‚ã§ã‚‚ã‚ªãƒ¬ã¯æ€ ã‘è€…ã ã—ã€ã¾ã å ´å½“ãŸã‚Šãƒãƒƒã‚¯æ„ŸãŒå¼·ã™ãã‚‹ã€‚  \n\nåŸ: ãã“ã§æ€ã„å‡ºã—ãŸã®ãŒ Git ãƒ•ãƒƒã‚¯ã ã€‚  \næ”¹: ãã“ã§ã€Œãã†ã ã€Git ãƒ•ãƒƒã‚¯ãŒã‚ã£ãŸã˜ã‚ƒã‚“ï½—ã€ã¨ã²ã‚‰ã‚ã„ãŸã€‚  \n\nåŸ: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªåˆ†ã§æ›¸ã‘ã°ãƒ•ãƒƒã‚¯ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹ã€‚  \næ”¹: è‡ªåˆ†ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥ã‚Œã¡ã‚ƒãˆã°ãƒ•ãƒƒã‚¯ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹ä»•çµ„ã¿ã€‚  \n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  \nâ—†ã¾ã¨ã‚  \nãƒ»è‡´å‘½çš„ãªèª¤è¨³ã¯å°‘ãªã„ãŒã€åŸæ–‡ç‰¹æœ‰ã®â€œãã ã‘ãŸãƒãƒªï¼‹è‹¥å¹²ã®ä¸‹å“ã•â€ãŒè–„ã‚Œã€è‹¥å¹²ã®å†…å®¹è¿½åŠ ï¼çœç•¥ã‚‚è¦‹ã‚‰ã‚Œã‚‹ã€‚  \nãƒ»ãƒ•ãƒƒã‚¯åã‚„ YMMV ãªã©æŠ€è¡“ãƒ»æ³¨æ„æ›¸ãã®ç´°éƒ¨ã§å¿ å®Ÿã•ã‚’æ¬ ãç®‡æ‰€ã‚’ä¿®æ­£ã™ã‚‹ã“ã¨ã€‚  \nãƒ»ã‚¹ãƒ©ãƒ³ã‚°ï¼ç½µèªãƒ»ãƒ€ã‚¸ãƒ£ãƒ¬ãƒ»ã‚¸ãƒ§ãƒ¼ã‚¯ã‚’é©åˆ‡ã«æ—¥æœ¬èªã§å†ç¾ã—ã€è‘—è€…ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã¨ãƒˆãƒ¼ãƒ³ã‚’ä¿æŒã™ã‚‹ã€‚  \nãƒ»ä¸è¦ãªè„šæ³¨ãƒ»çµµæ–‡å­—è¿½åŠ ã¯æ§ãˆã‚‹ã‹ã€Œè¨³æ³¨ã€æ˜ç¤ºã§å‡¦ç†ã™ã‚‹ã€‚  \n\nä»¥ä¸Šã‚’è¸ã¾ãˆã¦ãƒªãƒ©ã‚¤ãƒˆã™ã‚Œã°ã€åŸä½œè€…ã®å£°ã‚’ãã®ã¾ã¾æ—¥æœ¬èªã«è½ã¨ã—è¾¼ã‚“ã  â€œãƒã‚¤ãƒ†ã‚£ãƒ–ãŒæ›¸ã„ãŸã‹ã®ã‚ˆã†ãªâ€ å®Œå…¨è¨³ã«è¿‘ã¥ãã€‚",
      "ã€é‡å¤§åº¦ï¼šé«˜ã€€â”€ã€€æ„å‘³ã®èª¤è¨³ãƒ»æƒ…å ±ã®è¿½åŠ ï¼æ¬ è½ã€‘\n\n1. TL;DR ã®å†…å®¹æ”¹å¤‰  \n   åŸæ–‡: â€œYou can set a pre-commit-msg git hook â€¦â€  \n   ç¿»è¨³: â€œprepare-commit-msg ã‚’ä½¿ã†ãâ€ ã¨æ–­å®šã—ã€ã•ã‚‰ã« â€œTL;DR ã§ã¯ pre-commit-msg ã£ã¦æ›¸ã„ã¡ã‚ƒã£ãŸã‘ã©â€¦â€ ã¨ç‹¬è‡ªã®æ³¨é‡ˆã‚’æŒ¿å…¥ã€‚  \n   å•é¡Œ: åŸæ–‡ã«ã¯ã€Œæ›¸ãé–“é•ã„ã‚’è‡ªè¦šã—ã¦ã„ã‚‹ã€ã¨ã„ã†ãƒ¡ã‚¿æƒ…å ±ã¯ãªã„ã€‚èª­è€…ã«ã€ŒåŸä½œè€…ãŒãƒŸã‚¹ã—ãŸã€ã‚ˆã†ãªå°è±¡ã‚’ä¸ãˆã€äº‹å®Ÿã‚’ã­ã˜æ›²ã’ã¦ã„ã‚‹ã€‚  \n   ä¿®æ­£æ¡ˆ: åŸæ–‡ã©ãŠã‚Š pre-commit-msg ã‚’æ¡ç”¨ã—ã€æ³¨é‡ˆã‚’å…¥ã‚Œãªã„ã€‚ã‚‚ã—å¾Œæ®µã§ prepare-commit-msg ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹ä¸ä¸€è‡´ã‚’èª¬æ˜ã—ãŸã„å ´åˆã§ã‚‚ã€Œè¨³æ³¨ã€ã¨æ˜ç¤ºã—è§’æ‹¬å¼§ã§è£œã†ã€‚\n\n2. pre-commit ã¨ prepare-commit ã®æ··åœ¨  \n   å¾ŒåŠã§ã‚‚ â€œpre-commit ãƒ•ãƒƒã‚¯ã‚‚ã™ã£é£›ã°ã•ã‚Œã‚‹ã£ã½ã„ ğŸ¤”â€ ã¨æ›¸ãã€ä¾ç„¶ã¨ã—ã¦ãƒ•ãƒƒã‚¯åãŒæºã‚Œã¦ã„ã‚‹ã€‚  \n   ä¿®æ­£æ¡ˆ: å…¨æ–‡ã§ â€œprepare-commit-msg ãƒ•ãƒƒã‚¯â€ ã«çµ±ä¸€ï¼ˆã‚‚ã—ãã¯åŸæ–‡ã«å¿ å®Ÿã« pre-commit-msg ã§çµ±ä¸€ï¼‰ã€è„±å­—ã€Œ-msgã€ã‚’è£œå®Œã€‚\n\n3. â€œvi or deathâ€ ã®æœªè¨³ãƒ»èª­ç‚¹æ¬ è½  \n   åŸæ–‡ã¯é»’ã„ãƒ¦ãƒ¼ãƒ¢ã‚¢ (â€œuse vi or die tryingâ€) ãŒè¾¼ã‚ã‚‰ã‚Œã¦ã„ã‚‹ãŒã€ã€Œvi or deathã€ã¨ãã®ã¾ã¾æ®‹ã—æ„å‘³ãŒæ›–æ˜§ã€‚  \n   ä¿®æ­£æ¡ˆ: ã€Œ(vi ã‚’ä½¿ã†ã‹æ­»ã‹ã ãœ)ã€ãªã©æ„å›³ã‚’ç¤ºã™ã‹ã€èª­è€…ãŒç†è§£ã§ãã‚‹è¨€ã„æ›ãˆã‚’æ³¨é‡ˆä»˜ãã§æç¤ºã€‚\n\n4. â€œChatGPT added the documentationâ€  \n   åŸæ–‡ã§ã¯å˜ã« 1 è¡Œã ãŒã€è¨³æ–‡ã¯ â€œChatGPT ãŒã‚³ãƒ¡ãƒ³ãƒˆã‚’ç››ã‚Šã¾ãã£ã¦ãã‚ŒãŸâ€ ã¨èª‡å¼µè¡¨ç¾ã‚’è¿½åŠ ã€‚  \n   ä¿®æ­£æ¡ˆ: ã€Œ(ChatGPT ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ãŸ)ã€ç¨‹åº¦ã«æŠ‘ãˆã€ä¸è¦ãªè„šè‰²ã‚’é¿ã‘ã‚‹ã€‚\n\nã€é‡å¤§åº¦ï¼šä¸­ã€€â”€ã€€ãƒˆãƒ¼ãƒ³ãƒ»ãƒ¬ã‚¸ã‚¹ã‚¿ã®ä¸æ•´åˆã€‘\n\n5. ä¸€äººç§°ãƒ»èªèª¿ã®ä¹±ã‚Œ  \n   ãƒ»â€œã‚ªãƒ¬â€â€œã‚¯ã‚½æ€ ã‘è€…ã§ã™ã‚â€â€œã‚„ã£ãŸãƒ¼â€ ç­‰ã€ç”·æ€§å£èªãƒ»å¥³è¨€è‘‰ãƒ»ç •ã‘ãŸè‹¥è€…è¨€è‘‰ãŒæ··åœ¨ã€‚  \n   ãƒ»â€œã§ã™ï¼ã¾ã™â€ä½“ã¨å¸¸ä½“ãŒæ®µè½ã”ã¨ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹ã€‚  \n   ä¿®æ­£æ¡ˆ: åŸæ–‡ã¯ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ã§ä¸€è²«ã—ã¦ã„ã‚‹ãŸã‚ã€æ—¥æœ¬èªã‚‚å¸¸ä½“ï¼‹ã‚„ã‚„ç •ã‘ãŸèªèª¿ã§çµ±ä¸€ (â€œä¿ºã¯ã€œâ€â€œã‚¯ã‚½æ€ ã‘è€…ã â€)ã€ã‚ã‚‹ã„ã¯ä¸å¯§ä½“ã«çµ±ä¸€ã€‚\n\n6. ç½µå€’èªã®å¼·åº¦ä¸Šã’éã  \n   â€œTrash commit messagesâ€ â†’ â€œã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚´ãƒŸåŒç„¶â€ ç¨‹åº¦ã§ååˆ†ã ãŒã€ã€Œã‚¯ã‚½æ€ ã‘è€…ã€ã€Œã‚¯ã‚½å¼„ã‚Šå›ã™ã€ãªã©åŸæ–‡ä»¥ä¸Šã«ä¸‹å“ã€‚  \n   ä¿®æ­£æ¡ˆ: åŸæ–‡ã¨åŒç¨‹åº¦ã®è»½ã„ç½µå€’ã«æŠ‘ãˆã‚‹ (â€œã‚ã¡ã‚ƒãã¡ã‚ƒæ€ ã‘è€…â€).\n\n7. ä¸è‡ªç„¶ãªå’Œè£½è‹±èªæ··åˆã‚¿ã‚¤ãƒˆãƒ«  \n   â€œGit Hook ã« Get HookedğŸ”¥â€ ã¯ãƒ€ã‚¸ãƒ£ãƒ¬ã‚’å¼·å¼•ã«æ—¥æœ¬èªã¸æŒã¡è¾¼ã‚“ã§ãŠã‚Šèª­ã¿ã¥ã‚‰ã„ã€‚  \n   ä¿®æ­£æ¡ˆ: ã€ŒGit Hook ã«ãƒãƒã‚‹ã€ã€ŒGit Hook ã§è§£æ±ºï¼ã€ãªã©ã‚·ãƒ³ãƒ—ãƒ«ã«ã€‚\n\nã€é‡å¤§åº¦ï¼šä¸­ã€€â”€ã€€æŠ€è¡“ç”¨èªãƒ»è¡¨è¨˜ã€‘\n\n8. ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã®è¨³æ³¨ãªã—  \n   è¨˜äº‹å†…ã§ `git-commit-message.txt` ã¨ `commit-system-prompt.txt` ãŒæ··åœ¨ã™ã‚‹ãŒã€è¨³æ–‡ã¯åŸæ–‡ã®æ··åœ¨ã‚’ãã®ã¾ã¾è¸è¥²ã—èª¬æ˜ã‚’è£œã£ã¦ã„ãªã„ã€‚  \n   ä¿®æ­£æ¡ˆ: â€œâ€»ã“ã®è¨˜äº‹ã§ã¯é€”ä¸­ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«åãŒå¤‰ã‚ã‚‹ãŒâ€¦ â€ã¨è¨³æ³¨ã§è£œè¶³ã™ã‚‹ã‹ã€è„šæ³¨ã§æ•´ç†ã€‚\n\n9. ã‚³ãƒãƒ³ãƒ‰åã®å…¨è§’å¼•ç”¨ç¬¦  \n   â€œgit commit -m â€œfixed issue #420â€â€ ã®äºŒé‡å¼•ç”¨ç¬¦ãŒå…¨è§’ã«ãªã£ã¦ã„ã‚‹ã€‚ã‚·ã‚§ãƒ«ã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦èª¤å‹•ä½œã™ã‚‹ã€‚  \n   ä¿®æ­£æ¡ˆ: åŠè§’ã® \"\" ã‚’ä½¿ç”¨ã€‚\n\nã€é‡å¤§åº¦ï¼šå°ã€€â”€ã€€æ–‡æ³•ãƒ»è¨€ã„å›ã—ã€‘\n\n10. ã€Œã»ã‚“ã¨æ€ ã‘è€…ãªã‚“ã ã‚ˆã­ã€‚ã€  \n    â€œãªã‚“ã ã‚ˆã­â€ ã®èªå°¾ã¯å£èªãŒå¼·ã™ãã€ç¶šãæ–‡ã§ â€œã§ã™ã‚â€ ã¨å™›ã¿åˆã‚ãªã„ã€‚èªèª¿çµ±ä¸€ã‚’ã€‚  \n\n11. ã€Œvi or death ã‚’å‚ç…§ã€  \n    ç›´è¨³æ„ŸãŒå¼·ã„ã€‚å‰è¿°ã®ã¨ãŠã‚Šæ„è¨³ï¼‹è£œè¶³ã‚’å…¥ã‚Œã‚‹ã€‚\n\n12. ã€Œæ˜ã‚Šç”²æ–ã‚ã‚‹ã‚ˆã€  \n    æ„å‘³ã¯ä¼ã‚ã‚‹ãŒã€Œã„ã˜ã‚‹ä¾¡å€¤ãŒã‚ã‚‹ã‚ˆã€ã€Œè©¦ã™ä¾¡å€¤ãŒã‚ã‚‹ã‚ˆã€ã®ã»ã†ãŒè‡ªç„¶ã€‚\n\n13. emoji ã®å¤šç”¨  \n    åŸæ–‡ã‚‚å¤šå°‘ emoji ã‚’ç”¨ã„ã¦ã„ã‚‹ãŒã€è¨³æ–‡ã§è¿½åŠ ã—ãŸ ğŸ¤”ğŸ”¥ ã¯ä¸è¦ã€‚åŸæ–‡ã®çµµæ–‡å­—ã ã‘ã‚’ç¶­æŒã€‚\n\nã€é‡å¤§åº¦ï¼šå°ã€€â”€ã€€æ©Ÿæ¢°ç¿»è¨³è‡­ãƒ»ãã“ã¡ãªã•ã€‘\n\n14. â€œå ´å½“ãŸã‚Šãƒãƒƒã‚¯æ„ŸãŒå¼·ã™ãã‚‹â€  \n    â€œå ´å½“ãŸã‚Šçš„ã™ãã‚‹â€ ã®ã»ã†ãŒè‡ªç„¶ã€‚\n\n15. ã€Œæœ€é«˜ã™ãã€  \n    å£èªã¨ã—ã¦æˆç«‹ã™ã‚‹ãŒ â€œãƒã‚¸æœ€é«˜â€ ã‚„ â€œæœ€é«˜ã â€ ã®æ–¹ãŒæ»‘ã‚‰ã‹ã€‚\n\nã€ã¾ã¨ã‚ã€‘\n\nãƒ»TL;DR ã®å‹æ‰‹ãªè£œè¶³ã€ãƒ•ãƒƒã‚¯åã®æ··ä¹±ã€éåº¦ã®è„šè‰²ï¼ˆemoji/ã‚¹ãƒ©ãƒ³ã‚°/ç½µå€’èªï¼‰ã¯æœ€å„ªå…ˆã§ä¿®æ­£ã€‚  \nãƒ»èªèª¿ã‚’å¸¸ä½“ã«çµ±ä¸€ã—ã€ç½µå€’èªã®å¼·åº¦ã‚’åŸæ–‡ç›¸å½“ã«ä¸‹ã’ã‚‹ã€‚  \nãƒ»åŸæ–‡ã§å®Ÿéš›ã«å­˜åœ¨ã—ãªã„æƒ…å ±ã‚„è©•ä¾¡ã‚’è¿½åŠ ã—ãªã„ã€‚  \nãƒ»æŠ€è¡“æƒ…å ±ï¼ˆãƒ‘ã‚¹åãƒ»ã‚³ãƒãƒ³ãƒ‰ï¼‰ã®æºã‚Œã‚„å…¨è§’è¨˜å·ã‚’æ­£ã™ã€‚  \n\nä»¥ä¸Šã‚’ç›´ã›ã°ã€åŸæ–‡ã®ãƒãƒªã‚’ä¿ã¡ã¤ã¤ã‚‚èª­ã¿ã‚„ã™ãã€æ­£ç¢ºãªæ—¥æœ¬èªè¨³ã«ãªã‚‹ã€‚"
    ]
  },
  "critique_loop_details": {
    "critique_usages": [
      {
        "prompt_tokens": 7348,
        "completion_tokens": 1693,
        "total_tokens": 9041
      },
      {
        "prompt_tokens": 7769,
        "completion_tokens": 2064,
        "total_tokens": 9833
      },
      {
        "prompt_tokens": 7347,
        "completion_tokens": 1764,
        "total_tokens": 9111
      },
      {
        "prompt_tokens": 7329,
        "completion_tokens": 1405,
        "total_tokens": 8734
      }
    ],
    "feedback_usages": [
      {
        "prompt_tokens": 9430,
        "completion_tokens": 3205,
        "total_tokens": 12635
      },
      {
        "prompt_tokens": 10288,
        "completion_tokens": 2780,
        "total_tokens": 13068
      },
      {
        "prompt_tokens": 9529,
        "completion_tokens": 2815,
        "total_tokens": 12344
      },
      {
        "prompt_tokens": 9062,
        "completion_tokens": 2759,
        "total_tokens": 11821
      }
    ]
  },
  "timestamp": "2025-06-27T08:19:58.348912"
}