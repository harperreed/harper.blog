---
date: 2025-12-03
description: 休暇シーズンにあふれるメールを管理するため、MCPサーバーと組み合わせてClaude Codeを活用した個人的な体験談。カスタムスキルの構築から下書き作成まで、AIエージェントが本来の声を保ちながら受信箱をトリアージする方法を探りつつ、エージェントにうっかり本を書く約束をさせてしまった際の教訓も共有する。
draft: false
generateSocialImage: true
slug: claude-code-email-productivity-mcp-agents
tags:
    - ai
    - agents
    - claude
    - mcp
    - email
    - productivity
    - automation
    - tools
    - pipedream
    - personal-assistant
title: "Claude Codeにメール処理を任せる"
translationKey: Claude Code Email Management
---

ここ１週間ほど、メール処理とスケジュール管理に Claude Code を使っている。ホリデーシーズンは何かと慌ただしく、気付けば常に遅れ気味。受信箱は「重要」扱いしたメールであふれ返り、一向に減らない――ストレスは今も続いている。

{{% figure src="R0002380.jpeg" caption="Maybe a storm?, Ricoh GRiiix, 11/2025" %}}

ちょうど [zo.computer](https://zo.computer) のローンチ（面白い！）を見かけて、「そういえば [Pipedream](https://pipedream.com) に、対応サービスなら何でもつなげられる MCP サーバーがあったな」と思い出した。つまり、これでメールも扱える！　問題は解決！ …と思ったら今度は別の問題が発生！ …しかも次々に増える！ なんで数えてるんだ！

## どうして？ なぜ？ そして人類は絶滅に向かっている

俺はメールが好きだ。普段はうまく回せるんだけど、量が爆発すると放置してしまい、状況は悪化――みんなが損をする。

要は、気負わずにメールを始められる仕組みが欲しかった。Claude Code を使うとそれがすごく楽になる。

1. 必要な MCP サーバーにつないだ Claude Code セッションを起動
2. 「受信箱をチェックして」と頼む
3. 未読→既読の順で対処すべきメールを教えてくれる
4. 「処理を始めようか？」と提案するか、関連情報やカレンダーを調べつつ賢く下書きを作り始める
5. 「完了！」と報告
6. メールクライアントで下書きを確認。大半は軽く手直しして送信、いくつかは却下
7. 繰り返す
8. Bacon（訳注：原文お決まりのオチ）

たとえば「兄貴から感謝祭の予定を聞かれてるよ」と教えてくれたら、「了解。“行くよ。ターキーのジュース──つまりスタッフィング──を持っていく” と伝えて」と返すだけ。すると過去メールの文体を学習したうえで、ほぼそのままの下書きを作ってくれる。

必ず「下書き」として保存し、送信前にしっかり確認する。

> コードを書かせるのはぜんぜん平気だけど、友だちや取引先に送るメールを丸投げできるほどには信用していない。あと一歩で YOLO モード（自動送信）に行けそうだけど、まだ様子見。別アドレスで試すかも？ 誰にもわからん。

驚くほどよく働く。ただし落とし穴もある。

### 笑えない笑い話

少し前、自作コードでメール仕分けエージェントを試作していた。そこそこ動くが完璧ではなかった。そんな折、友人経由で「AI についての本を書ける人」を探している方を紹介された。エージェントは「AI の影響を懐疑的かつ学術的に論じられる著者希望」と要約。俺は「面白いけど自分向きじゃない。友人を紹介しよう」と思った。

ところがバグで、エージェントが確認前に下書きを作り、そのまま送信。「ぜひ私にやらせてください」という超フォーマルなメールが相手に届いた。相手は大喜びで「やりましょう！」。そこで自分のミスに気付き、「すみません、エージェントが先走って返事しました。本当はこう言いたかったんです」と送信。相手からは当然「F U（くたばれ）」と返ってきた。

### こいつらは完全には信用できない

だから今回は慎重だ。エージェントには「送信禁止・下書きのみ」の権限しか与えていない。今のところ全メールを少しずつ直しているが、手直しは徐々に減っている。１年前のコード生成と同じ感覚だ。

今のところかなり快適。普通なら放置しがちなメールを一気に片付け、本当に返信したいメールに集中できる。ベンダーやサービス系の雑草を刈り取り、友人とのやり取りという花を守る――理想的な AI の使い方。おすすめ。

## 俺の環境を複製する？（挑戦者求む）

毎回ゼロからは面倒なので、超シンプルな Claude Code “ディレクトリ” を作った。受信箱の仕分けに必要なものはほぼ入っている。

```
📁 .
├── 📁 .claude
│   ├── 📄 CLAUDE.md
│   ├── 📄 settings.json
│   └── 📁 skills
│       ├── 📁 crm-management
│       │   └── 📄 SKILL.md
│       └── 📁 email-management
│           └── 📄 SKILL.md
├── 📄 .mcp.json
```

いくつか要点を押さえておく。

### CLAUDE.md

ここは超パーソナルで超重要。まず過去数百通の送信メールを Claude に読ませ、「俺のメールのノリ」をつかませた。やり取りの末、今はこうなっている。

```
1. **スレッドを探す**: 元メール／スレッドを検索して文脈を把握
2. **詳細を取得**: thread ID・message ID・宛先アドレスを取り出し正しく紐付け
3. **カレンダー確認**: イベントがあればカレンダーに追加
4. **メールを下書き**:
    - **重要**: `To:` アドレスを必ず明示（MCP は自動抽出しない）
    - とことん簡潔に（必要なら温かみをプラス）
    - Harper の声を再現（カジュアル・直球・無駄なし）
    - 署名やあいさつは不要
5. **必ず下書き保存**: 直接送信しない
6. **正しくスレッド化**: thread ID と in-reply-to message ID を必ず指定
7. **フィードバックで更新**: Harper が直したら反映
```

### スキル

大量のメールを処理しながらコーチングし、いい感じになったところで Claude に「スキル」としてまとめさせた。

```
## コア原則

1. **常に下書き・決して即送信しない**
2. **スレッド紐付けは生命線**
3. **Harper の声を厳守** ― 超簡潔・カジュアル・署名なし
4. **構造化データを抽出** ― イベント・アクション・連絡先など
```

```
## 成功の判定基準

- 下書きが正しいスレッドに入っている
- Harper が「問題なし」と言って修正不要
- カレンダーが自動で更新されている
- 受信箱サマリーで重要メールが浮き彫り
- 全体として効率的で自然に感じる
```

```
## 覚えておくこと

Email は Harper の声で行う個人的コミュニケーション。
時間を節約しつつ「本人らしさ」を保つのが目標。
迷ったら：短く、ラフに、まず下書き。
```

Claude 自身にスキルを書かせるのは本当に便利。とにかく反復が大事。

### ツール！

MCP という概念にはまだムッとするけど、便利すぎて使わざるを得ない。Claude Code にツール一式を渡すと仕事がはかどる。

```
{
  "mcpServers": {
    "pd": {
      "type": "http",
      "url": "https://mcp.pipedream.net/v2"
    },
    "pagen": {
      "type": "stdio",
      "command": "pagen",
      "args": ["mcp"],
      "env": {}
    },
    "toki": {
      "type": "stdio",
      "command": "toki",
      "args": ["mcp"],
      "env": {}
    },
    "chronicle": {
      "type": "stdio",
      "command": "chronicle",
      "args": ["mcp"],
      "env": {}
    }
  }
}
```

### Pipedream

[Pipedream MCP](https://pipedream.com/docs/connect/mcp/developers) はとても簡単。Claude Code に追加して認証し、各サービスをつなぐと MCP ツールとして使える。俺は Gmail・Google Calendar・Contacts を接続中。

### その他：自作 MCP サーバー３種

#### Toki

CLI ベースのシンプルな TODO トラッカー（将来的に複数バックエンド対応予定、今はローカルのみ）。

- [harperreed/toki](https://github.com/harperreed/toki)
- `brew install harperreed/tap/toki`

#### Chronicle

エージェントの行動を全部ログに残すツール。

- [harperreed/chronicle](https://github.com/harperreed/chronicle)
- `brew install harperreed/tap/chronicle`

#### pagen

CRM をうっかりミススペルした **p**ersonal **agen**t バックエンド。

- [harperreed/pagen](https://github.com/harperreed/pagen)
- `brew install harperreed/tap/pagen`

### まとめ

強力なスキル、CLAUDE.md、そして MCP ツールの三位一体で、メール仕分けがかなり楽になる。完璧ではないが十分便利。試す価値はあるが、盲信は禁物ｗ

## やってみる？

このセットアップ用にシンプルなプラグインを作った。インストールするだけで動くはず！

インストール手順:

```
/plugin marketplace add harperreed/office-admin-claude
/plugin install office-admin
/setup-office-admin
```

※YMMV（結果は人によって異なります）

## これは間違いなく未来だ

好き嫌いに関係なく、エージェント型メールは来る。今は黎明期だから、俺みたいにカスタム体験を作る人が増えるだろう。Google も Gmail に直接機能をねじ込んでくるはずだが、たぶん微妙に動かない。ベストなのは Mimestream や Superhuman のような「エージェント前提」クライアントだと思う。チャット UI だけになるのは勘弁だけど、さてどうなるか。

大量のメールを抱えているならぜひ試してみてほしい。俺は雑草（ビジネスローンの勧誘など）を刈り取り、みんなという花を守るための「brush clearing」として使っている。

### プライバシー？ 何それ？

メールは Pipedream と Anthropic を経由している。プライバシー上の懸念はある。早くローカルで動かし、Google Workspace と直接やり取りできる MCP サーバーが欲しい！

### 用心してね

{{% figure src="L1030630.jpeg" caption="Not even once, Leica Q, 11/2017" %}}

他人に影響する権限をエージェントに渡すのは本当に怖い。俺の場合はうまく機能しているが、試行錯誤の中で盛大にやらかしたこともある。

受信箱はいまピッカピカ。DO NOT SEND ME EMAILS! IT IS BEAUTIFUL!
